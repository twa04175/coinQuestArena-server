System.register("chunks:///_virtual/BlinkTwinkle.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var i,a,n,e,l,o,r,s,c,u,h;return{setters:[function(t){i=t.applyDecoratedDescriptor,a=t.inheritsLoose,n=t.initializerDefineProperty,e=t.assertThisInitialized},function(t){l=t.cclegacy,o=t._decorator,r=t.UIOpacity,s=t.math,c=t.Tween,u=t.tween,h=t.Component}],execute:function(){var p,y,d,f,v;l._RF.push({},"58ccdbpvzJG/L8RSz01+kdq","BlinkTwinkle",void 0);var m=o.ccclass,_=o.property;o.executeInEditMode,t("BlinkTwinkle",(p=m("BlinkTwinkle"),y=_({tooltip:"에디터에서도 미리보기(Play 모드 아님). 성능 이슈시 끄세요."}),p((v=i((f=function(t){function i(){for(var i,a=arguments.length,l=new Array(a),o=0;o<a;o++)l[o]=arguments[o];return(i=t.call.apply(t,[this].concat(l))||this).startDelayMin=.5,i.startDelayMax=2,i.intervalMin=2,i.intervalMax=4,i.intervalJitter=.5,i.onDuration=.5,i.offDuration=.5,i.minOpacity=80,i.maxOpacity=255,i.scalePulse=0,n(i,"previewInEditor",v,e(i)),i._uiOpacity=void 0,i._alive=!1,i}a(i,t);var l=i.prototype;return l.onLoad=function(){this._uiOpacity=this.getComponent(r)||this.addComponent(r),this._uiOpacity.opacity=Math.max(0,Math.min(255,this._uiOpacity.opacity))},l.onEnable=function(){var t=this;this._alive=!0,this._stopAllTweens(),this._uiOpacity.opacity=this.minOpacity;var i=s.randomRange(this.startDelayMin,this.startDelayMax);this.scheduleOnce((function(){return t._loop()}),Math.max(0,i))},l.onDisable=function(){this._alive=!1,this.unscheduleAllCallbacks(),this._stopAllTweens()},l._stopAllTweens=function(){c.stopAllByTarget(this._uiOpacity),c.stopAllByTarget(this.node)},l._loop=function(){var t=this;this._alive&&this._blinkOnce((function(){if(t._alive){var i=s.randomRange(t.intervalMin,t.intervalMax);t.intervalJitter>0&&(i+=s.randomRange(-t.intervalJitter,t.intervalJitter)),i=Math.max(0,i),t.scheduleOnce((function(){return t._loop()}),i)}}))},l._blinkOnce=function(t){var i=Math.max(.01,this.onDuration),a=Math.max(.01,this.offDuration),n=Math.max(0,Math.min(255,this.maxOpacity)),e=Math.max(0,Math.min(255,this.minOpacity)),l=this.scalePulse>1e-4,o=u(this._uiOpacity).to(i,{opacity:n},{easing:"quadOut"}),r=u(this._uiOpacity).to(a,{opacity:e},{easing:"quadIn"});if(l){var s=this.node.scale.clone(),c=s.clone().multiply3f(1+this.scalePulse,1+this.scalePulse,1),h=u(this.node).to(i,{scale:c},{easing:"quadOut"}),p=u(this.node).to(a,{scale:s},{easing:"quadIn"});u({}).call((function(){o.start(),h.start()})).delay(i).call((function(){r.start(),p.start()})).delay(a).call((function(){return t&&t()})).start()}else u({}).call((function(){return o.start()})).delay(i).call((function(){return r.start()})).delay(a).call((function(){return t&&t()})).start()},i}(h)).prototype,"previewInEditor",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),d=f))||d));l._RF.pop()}}}));

System.register("chunks:///_virtual/BuildType.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"1ff45fowl1GU6oC1RYbJ/FP","BuildType",void 0);e("BuildType",function(e){return e[e.DEV=0]="DEV",e[e.PROD=1]="PROD",e}({}));t._RF.pop()}}}));

System.register("chunks:///_virtual/CameraFollow.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,r,o,i,a,n,l,s,c,u;return{setters:[function(t){e=t.applyDecoratedDescriptor,r=t.inheritsLoose,o=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){a=t.cclegacy,n=t._decorator,l=t.Camera,s=t.Node,c=t.math,u=t.Component}],execute:function(){var p,m,h,f,g,y,b,d,w;a._RF.push({},"f0a4bvf1e5IWb1s/qx5cDia","CameraFollow",void 0);var v=n.ccclass,C=n.property;t("CameraFollow",(p=v("CameraFollow"),m=C(l),h=C(s),f=C({tooltip:"부드러움(작을수록 타이트하게 따라감)"}),p((b=e((y=function(t){function e(){for(var e,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return e=t.call.apply(t,[this].concat(a))||this,o(e,"cam",b,i(e)),o(e,"target",d,i(e)),o(e,"smoothTime",w,i(e)),e}r(e,t);var a=e.prototype;return a.setTarget=function(t){this.target=t},a.start=function(){this.cam||(this.cam=this.getComponent(l)||null)},a.update=function(t){if(this.target){var e=this.node.worldPosition,r=this.target.worldPosition,o=1-Math.pow(.001,t/Math.max(this.smoothTime,1e-4)),i=c.lerp(e.x,r.x,o),a=c.lerp(e.y,r.y,o);this.node.setWorldPosition(i,a,e.z)}},e}(u)).prototype,"cam",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=e(y.prototype,"target",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=e(y.prototype,"smoothTime",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.35}}),g=y))||g));a._RF.pop()}}}));

System.register("chunks:///_virtual/Character.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ChatCloud.ts"],(function(i){var t,e,n,a,l,o,r,s,h,c,u,d,C,p;return{setters:[function(i){t=i.applyDecoratedDescriptor,e=i.inheritsLoose,n=i.initializerDefineProperty,a=i.assertThisInitialized},function(i){l=i.cclegacy,o=i._decorator,r=i.Label,s=i.Animation,h=i.BoxCollider2D,c=i.Sprite,u=i.Contact2DType,d=i.Color,C=i.Component},function(i){p=i.ChatCloud}],execute:function(){var f,b,g,m,y,_,S,N,v,T,D,E,x,A,I;l._RF.push({},"03cd9fOJ99BXZXuNwAgvJi4","Character",void 0);var w=o.ccclass,B=o.property;i("Character",(f=w("Character"),b=B({type:p}),g=B({type:r}),m=B({type:s}),y=B({type:h}),_=B({type:h}),S=B({type:c}),f((T=t((v=function(i){function t(){for(var t,e=arguments.length,l=new Array(e),o=0;o<e;o++)l[o]=arguments[o];return t=i.call.apply(i,[this].concat(l))||this,n(t,"chatCloud",T,a(t)),n(t,"nameLabel",D,a(t)),n(t,"animation",E,a(t)),n(t,"footerCollider",x,a(t)),n(t,"headCollider",A,a(t)),t._currentClipName=null,n(t,"charSprite",I,a(t)),t._lastDir="f",t}e(t,i);var l=t.prototype;return l.onEnable=function(){var i,t,e,n;null==(i=this.footerCollider)||i.on(u.BEGIN_CONTACT,this.onBeginContact,this),null==(t=this.footerCollider)||t.on(u.END_CONTACT,this.onEndContact,this),null==(e=this.headCollider)||e.on(u.BEGIN_CONTACT,this.onBeginContact,this),null==(n=this.headCollider)||n.on(u.END_CONTACT,this.onEndContact,this)},l.onDisable=function(){var i,t,e,n;null==(i=this.footerCollider)||i.off(u.BEGIN_CONTACT,this.onBeginContact,this),null==(t=this.footerCollider)||t.off(u.END_CONTACT,this.onEndContact,this),null==(e=this.headCollider)||e.off(u.BEGIN_CONTACT,this.onBeginContact,this),null==(n=this.headCollider)||n.off(u.END_CONTACT,this.onEndContact,this)},l.updateName=function(i){this.nameLabel.string=i},l.updateColor=function(i){this.charSprite&&(this.charSprite.color=(new d).fromHEX(i))},l.showMessage=function(i){this.chatCloud?this.chatCloud.onCloud(i):console.warn("[Character] chatCloud is not assigned.")},l.applyMovement=function(i){this.updateAnim(i.dirX,i.dirY,i.speed)},l.updateAnim=function(i,t,e){var n,a=this._lastDir;if(i>0?a="r":i<0?a="l":t>0?a="b":t<0&&(a="f"),"l"===a){var l=this.charSprite.node.getScale();this.charSprite.node.setScale(-1*Math.abs(l.x),l.y,l.z)}else if("r"===a){var o=this.charSprite.node.getScale();this.charSprite.node.setScale(1*Math.abs(o.x),o.y,o.z)}var r="idle",s=Math.abs(i)<1e-4&&Math.abs(t)<1e-4;"idle"!==(r=!s&&e>200?"run":!s&&e>1?"walk":"idle")&&(this._lastDir=a);var h="idle"===r?this._lastDir:a;"l"!==h&&"r"!==h||(h="x");var c="anim_"+r+"_"+h;if(this._currentClipName!==c){var u=null==(n=this.animation)?void 0:n.getState(c);if(null!=u&&u.isPlaying)this._currentClipName=c;else if(u&&this.animation)this.animation.play(c),this._currentClipName=c;else{var d,C="anim_idle_"+this._lastDir,p=null==(d=this.animation)?void 0:d.getState(C);p&&!p.isPlaying&&(this.animation.play(C),this._currentClipName=C)}}},l.onBeginContact=function(i,t,e){this.checkSiblingIndex(i,t)},l.onEndContact=function(i,t){this.checkSiblingIndex(i,t)},l.checkSiblingIndex=function(i,t){var e=i.node.position.y,n=t.node.position.y;console.log("checkSiblingIndex",e,n),e>n?this.node.setSiblingIndex(t.node.getSiblingIndex()-1):this.node.setSiblingIndex(t.node.getSiblingIndex()+1)},t}(C)).prototype,"chatCloud",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=t(v.prototype,"nameLabel",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=t(v.prototype,"animation",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=t(v.prototype,"footerCollider",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=t(v.prototype,"headCollider",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=t(v.prototype,"charSprite",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=v))||N));l._RF.pop()}}}));

System.register("chunks:///_virtual/CharacterManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NetworkManager.ts","./Player.ts","./Character.ts"],(function(e){var t,r,a,n,o,i,s,c,h,l,p,d,u,g,y;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,a=e.initializerDefineProperty,n=e.assertThisInitialized,o=e.createClass},function(e){i=e.cclegacy,s=e._decorator,c=e.Prefab,h=e.Node,l=e.instantiate,p=e.Vec3,d=e.Component},function(e){u=e.NetworkManager},function(e){g=e.Player},function(e){y=e.Character}],execute:function(){var f,m,v,_,P,C,M,b;i._RF.push({},"0ba355JVpVNP6ttnckKW5C+","CharacterManager",void 0);var w=s.ccclass,F=s.property;e("CharacterManager",(f=w("CharacterManager"),m=F({type:c}),v=F({type:h}),f(((b=function(e){function t(){for(var t,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o))||this,a(t,"characterPrefab",C,n(t)),a(t,"characterLayer",M,n(t)),t._characters=new Map,t._targets=new Map,t._pool=[],t}r(t,e);var i=t.prototype;return i.onLoad=function(){void 0===t._instance&&(t._instance=this)},i.start=function(){},i._getFromPool=function(){var e=this._pool.pop();return e||(e=l(this.characterPrefab)),e.active=!0,e.setParent(this.node),e},i._recycle=function(e){e.removeFromParent(),e.active=!1,this._pool.push(e)},i.onAddPlayer=function(e,t){if(console.log("onAddPlayer",t,e),!this._characters.has(t)){var r=this._getFromPool();if(e.id===u.instance.room.sessionId){console.log("This is my character");var a=r.getComponent(g);a||(a=r.addComponent(g))}else{r.getComponent(g)&&r.removeComponent(g)}var n=r.getComponent(y);n&&(n.updateName(e.name),n.updateColor(e.color||"#FFFFFF"),Date.now()-e.lastMsg<1e3&&n.showMessage(e.msg)),r.name="Char_"+t,r.setParent(this.characterLayer);var o=Number(e.movement.x)||0,i=Number(e.movement.y)||0;r.setPosition(new p(o,i,0)),this._characters.set(t,n)}},i.onRemovePlayer=function(e,t){console.log("onRemovePlayer",t);var r=this._characters.get(t);r&&(this._recycle(r.node),this._characters.delete(t))},i.onChangePlayer=function(e,t){},i.setTargetPosition=function(e,t){if(e===u.instance.room.sessionId){var r=this._characters.get(e);return r&&r.updateAnim(t.dirX,t.dirY,t.speed),void r.getComponent(g).setSpeed(t.speed)}var a=this._targets.get(e);a&&t.tick<a.tick||this._targets.set(e,{x:t.x,y:t.y,dirX:t.dirX,dirY:t.dirY,speed:t.speed,tick:t.tick})},i.update=function(){var e=this;this._characters.forEach((function(t,r){var a=e._targets.get(r);if(a){var n=t.node.getPosition();n.x+=.2*(a.x-n.x),n.y+=.2*(a.y-n.y),t.node.setPosition(n),t.applyMovement?t.applyMovement({x:n.x,y:n.y,dirX:a.dirX,dirY:a.dirY,speed:a.speed}):t.updateAnim(a.dirX,a.dirY,a.speed)}}))},i.updateCharacterMsg=function(e,t,r){var a=this._characters.get(e);if(a){var n=a.getComponent(y);n&&(n.showMessage(t),Date.now()-r<1e3&&n.showMessage(t))}},o(t,null,[{key:"instance",get:function(){return this._instance}}]),t}(d))._instance=void 0,C=t((P=b).prototype,"characterPrefab",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=t(P.prototype,"characterLayer",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=P))||_));i._RF.pop()}}}));

System.register("chunks:///_virtual/ChatCloud.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,i,o,a,c,r,s,u;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){a=e.cclegacy,c=e._decorator,r=e.Label,s=e.UIOpacity,u=e.Component}],execute:function(){var l,d,h,p,f,b,m,v,y,C,g,S,_;a._RF.push({},"fee2cuVYkxDYIQ64lumMl/8","ChatCloud",void 0);var O=c.ccclass,H=c.property;e("ChatCloud",(l=O("ChatCloud"),d=H({type:r,tooltip:"말풍선 내부에 텍스트를 표시할 Label"}),h=H({tooltip:"기본 유지 시간(초)"}),p=H({tooltip:"글자당 추가 시간(초)"}),f=H({tooltip:"최대 유지 시간(초)"}),b=H({tooltip:"페이드아웃 시간(초). 0이면 즉시 숨김"}),l((y=t((v=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return t=e.call.apply(e,[this].concat(a))||this,i(t,"content",y,o(t)),i(t,"autoHideSeconds",C,o(t)),i(t,"perCharSeconds",g,o(t)),i(t,"maxSeconds",S,o(t)),i(t,"fadeOutSeconds",_,o(t)),t._hideTask=function(){return t._doHide()},t}n(t,e);var a=t.prototype;return a.onLoad=function(){this.content||(this.content=this.getComponentInChildren(r)),this.node.active=!1},a.onCloud=function(e){var t=this;if(this.content){this._showImmediately(),this.unscheduleAllCallbacks();var n=e.length,i=Math.min(this.autoHideSeconds+n*this.perCharSeconds,this.maxSeconds),o=.3*i/Math.max(n,1),a=0;this.content.string="";this.schedule((function i(){a<n?(t.content.string=e.substring(0,a+1),a++):t.unschedule(i)}),o),this.scheduleOnce(this._hideTask,i)}},a.offCloud=function(){this.unscheduleAllCallbacks(),this.fadeOutSeconds>0?this._fadeOutThenHide():this.node.active=!1},a._showImmediately=function(){var e=this.node.getComponent(s);e&&(e.opacity=255),this.node.active||(this.node.active=!0)},a._doHide=function(){this.fadeOutSeconds>0?this._fadeOutThenHide():this.node.active=!1},a._fadeOutThenHide=function(){var e=this,t=this.node.getComponent(s);if(!t||this.fadeOutSeconds<=0)this.node.active=!1;else{var n=this.fadeOutSeconds,i=0,o=1/60,a=function a(){i+=o;var c=Math.min(i/n,1);t.opacity=255*(1-c),c>=1&&(e.unschedule(a),e.node.active=!1,t.opacity=255)};this.unschedule(a),this.schedule(a,o)}},t}(u)).prototype,"content",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=t(v.prototype,"autoHideSeconds",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),g=t(v.prototype,"perCharSeconds",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),S=t(v.prototype,"maxSeconds",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 8}}),_=t(v.prototype,"fadeOutSeconds",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),m=v))||m));a._RF.pop()}}}));

System.register("chunks:///_virtual/ChattingInput.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NetworkManager.ts"],(function(t){var e,n,i,r,u,o,s,p,a,l,c,f,h,g;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){u=t.cclegacy,o=t._decorator,s=t.EditBox,p=t.sys,a=t.game,l=t.input,c=t.Input,f=t.KeyCode,h=t.Component},function(t){g=t.NetworkManager}],execute:function(){var y,d,v,b,_;u._RF.push({},"65f34gMKfVARpx+eOZjOc3B","ChattingInput",void 0);var m=o.ccclass,I=o.property;t("ChattingInput",(y=m("ChattingInput"),d=I({type:s}),y((_=e((b=function(t){function e(){for(var e,n=arguments.length,u=new Array(n),o=0;o<n;o++)u[o]=arguments[o];return e=t.call.apply(t,[this].concat(u))||this,i(e,"input",_,r(e)),e.applyWebAttrs=function(){if(p.isBrowser&&e.input){var t=e.input,n=t._impl||t._implComp||t._editBoxImpl||null,i=(null==n?void 0:n._input)||(null==n?void 0:n._textarea)||(null==n?void 0:n._textInput)||(null==n?void 0:n._edTxt)||null;i&&i.setAttribute&&(i.setAttribute("autocomplete","off"),i.setAttribute("autocorrect","off"),i.setAttribute("autocapitalize","off"),i.setAttribute("spellcheck","false"),i.setAttribute("enterkeyhint","done"))}},e}n(e,t);var u=e.prototype;return u.sendMessage=function(){var t;""!==this.input.string&&(g.instance.room.send("chatInput",{msg:this.input.string}),this.input.string="",this.input.blur(),null==(t=a.canvas)||t.focus())},u.onLoad=function(){var t=this;l.on(c.EventType.KEY_DOWN,this.enterInput,this),setTimeout((function(){t.applyWebAttrs()}),100)},u.onDestroy=function(){l.off(c.EventType.KEY_DOWN,this.enterInput,this)},u.enterInput=function(t){if(f.ENTER===t.keyCode){if(""!==this.input.string)return;this.input.focus()}},e}(h)).prototype,"input",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=b))||v));u._RF.pop()}}}));

System.register("chunks:///_virtual/Colorpicker.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,o,n,i,r,l,s,c,a,u,d,p,f,h,m,F;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,n=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){r=e.cclegacy,l=e._decorator,s=e.Button,c=e.Node,a=e.UITransform,u=e.Vec3,d=e.Tween,p=e.tween,f=e.easing,h=e.Component,m=e.Sprite,F=e.Color}],execute:function(){var g,C,v,b,y,x,w,T,B,I;r._RF.push({},"5f69fuq9ZVCxar2ayFTpPMN","Colorpicker",void 0);var N=l.ccclass,S=l.property;e("ColorPicker",(g=N("ColorPicker"),C=S({type:[s]}),v=S({type:c}),g((x=t((y=function(e){function t(){for(var t,o=arguments.length,r=new Array(o),l=0;l<o;l++)r[l]=arguments[l];return(t=e.call.apply(e,[this].concat(r))||this).pickColors=["#FFFFFF","#82b3d8","#85be8c","#decc73","#d9965b","#d37896","#d5a1e0"],n(t,"colorButtons",x,i(t)),n(t,"selectNode",w,i(t)),n(t,"animTime",T,i(t)),n(t,"xOffset",B,i(t)),n(t,"easingName",I,i(t)),t._selectedIndex=0,t._selectedColor="#FFFFFF",t}o(t,e);var r=t.prototype;return r.onLoad=function(){for(var e=this,t=function(t){var o=e.colorButtons[t],n=e.pickColors[t]||"#FFFFFF",i=o.getComponent(m)||o.getComponentInChildren(m);if(i){var r=new F;F.fromHEX(r,n),i.color=r}else{var l;console.warn("[ColorPicker] Sprite not found for button",t,null==o||null==(l=o.node)?void 0:l.name)}o.node.on(s.EventType.CLICK,(function(){e.setSelectedIndex(t)}))},o=0;o<this.colorButtons.length;o++)t(o);this.setSelectedIndex(0,!0)},r.getSelectedColor=function(){return this._selectedColor},r.getSelectedIndex=function(){return this._selectedIndex},r.setSelectedIndex=function(e,t){if(void 0===t&&(t=!1),!(e<0||e>=this.pickColors.length||e>=this.colorButtons.length)){this._selectedIndex=e,this._selectedColor=this.pickColors[e]||"#FFFFFF",window.selectedColor=this._selectedColor;var o=this.colorButtons[e].node;this.moveSelectorToButtonX(o,t)}},r.moveSelectorToButtonX=function(e,t){if(void 0===t&&(t=!1),this.selectNode){var o,n=this.selectNode,i=e.worldPosition,r=n.parent,l=r.getComponent(a);if(l)o=l.convertToNodeSpaceAR(i).x+this.xOffset;else o=(e.parent===r?e.position.x:n.position.x)+this.xOffset;var s=n.position,c=new u(o,s.y,s.z);d.stopAllByTarget(n),t||this.animTime<=0?n.setPosition(c):p(n).to(this.animTime,{position:c},{easing:f[this.easingName]?this.easingName:"quadOut"}).start()}},t}(h)).prototype,"colorButtons",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),w=t(y.prototype,"selectNode",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(y.prototype,"animTime",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),B=t(y.prototype,"xOffset",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),I=t(y.prototype,"easingName",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"quadOut"}}),b=y))||b));r._RF.pop()}}}));

System.register("chunks:///_virtual/colyseus.js",["./cjs-loader.mjs"],(function(e,t){var n;return{setters:[function(e){n=e.default}],execute:function(){function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function i(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,f(e,t)}function a(e){var t="function"==typeof Map?new Map:void 0;return(a=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return c(e,arguments,l(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),f(r,e)})(e)}function c(e,t,n){return(c=u()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&f(i,n.prototype),i}).apply(null,arguments)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,"symbol"==typeof(o=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"))?o:String(o)),r)}var i,o}function d(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function p(){return(p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}e("default",void 0);var v=e("__cjsMetaURL",t.meta.url);n.define(v,(function(t,n,o,u,f){!function(e,n){"object"==typeof t&&void 0!==o?n(t):"function"==typeof define&&define.amd?define("colyseus.js",["exports"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).Colyseus={})}(this,(function(e){function t(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(n){if("default"!==n&&!(n in e)){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}}))})),Object.freeze(e)}ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return null!==e&&"object"==typeof e&&e.buffer instanceof ArrayBuffer}),"undefined"==typeof FormData&&(global.FormData=function(){}),"undefined"==typeof globalThis&&"undefined"!=typeof window&&(window.globalThis=window);var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var u,f=function(){return(f=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function l(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function h(e,t){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}function v(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function g(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}"function"==typeof SuppressedError&&SuppressedError,function(e){e[e.CONSENTED=4e3]="CONSENTED",e[e.DEVMODE_RESTART=4010]="DEVMODE_RESTART"}(u||(u={}));var y=function(e){function t(t,n){var r=e.call(this,n)||this;return r.name="ServerError",r.code=t,r}return o(t,e),t}(Error);"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var m,b,E=function(e){var t={exports:{}};return e(t,t.exports),t.exports}((function(e,t){!function(e){var t,n,r,o,u,f,l,h,v,g,y,m,b,E,w,O,I,A,T=255,S=213;e.OPERATION=void 0,(A=e.OPERATION||(e.OPERATION={}))[A.ADD=128]="ADD",A[A.REPLACE=0]="REPLACE",A[A.DELETE=64]="DELETE",A[A.DELETE_AND_MOVE=96]="DELETE_AND_MOVE",A[A.MOVE_AND_ADD=160]="MOVE_AND_ADD",A[A.DELETE_AND_ADD=192]="DELETE_AND_ADD",A[A.CLEAR=10]="CLEAR",A[A.REVERSE=15]="REVERSE",A[A.MOVE=32]="MOVE",A[A.DELETE_BY_REFID=33]="DELETE_BY_REFID",A[A.ADD_BY_REFID=129]="ADD_BY_REFID",null!=Symbol.metadata||(Symbol.metadata=Symbol.for("Symbol.metadata"));var R=Symbol("$track"),x=Symbol("$encoder"),C=Symbol("$decoder"),P=Symbol("$filter"),D=Symbol("$getByIndex"),k=Symbol("$deleteByIndex"),N=Symbol("$changes"),_=Symbol("$childType"),M=Symbol("$onEncodeEnd"),j=Symbol("$onDecodeEnd"),L=Symbol("$descriptors"),B="$__numFields",F="$__refTypeFieldIndexes",$="$__viewFieldIndexes",U="$__fieldIndexesByViewTag";try{new TextEncoder}catch(e){}var V=new ArrayBuffer(8),z=new Int32Array(V),H=new Float32Array(V),W=new Float64Array(V),J=new BigInt64Array(V),q="undefined"!=typeof Buffer&&Buffer.byteLength?Buffer.byteLength:function(e,t){for(var n=0,r=0,i=0,o=e.length;i<o;i++)(n=e.charCodeAt(i))<128?r+=1:n<2048?r+=2:n<55296||n>=57344?r+=3:(i++,r+=4);return r};function K(e,t,n){for(var r=0,i=0,o=t.length;i<o;i++)(r=t.charCodeAt(i))<128?e[n.offset++]=r:r<2048?(e[n.offset]=192|r>>6,e[n.offset+1]=128|63&r,n.offset+=2):r<55296||r>=57344?(e[n.offset]=224|r>>12,e[n.offset+1]=128|r>>6&63,e[n.offset+2]=128|63&r,n.offset+=3):(i++,r=65536+((1023&r)<<10|1023&t.charCodeAt(i)),e[n.offset]=240|r>>18,e[n.offset+1]=128|r>>12&63,e[n.offset+2]=128|r>>6&63,e[n.offset+3]=128|63&r,n.offset+=4)}function Y(e,t,n){e[n.offset++]=255&t}function Z(e,t,n){e[n.offset++]=255&t}function G(e,t,n){e[n.offset++]=255&t,e[n.offset++]=t>>8&255}function X(e,t,n){e[n.offset++]=255&t,e[n.offset++]=t>>8&255}function Q(e,t,n){e[n.offset++]=255&t,e[n.offset++]=t>>8&255,e[n.offset++]=t>>16&255,e[n.offset++]=t>>24&255}function ee(e,t,n){var r=t>>24,i=t>>16,o=t>>8,s=t;e[n.offset++]=255&s,e[n.offset++]=255&o,e[n.offset++]=255&i,e[n.offset++]=255&r}function te(e,t,n){var r=Math.floor(t/Math.pow(2,32));ee(e,t>>>0,n),ee(e,r,n)}function ne(e,t,n){var r=t/Math.pow(2,32)>>0;ee(e,t>>>0,n),ee(e,r,n)}function re(e,t,n){J[0]=BigInt.asIntN(64,t),Q(e,z[0],n),Q(e,z[1],n)}function ie(e,t,n){J[0]=BigInt.asIntN(64,t),Q(e,z[0],n),Q(e,z[1],n)}function oe(e,t,n){H[0]=t,Q(e,z[0],n)}function se(e,t,n){W[0]=t,Q(e,z[0],n),Q(e,z[1],n)}function ae(e,t,n){e[n.offset++]=t?1:0}function ce(e,t,n){t||(t="");var r=q(t,"utf8"),i=0;if(r<32)e[n.offset++]=160|r,i=1;else if(r<256)e[n.offset++]=217,e[n.offset++]=r%255,i=2;else if(r<65536)e[n.offset++]=218,X(e,r,n),i=3;else{if(!(r<4294967296))throw new Error("String too long");e[n.offset++]=219,ee(e,r,n),i=5}return K(e,t,n),i+r}function ue(e,t,n){return isNaN(t)?ue(e,0,n):isFinite(t)?t!==(0|t)?Math.abs(t)<=34028235e31&&(H[0]=t,Math.abs(Math.abs(H[0])-Math.abs(t))<1e-4)?(e[n.offset++]=202,oe(e,t,n),5):(e[n.offset++]=203,se(e,t,n),9):t>=0?t<128?(e[n.offset++]=255&t,1):t<256?(e[n.offset++]=204,e[n.offset++]=255&t,2):t<65536?(e[n.offset++]=205,X(e,t,n),3):t<4294967296?(e[n.offset++]=206,ee(e,t,n),5):(e[n.offset++]=207,ne(e,t,n),9):t>=-32?(e[n.offset++]=224|t+32,1):t>=-128?(e[n.offset++]=208,Y(e,t,n),2):t>=-32768?(e[n.offset++]=209,G(e,t,n),3):t>=-2147483648?(e[n.offset++]=210,Q(e,t,n),5):(e[n.offset++]=211,te(e,t,n),9):ue(e,t>0?Number.MAX_SAFE_INTEGER:-Number.MAX_SAFE_INTEGER,n)}var fe={int8:Y,uint8:Z,int16:G,uint16:X,int32:Q,uint32:ee,int64:te,uint64:ne,bigint64:re,biguint64:ie,float32:oe,float64:se,boolean:ae,string:ce,number:ue,utf8Write:K,utf8Length:q},le=new ArrayBuffer(8),he=new Int32Array(le),de=new Float32Array(le),pe=new Float64Array(le),ve=new BigUint64Array(le),ge=new BigInt64Array(le);function ye(e,t,n){for(var r="",i=0,o=t.offset,s=t.offset+n;o<s;o++){var a=e[o];0!=(128&a)?192!=(224&a)?224!=(240&a)?240!=(248&a)?console.error("Invalid byte "+a.toString(16)):(i=(7&a)<<18|(63&e[++o])<<12|(63&e[++o])<<6|(63&e[++o])<<0)>=65536?(i-=65536,r+=String.fromCharCode(55296+(i>>>10),56320+(1023&i))):r+=String.fromCharCode(i):r+=String.fromCharCode((15&a)<<12|(63&e[++o])<<6|(63&e[++o])<<0):r+=String.fromCharCode((31&a)<<6|63&e[++o]):r+=String.fromCharCode(a)}return t.offset+=n,r}function me(e,t){return be(e,t)<<24>>24}function be(e,t){return e[t.offset++]}function Ee(e,t){return we(e,t)<<16>>16}function we(e,t){return e[t.offset++]|e[t.offset++]<<8}function Oe(e,t){return e[t.offset++]|e[t.offset++]<<8|e[t.offset++]<<16|e[t.offset++]<<24}function Ie(e,t){return Oe(e,t)>>>0}function Ae(e,t){return he[0]=Oe(e,t),de[0]}function Te(e,t){return he[0]=Oe(e,t),he[1]=Oe(e,t),pe[0]}function Se(e,t){var n=Ie(e,t);return Oe(e,t)*Math.pow(2,32)+n}function Re(e,t){var n=Ie(e,t);return Ie(e,t)*Math.pow(2,32)+n}function xe(e,t){return he[0]=Oe(e,t),he[1]=Oe(e,t),ge[0]}function Ce(e,t){return he[0]=Oe(e,t),he[1]=Oe(e,t),ve[0]}function Pe(e,t){return be(e,t)>0}function De(e,t){var n,r=e[t.offset++];return r<192?n=31&r:217===r?n=be(e,t):218===r?n=we(e,t):219===r&&(n=Ie(e,t)),ye(e,t,n)}function ke(e,t){var n=e[t.offset++];return n<128?n:202===n?Ae(e,t):203===n?Te(e,t):204===n?be(e,t):205===n?we(e,t):206===n?Ie(e,t):207===n?Re(e,t):208===n?me(e,t):209===n?Ee(e,t):210===n?Oe(e,t):211===n?Se(e,t):n>223?-1*(255-n+1):void 0}function Ne(e,t){var n=e[t.offset];return n<192&&n>160||217===n||218===n||219===n}var _e={utf8Read:ye,int8:me,uint8:be,int16:Ee,uint16:we,int32:Oe,uint32:Ie,float32:Ae,float64:Te,int64:Se,uint64:Re,bigint64:xe,biguint64:Ce,boolean:Pe,string:De,number:ke,stringCheck:Ne},Me={},je=new Map;function Le(e,t){t.constructor&&(je.set(t.constructor,e),Me[e]=t),t.encode&&(fe[e]=t.encode),t.decode&&(_e[e]=t.decode)}function Be(e){return Me[e]}function Fe(e){for(var t in e)Le(t,e[t]);return function(e){return yt(e)}}var $e=function(){function e(e){this.types={},this.schemas=new Map,this.hasFilters=!1,this.parentFiltered={},e&&this.discoverTypes(e)}e.register=function(t){var n=Object.getPrototypeOf(t);if(n!==St){var r=e.inheritedTypes.get(n);r||(r=new Set,e.inheritedTypes.set(n,r)),r.add(t)}};var t=e.prototype;return t.has=function(e){return this.schemas.has(e)},t.get=function(e){return this.types[e]},t.add=function(e,t){return void 0===t&&(t=this.schemas.size),!this.schemas.has(e)&&(this.types[t]=e,void 0===e[Symbol.metadata]&&Ve.initialize(e),this.schemas.set(e,t),!0)},t.getTypeId=function(e){return this.schemas.get(e)},t.discoverTypes=function(t,n,r,i){var o,s,a,c=this;if(i&&this.registerFilteredByParent(t,n,r),this.add(t)){null==(o=e.inheritedTypes.get(t))||o.forEach((function(e){c.discoverTypes(e,n,r,i)}));for(var u=t;(u=Object.getPrototypeOf(u))&&u!==St&&u!==Function.prototype;)this.discoverTypes(u);var f=null!=(a=t[s=Symbol.metadata])?a:t[s]={};for(var l in f[$]&&(this.hasFilters=!0),f){var h=l,d=f[h].type,p=void 0!==f[h].tag;if("string"!=typeof d)if(Array.isArray(d)){var v=d[0];if("string"===v)continue;this.discoverTypes(v,t,h,i||p)}else if("function"==typeof d)this.discoverTypes(d,t,h,i||p);else{var g=Object.values(d)[0];if("string"==typeof g)continue;this.discoverTypes(g,t,h,i||p)}}}},t.registerFilteredByParent=function(e,t,n){var r,i=""+(null!=(r=this.schemas.get(e))?r:this.schemas.size);t&&(i+="-"+this.schemas.get(t)),i+="-"+n,this.parentFiltered[i]=!0},t.debug=function(){var e=this,t="",n=function(){var n=r.split("-").map(Number),i=n.pop();t+="\n\t\t",t+=r+": "+n.reverse().map((function(t,n){var r=e.types[t],o=r[Symbol.metadata],s=r.name;return 0===n&&(s+="["+o[i].name+"]"),""+s})).join(" -> ")};for(var r in this.parentFiltered)n();return"TypeContext ->\n\tSchema types: "+this.schemas.size+"\n\thasFilters: "+this.hasFilters+"\n\tparentFiltered:"+t},e}();function Ue(e){return Array.isArray(e)?{array:e[0]}:void 0!==e.type?e.type:e}$e.inheritedTypes=new Map;var Ve={addField:function(e,t,n,r,i){if(t>64)throw new Error("Can't define field '"+n+"'.\nSchema instances may only have up to 64 fields.");e[t]=Object.assign(e[t]||{},{type:Ue(r),index:t,name:n}),Object.defineProperty(e,L,{value:e[L]||{},enumerable:!1,configurable:!0}),i?(e[L][n]=i,e[L]["_"+n]={value:void 0,writable:!0,enumerable:!1,configurable:!0}):e[L][n]={value:void 0,writable:!0,enumerable:!0,configurable:!0},Object.defineProperty(e,B,{value:t,enumerable:!1,configurable:!0}),Object.defineProperty(e,n,{value:t,enumerable:!1,configurable:!0}),"string"!=typeof e[t].type&&(void 0===e[F]&&Object.defineProperty(e,F,{value:[],enumerable:!1,configurable:!0}),e[F].push(t))},setTag:function(e,t,n){var r=e[t];e[r].tag=n,e[$]||(Object.defineProperty(e,$,{value:[],enumerable:!1,configurable:!0}),Object.defineProperty(e,U,{value:{},enumerable:!1,configurable:!0})),e[$].push(r),e[U][n]||(e[U][n]=[]),e[U][n].push(r)},setFields:function(e,t){var n,r,i=e.prototype.constructor;$e.register(i);var o=Object.getPrototypeOf(i),s=o&&o[Symbol.metadata],a=Ve.initialize(i);i[R]||(i[R]=St[R]),i[x]||(i[x]=St[x]),i[C]||(i[C]=St[C]),i.prototype.toJSON||(i.prototype.toJSON=St.prototype.toJSON);var c=null!=(n=null!=(r=a[B])?r:s&&s[B])?n:-1;for(var u in c++,t){var f=t[u],l=Array.isArray(f)?Be("array"):"string"==typeof Object.keys(f)[0]&&Be(Object.keys(f)[0]),h=l?Object.values(f)[0]:Ue(f);Ve.addField(a,c,u,f,mt("_"+u,c,h,l)),c++}return e},isDeprecated:function(e,t){return!0===e[t].deprecated},init:function(e){var t={};e[Symbol.metadata]=t,Object.defineProperty(t,B,{value:0,enumerable:!1,configurable:!0})},initialize:function(e){var t,n=Object.getPrototypeOf(e),r=n[Symbol.metadata],i=null!=(t=e[Symbol.metadata])?t:Object.create(null);return n!==St&&i===r&&(i=Object.create(null),r&&(Object.setPrototypeOf(i,r),Object.defineProperty(i,B,{value:r[B],enumerable:!1,configurable:!0,writable:!0}),void 0!==r[$]&&(Object.defineProperty(i,$,{value:[].concat(r[$]),enumerable:!1,configurable:!0,writable:!0}),Object.defineProperty(i,U,{value:p({},r[U]),enumerable:!1,configurable:!0,writable:!0})),void 0!==r[F]&&Object.defineProperty(i,F,{value:[].concat(r[F]),enumerable:!1,configurable:!0,writable:!0}),Object.defineProperty(i,L,{value:p({},r[L]),enumerable:!1,configurable:!0,writable:!0}))),e[Symbol.metadata]=i,i},isValidInstance:function(e){return e.constructor[Symbol.metadata]&&Object.prototype.hasOwnProperty.call(e.constructor[Symbol.metadata],B)},getFields:function(e){for(var t=e[Symbol.metadata],n={},r=0;r<=t[B];r++)n[t[r].name]=t[r].type;return n}};function ze(e,t){var n=e.indexes[t];void 0===n?e.indexes[t]=e.operations.push(t)-1:e.operations[n]=t}function He(e,t){var n=e.indexes[t];void 0!==n&&(e.operations[n]=void 0),delete e.indexes[t]}function We(e,t,n,r){void 0===r&&(r=t[n].queueRootIndex),e&&e[n][r]!==t&&(t[n].queueRootIndex=e[n].push(t)-1)}var Je=function(){function t(e){this.isFiltered=!1,this.indexedOperations={},this.changes={indexes:{},operations:[]},this.allChanges={indexes:{},operations:[]},this.isNew=!0,this.ref=e;var t=e.constructor[Symbol.metadata];null!=t&&t[$]&&(this.allFilteredChanges={indexes:{},operations:[]},this.filteredChanges={indexes:{},operations:[]})}var n=t.prototype;return n.setRoot=function(e){var t=this;this.root=e,this.checkIsFiltered(this.parent,this.parentIndex);var n,r=this.ref.constructor[Symbol.metadata];r?null==(n=r[F])||n.forEach((function(n){var i=r[n],o=t.ref[i.name];null==o||o[N].setRoot(e)})):this.ref[_]&&"string"!=typeof this.ref[_]&&this.ref.forEach((function(t,n){t[N].setRoot(e)}))},n.setParent=function(e,t,n){var r=this;if(this.parent=e,this.parentIndex=n,t){t!==this.root?(this.root=t,this.checkIsFiltered(e,n)):t.add(this);var i,o=this.ref.constructor[Symbol.metadata];o?null==(i=o[F])||i.forEach((function(e){var n=o[e],i=r.ref[n.name];null==i||i[N].setParent(r.ref,t,e)})):this.ref[_]&&"string"!=typeof this.ref[_]&&this.ref.forEach((function(e,n){var i;e[N].setParent(r.ref,t,null!=(i=r.indexes[n])?i:n)}))}},n.forEachChild=function(e){var t,n=this,r=this.ref.constructor[Symbol.metadata];r?null==(t=r[F])||t.forEach((function(t){var i=r[t],o=n.ref[i.name];o&&e(o[N],t)})):this.ref[_]&&"string"!=typeof this.ref[_]&&this.ref.forEach((function(t,r){var i;e(t[N],null!=(i=n.indexes[r])?i:r)}))},n.operation=function(e){this.changes.operations.push(-e),We(this.root,this,"changes")},n.change=function(t,n){var r;void 0===n&&(n=e.OPERATION.ADD);var i=this.ref.constructor[Symbol.metadata],o=this.isFiltered||void 0!==(null==i||null==(r=i[t])?void 0:r.tag),s=o?this.filteredChanges:this.changes,a=this.indexedOperations[t];if(!a||a===e.OPERATION.DELETE){var c=a&&a===e.OPERATION.DELETE?e.OPERATION.DELETE_AND_ADD:n;this.indexedOperations[t]=c}ze(s,t),o?(ze(this.allFilteredChanges,t),this.root&&(We(this.root,this,"filteredChanges"),We(this.root,this,"allFilteredChanges"))):(ze(this.allChanges,t),We(this.root,this,"changes"))},n.shiftChangeIndexes=function(e){var t=this.isFiltered?this.filteredChanges:this.changes,n={},r={};for(var i in this.indexedOperations)n[Number(i)+e]=this.indexedOperations[i],r[Number(i)+e]=t[i];this.indexedOperations=n,t.indexes=r,t.operations=t.operations.map((function(t){return t+e}))},n.shiftAllChangeIndexes=function(e,t){void 0===t&&(t=0),void 0!==this.filteredChanges?(this._shiftAllChangeIndexes(e,t,this.allFilteredChanges),this._shiftAllChangeIndexes(e,t,this.allChanges)):this._shiftAllChangeIndexes(e,t,this.allChanges)},n._shiftAllChangeIndexes=function(e,t,n){void 0===t&&(t=0);var r={};for(var i in n.indexes){var o=n.indexes[i];o>t?r[Number(i)+e]=o:r[i]=o}n.indexes=r;for(var s=0;s<n.operations.length;s++){var a=n.operations[s];a>t&&(n.operations[s]=a+e)}},n.indexedOperation=function(e,t,n){void 0===n&&(n=e),this.indexedOperations[e]=t,void 0!==this.filteredChanges?(ze(this.allFilteredChanges,n),ze(this.filteredChanges,e),We(this.root,this,"filteredChanges")):(ze(this.allChanges,n),ze(this.changes,e),We(this.root,this,"changes"))},n.getType=function(e){return Ve.isValidInstance(this.ref)?this.ref.constructor[Symbol.metadata][e].type:this.ref[_]},n.getChange=function(e){return this.indexedOperations[e]},n.getValue=function(e,t){return void 0===t&&(t=!1),this.ref[D](e,t)},n.delete=function(t,n,r){if(void 0===r&&(r=t),void 0!==t){var i=void 0!==this.filteredChanges?this.filteredChanges:this.changes;this.indexedOperations[t]=null!=n?n:e.OPERATION.DELETE,ze(i,t);var o,s=this.getValue(t);return s&&s[N]&&(null==(o=this.root)||o.remove(s[N])),He(this.allChanges,r),void 0!==this.filteredChanges?(He(this.allFilteredChanges,r),We(this.root,this,"filteredChanges")):We(this.root,this,"changes"),s}try{throw new Error("@colyseus/schema "+this.ref.constructor.name+": trying to delete non-existing index '"+t+"'")}catch(e){console.warn(e)}},n.endEncode=function(){var e,t;this.indexedOperations={},null==(e=(t=this.ref)[M])||e.call(t),this.isNew=!1},n.discard=function(e){var t,n,r=this;void 0===e&&(e=!1),null==(t=(n=this.ref)[M])||t.call(n),this.indexedOperations={},this.changes.indexes={},this.changes.operations.length=0,this.changes.queueRootIndex=void 0,void 0!==this.filteredChanges&&(this.filteredChanges.indexes={},this.filteredChanges.operations.length=0,this.filteredChanges.queueRootIndex=void 0),e&&(this.allChanges.indexes={},this.allChanges.operations.length=0,void 0!==this.allFilteredChanges&&(this.allFilteredChanges.indexes={},this.allFilteredChanges.operations.length=0),this.forEachChild((function(e,t){var n;return null==(n=r.root)?void 0:n.remove(e)})))},n.discardAll=function(){for(var e=Object.keys(this.indexedOperations),t=0,n=e.length;t<n;t++){var r=this.getValue(Number(e[t]));r&&r[N]&&r[N].discardAll()}this.discard()},n.ensureRefId=function(){void 0===this.refId&&(this.refId=this.root.getNextUniqueId())},n.checkIsFiltered=function(e,t){var n=this.root.add(this);this.root.types.hasFilters&&(this._checkFilteredByParent(e,t),void 0!==this.filteredChanges&&(We(this.root,this,"filteredChanges"),n&&this.root.allFilteredChanges.push(this))),this.isFiltered||(We(this.root,this,"changes"),n&&this.root.allChanges.push(this))},n._checkFilteredByParent=function(e,t){if(e){var n=Ve.isValidInstance(this.ref)?this.ref.constructor:this.ref[_];if(!Ve.isValidInstance(e)){var r=e[N];e=r.parent,t=r.parentIndex}var i=e.constructor,o=""+this.root.types.getTypeId(n);if(i&&(o+="-"+this.root.types.schemas.get(i)),o+="-"+t,this.isFiltered=e[N].isFiltered||this.root.types.parentFiltered[o],this.isFiltered&&(this.filteredChanges={indexes:{},operations:[]},this.allFilteredChanges={indexes:{},operations:[]},this.changes.operations.length>0)){var s=this.changes;this.changes=this.filteredChanges,this.filteredChanges=s;var a=this.allFilteredChanges;this.allFilteredChanges=this.allChanges,this.allChanges=a}}},d(t,[{key:"changed",get:function(){return Object.entries(this.indexedOperations).length>0}}]),t}();function qe(t,n,r,i,o,s){var a;"string"==typeof r?null==(a=fe[r])||a.call(fe,n,i,s):void 0!==r[Symbol.metadata]?(fe.number(n,i[N].refId,s),(o&e.OPERATION.ADD)===e.OPERATION.ADD&&t.tryEncodeTypeId(n,r,i.constructor,s)):fe.number(n,i[N].refId,s)}var Ke=function(t,n,r,i,o,s,a,c,u){if(n[s.offset++]=255&(i|o),o!==e.OPERATION.DELETE){var f=r.ref,l=u[i];qe(t,n,u[i].type,f[l.name],o,s)}},Ye=function(t,n,r,i,o,s){if(n[s.offset++]=255&o,o!==e.OPERATION.CLEAR&&(fe.number(n,i,s),o!==e.OPERATION.DELETE)){var a=r.ref;if((o&e.OPERATION.ADD)===e.OPERATION.ADD&&"function"==typeof a.set){var c=r.ref.$indexes.get(i);fe.string(n,c,s)}qe(t,n,a[_],a[D](i),o,s)}},Ze=function(t,n,r,i,o,s,a,c){var u,f=r.ref;c&&r.isFiltered&&"string"!=typeof r.getType(i)?(u=f.tmpItems[i][N].refId,o===e.OPERATION.DELETE?o=e.OPERATION.DELETE_BY_REFID:o===e.OPERATION.ADD&&(o=e.OPERATION.ADD_BY_REFID)):u=i,n[s.offset++]=255&o,o!==e.OPERATION.CLEAR&&o!==e.OPERATION.REVERSE&&(fe.number(n,u,s),o!==e.OPERATION.DELETE&&qe(t,n,r.getType(i),r.getValue(i,a),o,s))},Ge=-1;function Xe(t,n,r,i,o,s,a,c){var u,f=t.root,l=r[D](i);if((n&e.OPERATION.DELETE)===e.OPERATION.DELETE){var h=f.refIds.get(l);void 0!==h&&f.removeRef(h),n!==e.OPERATION.DELETE_AND_ADD&&r[k](i),u=void 0}if(n===e.OPERATION.DELETE);else if(St.is(o)){var d=_e.number(s,a);if(u=f.refs.get(d),(n&e.OPERATION.ADD)===e.OPERATION.ADD){var p=t.getInstanceType(s,a,o);u||(u=t.createInstanceOfType(p)),f.addRef(d,u,u!==l||n===e.OPERATION.DELETE_AND_ADD&&u===l)}}else if("string"==typeof o)u=_e[o](s,a);else{var v=Be(Object.keys(o)[0]),g=_e.number(s,a),y=f.refs.has(g)?l||f.refs.get(g):new v.constructor;if((u=y.clone(!0))[_]=Object.values(o)[0],l){var m=f.refIds.get(l);if(void 0!==m&&g!==m)for(var b,E=l.entries();(b=E.next())&&!b.done;){var w=b.value,O=w[0],I=w[1];"object"==typeof I&&(m=f.refIds.get(I),f.removeRef(m)),c.push({ref:l,refId:m,op:e.OPERATION.DELETE,field:O,value:void 0,previousValue:I})}}f.addRef(g,u,y!==l||n===e.OPERATION.DELETE_AND_ADD&&y===l)}return{value:u,previousValue:l}}var Qe,et,tt=function(e,t,n,r,i){var o=t[n.offset++],s=r.constructor[Symbol.metadata],a=o>>6<<6,c=o%(a||255),u=s[c];if(void 0===u)return console.warn("@colyseus/schema: field not defined at",{index:c,ref:r.constructor.name,metadata:s}),Ge;var f=Xe(e,a,r,c,u.type,t,n,i),l=f.value,h=f.previousValue;null!=l&&(r[u.name]=l),h!==l&&i.push({ref:r,refId:e.currentRefId,op:a,field:u.name,value:l,previousValue:h})},nt=function(t,n,r,i,o){var s=n[r.offset++];if(s===e.OPERATION.CLEAR)return t.removeChildRefs(i,o),void i.clear();var a,c=_e.number(n,r),u=i[_];(s&e.OPERATION.ADD)===e.OPERATION.ADD?"function"==typeof i.set?(a=_e.string(n,r),i.setIndex(c,a)):a=c:a=i.getIndex(c);var f=Xe(t,s,i,c,u,n,r,o),l=f.value,h=f.previousValue;if(null!=l)if("function"==typeof i.set)i.$items.set(a,l);else if("function"==typeof i.$setAt)i.$setAt(c,l,s);else if("function"==typeof i.add){var d=i.add(l);"number"==typeof d&&i.setIndex(d,d)}h!==l&&o.push({ref:i,refId:t.currentRefId,op:s,field:"",dynamicIndex:a,value:l,previousValue:h})},rt=function(t,n,r,i,o){var s,a=n[r.offset++];if(a===e.OPERATION.CLEAR)return t.removeChildRefs(i,o),void i.clear();if(a!==e.OPERATION.REVERSE){if(a===e.OPERATION.DELETE_BY_REFID){var c=_e.number(n,r),u=t.root.refs.get(c);return s=i.findIndex((function(e){return e===u})),i[k](s),void o.push({ref:i,refId:t.currentRefId,op:e.OPERATION.DELETE,field:"",dynamicIndex:s,value:void 0,previousValue:u})}if(a===e.OPERATION.ADD_BY_REFID){var f=_e.number(n,r),l=t.root.refs.get(f);s=l?i.findIndex((function(e){return e===l})):i.length}else s=_e.number(n,r);var h=s,d=Xe(t,a,i,s,i[_],n,r,o),p=d.value,v=d.previousValue;null!=p&&p!==v&&i.$setAt(s,p,a),v!==p&&o.push({ref:i,refId:t.currentRefId,op:a,field:"",dynamicIndex:h,value:p,previousValue:v})}else i.reverse()},it=function(e){function t(){return e.apply(this,arguments)||this}return s(t,e),t}(a(Error));function ot(e,t,n,r){var i,o=!1;switch(t){case"number":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":case"int64":case"uint64":case"float32":case"float64":i="number",isNaN(e)&&console.log('trying to encode "NaN" in '+n.constructor.name+"#"+r);break;case"bigint64":case"biguint64":i="bigint";break;case"string":i="string",o=!0;break;case"boolean":default:return}if(typeof e!==i&&(!o||o&&null!==e)){var s="'"+JSON.stringify(e)+"'"+(e&&e.constructor&&" ("+e.constructor.name+")"||"");throw new it("a '"+i+"' was expected, but "+s+" was provided in "+n.constructor.name+"#"+r)}}function st(e,t,n,r){if(!(e instanceof t))throw new it("a '"+t.name+"' was expected, but '"+(e&&e.constructor.name)+"' was provided in "+n.constructor.name+"#"+r)}var at=function(e,t){var n=e.toString(),r=t.toString();return n<r?-1:n>r?1:0};Qe=x,et=C,t=P,n=Symbol.iterator,r=Symbol.species;var ct,ut,ft=function(){function i(){var t=this;this.items=[],this.tmpItems=[],this.deletedIndexes={},Object.defineProperty(this,_,{value:void 0,enumerable:!1,writable:!0,configurable:!0});var n=new Proxy(this,{get:function(e,n){return"symbol"==typeof n||isNaN(n)?Reflect.get(e,n):t.items[n]},set:function(n,r,i){if("symbol"==typeof r||isNaN(r))return Reflect.set(n,r,i);if(null==i)n.$deleteAt(r);else{if(i[N]){st(i,n[_],n,r);var o,s=n.items[r];void 0!==s?(i[N].isNew?t[N].indexedOperation(Number(r),e.OPERATION.MOVE_AND_ADD):(n[N].getChange(Number(r))&e.OPERATION.DELETE)===e.OPERATION.DELETE?t[N].indexedOperation(Number(r),e.OPERATION.DELETE_AND_MOVE):t[N].indexedOperation(Number(r),e.OPERATION.MOVE),null==(o=s[N].root)||o.remove(s[N])):i[N].isNew&&t[N].indexedOperation(Number(r),e.OPERATION.ADD),i[N].setParent(t,n[N].root,r)}else n.$changeAt(Number(r),i);t.items[r]=i,t.tmpItems[r]=i}return!0},deleteProperty:function(e,t){return"number"==typeof t?e.$deleteAt(t):delete e[t],!0},has:function(e,n){return"symbol"==typeof n||isNaN(Number(n))?Reflect.has(e,n):Reflect.has(t.items,n)}});return this[N]=new Je(n),this[N].indexes={},arguments.length>0&&this.push.apply(this,arguments),n}i[t]=function(e,t,n){var r;return!n||"string"==typeof e[_]||n.items.has(null==(r=e.tmpItems[t])?void 0:r[N])},i.is=function(e){return Array.isArray(e)||void 0!==e.array},i.from=function(e){return c(i,Array.from(e))};var o=i.prototype;return o.push=function(){for(var t=this.tmpItems.length,n=this[N],r=0;r<arguments.length;r++,t++){var i,o=r<0||arguments.length<=r?void 0:arguments[r];if(null==o)return;"object"==typeof o&&this[_]&&st(o,this[_],this,r),n.indexedOperation(t,e.OPERATION.ADD,this.items.length),this.items.push(o),this.tmpItems.push(o),null==(i=o[N])||i.setParent(this,n.root,t)}return t},o.pop=function(){for(var e=-1,t=this.tmpItems.length-1;t>=0;t--)if(!0!==this.deletedIndexes[t]){e=t;break}if(!(e<0))return this[N].delete(e,void 0,this.items.length-1),this.deletedIndexes[e]=!0,this.items.pop()},o.at=function(e){return e<0&&(e+=this.length),this.items[e]},o.$changeAt=function(t,n){var r,i,o;if(null!=n){if(this.items[t]!==n){var s=this[N],a=null!=(r=null==(i=s.indexes)||null==(i=i[t])?void 0:i.op)?r:e.OPERATION.ADD;s.change(t,a),null==(o=n[N])||o.setParent(this,s.root,t)}}else console.error("ArraySchema items cannot be null nor undefined; Use `deleteAt(index)` instead.")},o.$deleteAt=function(e,t){this[N].delete(e,t)},o.$setAt=function(t,n,r){0===t&&r===e.OPERATION.ADD&&void 0!==this.items[t]?this.items.unshift(n):r===e.OPERATION.DELETE_AND_MOVE?(this.items.splice(t,1),this.items[t]=n):this.items[t]=n},o.clear=function(){if(0!==this.items.length){var t=this[N];t.forEachChild((function(e,t){e.discard(!0);var n=e.root;void 0!==n&&(n.removeChangeFromChangeSet("changes",e),n.removeChangeFromChangeSet("allChanges",e),n.removeChangeFromChangeSet("allFilteredChanges",e))})),t.discard(!0),t.operation(e.OPERATION.CLEAR),this.items.length=0,this.tmpItems.length=0}},o.concat=function(){var e;return c(i,(e=this.items).concat.apply(e,arguments))},o.join=function(e){return this.items.join(e)},o.reverse=function(){return this[N].operation(e.OPERATION.REVERSE),this.items.reverse(),this.tmpItems.reverse(),this},o.shift=function(){var e=this;if(0!==this.items.length){var t=this.tmpItems.findIndex((function(t,n){return t===e.items[0]})),n=this[N];return n.delete(t),n.shiftAllChangeIndexes(-1,t),this.items.shift()}},o.slice=function(e,t){var n=new i;return n.push.apply(n,this.items.slice(e,t)),n},o.sort=function(t){void 0===t&&(t=at);var n=this[N];return this.items.sort(t).forEach((function(t,r){return n.change(r,e.OPERATION.REPLACE)})),this.tmpItems.sort(t),this},o.splice=function(t,n){var r;void 0===n&&(n=this.items.length-t);for(var i=this[N],o=this.tmpItems.length,s=arguments.length,a=new Array(s>2?s-2:0),c=2;c<s;c++)a[c-2]=arguments[c];for(var u=a.length,f=[],l=0;l<o;l++)!0!==this.deletedIndexes[l]&&f.push(l);for(var h=t;h<t+n;h++){var d=f[h];i.delete(d),this.deletedIndexes[d]=!0}for(var p=0;p<u;p++){var v,g=f[t]+p;i.indexedOperation(g,e.OPERATION.ADD),null==(v=a[p][N])||v.setParent(this,i.root,g)}return n>u&&i.shiftAllChangeIndexes(-(n-u),f[t+u]),(r=this.items).splice.apply(r,[t,n].concat(a))},o.unshift=function(){for(var t,n,r=this[N],i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.shiftChangeIndexes(o.length),r.isFiltered?ze(r.filteredChanges,this.items.length):ze(r.allChanges,this.items.length),o.forEach((function(t,n){r.change(n,e.OPERATION.ADD)})),(t=this.tmpItems).unshift.apply(t,o),(n=this.items).unshift.apply(n,o)},o.indexOf=function(e,t){return this.items.indexOf(e,t)},o.lastIndexOf=function(e,t){return void 0===t&&(t=this.length-1),this.items.lastIndexOf(e,t)},o.every=function(e,t){return this.items.every(e,t)},o.some=function(e,t){return this.items.some(e,t)},o.forEach=function(e,t){return this.items.forEach(e,t)},o.map=function(e,t){return this.items.map(e,t)},o.filter=function(e,t){return this.items.filter(e,t)},o.reduce=function(e,t){return this.items.reduce(e,t)},o.reduceRight=function(e,t){return this.items.reduceRight(e,t)},o.find=function(e,t){return this.items.find(e,t)},o.findIndex=function(e,t){return this.items.findIndex(e,t)},o.fill=function(e,t,n){throw new Error("ArraySchema#fill() not implemented")},o.copyWithin=function(e,t,n){throw new Error("ArraySchema#copyWithin() not implemented")},o.toString=function(){return this.items.toString()},o.toLocaleString=function(){return this.items.toLocaleString()},o[n]=function(){return this.items[Symbol.iterator]()},o.entries=function(){return this.items.entries()},o.keys=function(){return this.items.keys()},o.values=function(){return this.items.values()},o.includes=function(e,t){return this.items.includes(e,t)},o.flatMap=function(e,t){throw new Error("ArraySchema#flatMap() is not supported.")},o.flat=function(e){throw new Error("ArraySchema#flat() is not supported.")},o.findLast=function(){return this.items.findLast.apply(this.items,arguments)},o.findLastIndex=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.items.findLastIndex.apply(this.items,arguments)},o.with=function(e,t){var n=this.items.slice();return e<0&&(e+=this.length),n[e]=t,c(i,n)},o.toReversed=function(){return this.items.slice().reverse()},o.toSorted=function(e){return this.items.slice().sort(e)},o.toSpliced=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this.items.toSpliced.apply(copy,arguments)},o[D]=function(e,t){return void 0===t&&(t=!1),t||this.deletedIndexes[e]?this.items[e]:this.tmpItems[e]||this.items[e]},o[k]=function(e){this.items[e]=void 0,this.tmpItems[e]=void 0},o[M]=function(){this.tmpItems=this.items.slice(),this.deletedIndexes={}},o[j]=function(){this.items=this.items.filter((function(e){return void 0!==e})),this.tmpItems=this.items.slice()},o.toArray=function(){return this.items.slice(0)},o.toJSON=function(){return this.toArray().map((function(e){return"function"==typeof e.toJSON?e.toJSON():e}))},o.clone=function(e){var t,n;return e?(n=t=new i).push.apply(n,this.items):t=c(i,this.map((function(e){return e[N]?e.clone():e}))),t},d(i,[{key:"length",get:function(){return this.items.length},set:function(e){0===e?this.clear():e<this.items.length?this.splice(e,this.length-e):console.warn("ArraySchema: can't set .length to a higher value than its length.")}}],[{key:r,get:function(){return i}}]),i}();(b=ft)[Qe]=Ze,b[et]=rt,Le("array",{constructor:ft}),ct=x,ut=C,o=P,u=Symbol.iterator,f=Symbol.toStringTag,l=Symbol.species;var lt=function(){function t(e){var n=this;if(this.$items=new Map,this.$indexes=new Map,this.deletedItems={},this[N]=new Je(this),this[N].indexes={},e)if(e instanceof Map||e instanceof t)e.forEach((function(e,t){return n.set(t,e)}));else for(var r in e)this.set(r,e[r]);Object.defineProperty(this,_,{value:void 0,enumerable:!1,writable:!0,configurable:!0})}t[o]=function(e,t,n){var r;return!n||"string"==typeof e[_]||n.items.has((null!=(r=e[D](t))?r:e.deletedItems[t])[N])},t.is=function(e){return void 0!==e.map};var n=t.prototype;return n[u]=function(){return this.$items[Symbol.iterator]()},n.set=function(t,n){if(null==n)throw new Error("MapSchema#set('"+t+"', "+n+"): trying to set "+n+" value on '"+t+"'.");"object"==typeof n&&this[_]&&st(n,this[_],this,t),t=t.toString();var r,i,o=this[N],s=void 0!==n[N];if(void 0!==o.indexes[t]){r=o.indexes[t],i=e.OPERATION.REPLACE;var a,c=this.$items.get(t);if(c===n)return;s&&(i=e.OPERATION.DELETE_AND_ADD,void 0!==c&&(null==(a=c[N].root)||a.remove(c[N])))}else{var u;r=null!=(u=o.indexes[B])?u:0,i=e.OPERATION.ADD,this.$indexes.set(r,t),o.indexes[t]=r,o.indexes[B]=r+1}return this.$items.set(t,n),o.change(r,i),s&&n[N].setParent(this,o.root,r),this},n.get=function(e){return this.$items.get(e)},n.delete=function(e){var t=this[N].indexes[e];return this.deletedItems[t]=this[N].delete(t),this.$items.delete(e)},n.clear=function(){var t=this[N];t.discard(!0),t.indexes={},this.$indexes.clear(),this.$items.clear(),t.operation(e.OPERATION.CLEAR)},n.has=function(e){return this.$items.has(e)},n.forEach=function(e){this.$items.forEach(e)},n.entries=function(){return this.$items.entries()},n.keys=function(){return this.$items.keys()},n.values=function(){return this.$items.values()},n.setIndex=function(e,t){this.$indexes.set(e,t)},n.getIndex=function(e){return this.$indexes.get(e)},n[D]=function(e){return this.$items.get(this.$indexes.get(e))},n[k]=function(e){var t=this.$indexes.get(e);this.$items.delete(t),this.$indexes.delete(e)},n[M]=function(){this.deletedItems={}},n.toJSON=function(){var e={};return this.forEach((function(t,n){e[n]="function"==typeof t.toJSON?t.toJSON():t})),e},n.clone=function(e){var n;return e?n=Object.assign(new t,this):(n=new t,this.forEach((function(e,t){e[N]?n.set(t,e.clone()):n.set(t,e)}))),n},d(t,[{key:f,get:function(){return this.$items[Symbol.toStringTag]}},{key:"size",get:function(){return this.$items.size}}],[{key:l,get:function(){return t}}]),t}();(E=lt)[ct]=Ye,E[ut]=nt,Le("map",{constructor:lt});var ht,dt,pt=-1;function vt(e){return $e.register(e),e}function gt(e){return void 0===e&&(e=pt),function(t,n){var r,i,o=t.constructor,s=Object.getPrototypeOf(o)[Symbol.metadata],a=null!=(i=o[r=Symbol.metadata])?i:o[r]=Object.assign({},o[Symbol.metadata],null!=s?s:Object.create(null));Ve.setTag(a,n,e)}}function yt(e,t){return function(n,r){var i=n.constructor;if(!e)throw new Error(i.name+': @type() reference provided for "'+r+"\" is undefined. Make sure you don't have any circular dependencies.");$e.register(i);var o=Object.getPrototypeOf(i)[Symbol.metadata],s=Ve.initialize(i),a=s[r];if(void 0!==s[a]){if(s[a].deprecated)return;if(void 0!==s[a].type)try{throw new Error("@colyseus/schema: Duplicate '"+r+"' definition on '"+i.name+"'.\nCheck @type() annotation")}catch(e){var c=e.stack.split("\n")[4].trim();throw new Error(e.message+" "+c)}}else{var u,f;a=null!=(u=null!=(f=s[B])?f:o&&o[B])?u:-1,a++}if(t&&t.manual)Ve.addField(s,a,r,e,{enumerable:!0,configurable:!0,writable:!0});else{var l=Array.isArray(e)?Be("array"):"string"==typeof Object.keys(e)[0]&&Be(Object.keys(e)[0]),h=l?Object.values(e)[0]:e;Ve.addField(s,a,r,e,mt("_"+r,a,h,l))}}}function mt(t,n,r,i){return{get:function(){return this[t]},set:function(o){var s,a=null!=(s=this[t])?s:void 0;if(o!==a){if(null!=o){var u;i?(i.constructor!==ft||o instanceof ft||(o=c(ft,o)),i.constructor!==lt||o instanceof lt||(o=new lt(o)),o[_]=r):"string"!=typeof r?st(o,r,this,t.substring(1)):ot(o,r,this,t.substring(1));var f,l=this[N];void 0!==a&&a[N]?(null==(f=l.root)||f.remove(a[N]),this.constructor[R](l,n,e.OPERATION.DELETE_AND_ADD)):this.constructor[R](l,n,e.OPERATION.ADD),null==(u=o[N])||u.setParent(this,l.root,n)}else void 0!==a&&this[N].delete(n);this[t]=o}},enumerable:!0,configurable:!0}}function bt(e){return void 0===e&&(e=!0),function(t,n){var r,i,o=t.constructor,s=Object.getPrototypeOf(o)[Symbol.metadata],a=null!=(i=o[r=Symbol.metadata])?i:o[r]=Object.assign({},o[Symbol.metadata],null!=s?s:Object.create(null)),c=a[n];a[c].deprecated=!0,e&&(null!=a[L]||(a[L]={}),a[L][n]={get:function(){throw new Error(n+" is deprecated.")},set:function(e){},enumerable:!1,configurable:!0}),Object.defineProperty(a,c,{value:a[c],enumerable:!1,configurable:!0})}}function Et(e,t,n){for(var r in t)yt(t[r],n)(e.prototype,r);return e}function wt(e,t,n){void 0===n&&(n=St);var r={},i={};for(var o in e){var a=e[o];"object"==typeof a&&(void 0!==a.default&&(r[o]=a.default),void 0!==a.view&&(i[o]="boolean"==typeof a.view?pt:a.view))}var c=Ve.setFields(function(e){function t(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return n[0]=Object.assign({},r,n[0]),e.call.apply(e,[this].concat(n))||this}return s(t,e),t}(n),e);for(var u in i)gt(i[u])(c.prototype,u);return t&&Object.defineProperty(c,"name",{value:t}),c.extends=function(e,t){return wt(e,t,c)},c}function Ot(e){return new Array(e).fill(0).map((function(t,n){return n===e-1?"└─ ":"   "})).join("")}function It(t){var n=t[N].root,r={ops:{},refs:[]};return n.changes.forEach((function(t){var n=t.indexedOperations;for(var i in r.refs.push("refId#"+t.refId),n){var o=n[i],s=e.OPERATION[o];r.ops[s]||(r.ops[s]=0),r.ops[e.OPERATION[o]]++}})),r}ht=x,dt=C,h=R;var At,Tt,St=function(){function t(){t.initialize(this),(arguments.length<=0?void 0:arguments[0])&&Object.assign(this,arguments.length<=0?void 0:arguments[0])}t.initialize=function(e){var t;Object.defineProperty(e,N,{value:new Je(e),enumerable:!1,writable:!0}),Object.defineProperties(e,(null==(t=e.constructor[Symbol.metadata])?void 0:t[L])||{})},t.is=function(e){return"object"==typeof e[Symbol.metadata]},t[h]=function(t,n,r){void 0===r&&(r=e.OPERATION.ADD),t.change(n,r)},t[P]=function(e,t,n){var r,i=null==(r=e.constructor[Symbol.metadata][t])?void 0:r.tag;if(void 0===n)return void 0===i;if(void 0===i)return!0;if(i===pt)return n.items.has(e[N]);var o,s=null==(o=n.tags)?void 0:o.get(e[N]);return s&&s.has(i)};var n=t.prototype;return n.assign=function(e){return Object.assign(this,e),this},n.setDirty=function(e,t){var n=this.constructor[Symbol.metadata];this[N].change(n[n[e]].index,t)},n.clone=function(){var e=new this.constructor,t=this.constructor[Symbol.metadata];for(var n in t){var r,i=t[n].name;"object"==typeof this[i]&&"function"==typeof(null==(r=this[i])?void 0:r.clone)?e[i]=this[i].clone():e[i]=this[i]}return e},n.toJSON=function(){var e={},t=this.constructor[Symbol.metadata];for(var n in t){var r=t[n],i=r.name;r.deprecated||null===this[i]||void 0===this[i]||(e[i]="function"==typeof this[i].toJSON?this[i].toJSON():this[i])}return e},n.discardAllChanges=function(){this[N].discardAll()},n[D]=function(e){return this[this.constructor[Symbol.metadata][e].name]},n[k]=function(e){this[this.constructor[Symbol.metadata][e].name]=void 0},t.debugRefIds=function(e,t,n){var r=this;void 0===t&&(t=!1),void 0===n&&(n=0);var i=t?" - "+JSON.stringify(e.toJSON()):"",o=e[N],s=o.refId,a="";return a+=""+Ot(n)+e.constructor.name+" (refId: "+s+")"+i+"\n",o.forEachChild((function(e){return a+=r.debugRefIds(e.ref,t,n+1)})),a},t.debugChanges=function(t,n){void 0===n&&(n=!1);var r=t[N],i=n?r.allChanges:r.changes,o=n?"allChanges":"changes",s=t.constructor.name+" ("+r.refId+") -> ."+o+":\n";function a(t){t.operations.filter((function(e){return e})).forEach((function(t){var i=r.indexedOperations[t];console.log({index:t,operation:i}),s+="- ["+t+"]: "+e.OPERATION[i]+" ("+JSON.stringify(r.getValue(Number(t),n))+")\n"}))}return a(i),!n&&r.filteredChanges&&r.filteredChanges.operations.filter((function(e){return e})).length>0&&(s+=t.constructor.name+" ("+r.refId+") -> .filteredChanges:\n",a(r.filteredChanges)),n&&r.allFilteredChanges&&r.allFilteredChanges.operations.filter((function(e){return e})).length>0&&(s+=t.constructor.name+" ("+r.refId+") -> .allFilteredChanges:\n",a(r.allFilteredChanges)),s},t.debugChangesDeep=function(t,n){void 0===n&&(n="changes");for(var r="",o=t[N],s=o.root,a=new Map,c=[],u=0,f=0,l=Object.entries(s[n]);f<l.length;f++){var h,d=l[f],p=d[0],v=d[1],g=s.changeTrees[p],y=!1,m=[],b=null==(h=g.parent)?void 0:h[N];if(g===o)y=!0;else for(;void 0!==b;){var E;if(m.push(b),b.ref===t){y=!0;break}b=null==(E=b.parent)?void 0:E[N]}y&&(c.push(g.refId),u+=Object.keys(v).length,a.set(g,m.reverse()))}r+="---\n",r+="root refId: "+o.refId+"\n",r+="Total instances: "+c.length+" (refIds: "+c.join(", ")+")\n",r+="Total changes: "+u+"\n",r+="---\n";for(var w,O=new WeakSet,I=i(a.entries());!(w=I()).done;){var A=w.value,T=A[0],S=A[1];S.forEach((function(e,t){O.has(e)||(r+=""+Ot(t)+e.ref.constructor.name+" (refId: "+e.refId+")\n",O.add(e))}));var R=T.indexedOperations,x=S.length,C=Ot(x),P=x>0?"("+T.parentIndex+") ":"";for(var D in r+=""+C+P+T.ref.constructor.name+" (refId: "+T.refId+") - changes: "+Object.keys(R).length+"\n",R){var k=R[D];r+=""+Ot(x+1)+e.OPERATION[k]+": "+D+"\n"}}return""+r},t}();(w=St)[ht]=Ke,w[dt]=tt,At=x,Tt=C,v=P,g=Symbol.iterator;var Rt,xt,Ct=function(){function t(e){var t=this;this.$items=new Map,this.$indexes=new Map,this.$refId=0,this[N]=new Je(this),this[N].indexes={},e&&e.forEach((function(e){return t.add(e)})),Object.defineProperty(this,_,{value:void 0,enumerable:!1,writable:!0,configurable:!0})}t[v]=function(e,t,n){return!n||"string"==typeof e[_]||n.items.has(e[D](t)[N])},t.is=function(e){return void 0!==e.collection};var n=t.prototype;return n.add=function(e){var t=this.$refId++;return void 0!==e[N]&&e[N].setParent(this,this[N].root,t),this[N].indexes[t]=t,this.$indexes.set(t,t),this.$items.set(t,e),this[N].change(t),t},n.at=function(e){var t=Array.from(this.$items.keys())[e];return this.$items.get(t)},n.entries=function(){return this.$items.entries()},n.delete=function(e){for(var t,n,r=this.$items.entries();(n=r.next())&&!n.done;)if(e===n.value[1]){t=n.value[0];break}return void 0!==t&&(this[N].delete(t),this.$indexes.delete(t),this.$items.delete(t))},n.clear=function(){var t=this[N];t.discard(!0),t.indexes={},this.$indexes.clear(),this.$items.clear(),t.operation(e.OPERATION.CLEAR)},n.has=function(e){return Array.from(this.$items.values()).some((function(t){return t===e}))},n.forEach=function(e){var t=this;this.$items.forEach((function(n,r,i){return e(n,r,t)}))},n.values=function(){return this.$items.values()},n[g]=function(){return this.$items.values()},n.setIndex=function(e,t){this.$indexes.set(e,t)},n.getIndex=function(e){return this.$indexes.get(e)},n[D]=function(e){return this.$items.get(this.$indexes.get(e))},n[k]=function(e){var t=this.$indexes.get(e);this.$items.delete(t),this.$indexes.delete(e)},n.toArray=function(){return Array.from(this.$items.values())},n.toJSON=function(){var e=[];return this.forEach((function(t,n){e.push("function"==typeof t.toJSON?t.toJSON():t)})),e},n.clone=function(e){var n;return e?n=Object.assign(new t,this):(n=new t,this.forEach((function(e){e[N]?n.add(e.clone()):n.add(e)}))),n},d(t,[{key:"size",get:function(){return this.$items.size}}]),t}();(O=Ct)[At]=Ye,O[Tt]=nt,Le("collection",{constructor:Ct}),Rt=x,xt=C,y=P,m=Symbol.iterator;var Pt=function(){function t(e){var t=this;this.$items=new Map,this.$indexes=new Map,this.$refId=0,this[N]=new Je(this),this[N].indexes={},e&&e.forEach((function(e){return t.add(e)})),Object.defineProperty(this,_,{value:void 0,enumerable:!1,writable:!0,configurable:!0})}t[y]=function(e,t,n){return!n||"string"==typeof e[_]||n.items.has(e[D](t)[N])},t.is=function(e){return void 0!==e.set};var n=t.prototype;return n.add=function(t){var n,r;if(this.has(t))return!1;var i=this.$refId++;void 0!==t[N]&&t[N].setParent(this,this[N].root,i);var o=null!=(n=null==(r=this[N].indexes[i])?void 0:r.op)?n:e.OPERATION.ADD;return this[N].indexes[i]=i,this.$indexes.set(i,i),this.$items.set(i,t),this[N].change(i,o),i},n.entries=function(){return this.$items.entries()},n.delete=function(e){for(var t,n,r=this.$items.entries();(n=r.next())&&!n.done;)if(e===n.value[1]){t=n.value[0];break}return void 0!==t&&(this[N].delete(t),this.$indexes.delete(t),this.$items.delete(t))},n.clear=function(){var t=this[N];t.discard(!0),t.indexes={},this.$indexes.clear(),this.$items.clear(),t.operation(e.OPERATION.CLEAR)},n.has=function(e){for(var t,n=this.$items.values(),r=!1;(t=n.next())&&!t.done;)if(e===t.value){r=!0;break}return r},n.forEach=function(e){var t=this;this.$items.forEach((function(n,r,i){return e(n,r,t)}))},n.values=function(){return this.$items.values()},n[m]=function(){return this.$items.values()},n.setIndex=function(e,t){this.$indexes.set(e,t)},n.getIndex=function(e){return this.$indexes.get(e)},n[D]=function(e){return this.$items.get(this.$indexes.get(e))},n[k]=function(e){var t=this.$indexes.get(e);this.$items.delete(t),this.$indexes.delete(e)},n.toArray=function(){return Array.from(this.$items.values())},n.toJSON=function(){var e=[];return this.forEach((function(t,n){e.push("function"==typeof t.toJSON?t.toJSON():t)})),e},n.clone=function(e){var n;return e?n=Object.assign(new t,this):(n=new t,this.forEach((function(e){e[N]?n.add(e.clone()):n.add(e)}))),n},d(t,[{key:"size",get:function(){return this.$items.size}}]),t}();function Dt(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}function kt(e,t){if(-1===t||t>=e.length)return!1;for(var n=e.length-1,r=t;r<n;r++)e[r]=e[r+1];return e.length=n,!0}(I=Pt)[Rt]=Ye,I[xt]=nt,Le("set",{constructor:Pt}),"function"==typeof SuppressedError&&SuppressedError;var Nt=function(){function t(e){this.types=e,this.nextUniqueId=0,this.refCount={},this.changeTrees={},this.allChanges=[],this.allFilteredChanges=[],this.changes=[],this.filteredChanges=[]}var n=t.prototype;return n.getNextUniqueId=function(){return this.nextUniqueId++},n.add=function(t){t.ensureRefId();var n=void 0===this.changeTrees[t.refId];n&&(this.changeTrees[t.refId]=t);var r=this.refCount[t.refId];if(0===r)for(var i=t.allChanges.operations,o=i.length;o--;)t.indexedOperations[i[o]]=e.OPERATION.ADD,ze(t.changes,o);return this.refCount[t.refId]=(r||0)+1,n},n.remove=function(e){var t=this,n=this.refCount[e.refId]-1;return n<=0?(e.root=void 0,delete this.changeTrees[e.refId],this.removeChangeFromChangeSet("allChanges",e),this.removeChangeFromChangeSet("changes",e),e.filteredChanges&&(this.removeChangeFromChangeSet("allFilteredChanges",e),this.removeChangeFromChangeSet("filteredChanges",e)),this.refCount[e.refId]=0):(this.refCount[e.refId]=n,void 0!==e.filteredChanges?(this.removeChangeFromChangeSet("filteredChanges",e),We(this,e,"filteredChanges")):(this.removeChangeFromChangeSet("changes",e),We(this,e,"changes"))),e.forEachChild((function(e,n){return t.remove(e)})),n},n.removeChangeFromChangeSet=function(e,t){var n=this[e];if(kt(n,n.indexOf(t)))return t[e].queueRootIndex=-1,!0},n.clear=function(){this.changes.length=0},t}(),_t=function(){function t(e){this.sharedBuffer=Buffer.allocUnsafe(t.BUFFER_SIZE),this.context=new $e(e.constructor),this.root=new Nt(this.context),this.setState(e)}var n=t.prototype;return n.setState=function(e){this.state=e,this.state[N].setRoot(this.root)},n.encode=function(t,n,r,i,o,s){void 0===t&&(t={offset:0}),void 0===r&&(r=this.sharedBuffer),void 0===i&&(i="changes"),void 0===o&&(o="allChanges"===i),void 0===s&&(s=t.offset);for(var a=void 0!==n,c=this.state[N],u=!o&&!a,f=this.root[i],l=0,h=f.length;l<h;l++){var d=f[l];if(a){if(!n.items.has(d)){n.invisible.add(d);continue}n.invisible.has(d)&&n.invisible.delete(d)}var p=d[i],v=d.ref,g=p.operations.length;if(0!==g){var y=v.constructor,m=y[x],b=y[P],E=y[Symbol.metadata];(a||t.offset>s||d!==c)&&(r[t.offset++]=255&T,fe.number(r,d.refId,t));for(var w=0;w<g;w++){var O=p.operations[w],I=O<0?Math.abs(O):o?e.OPERATION.ADD:d.indexedOperations[O];void 0===O||void 0===I||b&&!b(v,O,n)||m(this,r,d,O,I,t,o,a,E)}}}if(t.offset>r.byteLength){var A,S,R=Math.ceil(t.offset/(null!=(A=Buffer.poolSize)?A:8192))*(null!=(S=Buffer.poolSize)?S:8192);return console.warn('@colyseus/schema buffer overflow. Encoded state is higher than default BUFFER_SIZE. Use the following to increase default BUFFER_SIZE:\n\n     import { Encoder } from "@colyseus/schema";\n     Encoder.BUFFER_SIZE = '+Math.round(R/1024)+" * 1024; // "+Math.round(R/1024)+" KB\n "),(r=Buffer.alloc(R,r))===this.sharedBuffer&&(this.sharedBuffer=r),this.encode({offset:s},n,r,i,o)}if(u)for(var C=0,D=f.length;C<D;C++){var k=f[C];k.discard(),k.isNew=!1}return r.subarray(0,t.offset)},n.encodeAll=function(e,t){return void 0===e&&(e={offset:0}),void 0===t&&(t=this.sharedBuffer),this.encode(e,void 0,t,"allChanges",!0)},n.encodeAllView=function(e,t,n,r){void 0===r&&(r=this.sharedBuffer);var i=n.offset;return this.encode(n,e,r,"allFilteredChanges",!0,i),Buffer.concat([r.subarray(0,t),r.subarray(i,n.offset)])},n.debugChanges=function(t){("string"==typeof t?this.root[t]:t).forEach((function(n){var r=n[t],i=n.ref.constructor[Symbol.metadata];for(var o in console.log("->",{ref:n.ref.constructor.name,refId:n.refId,changes:Object.keys(r).length}),r){var s=r[o];console.log("  ->",{index:o,field:null==i?void 0:i[o],op:e.OPERATION[s]})}}))},n.encodeView=function(t,n,r,o){void 0===o&&(o=this.sharedBuffer);for(var s,a=r.offset,c=i(t.changes);!(s=c()).done;){var u=s.value,f=u[0],l=u[1],h=this.root.changeTrees[f];if(void 0!==h){var d=Object.keys(l);if(0!==d.length){var p=h.ref.constructor,v=p[x],g=p[Symbol.metadata];o[r.offset++]=255&T,fe.number(o,h.refId,r);for(var y=0,m=d.length;y<m;y++){var b=Number(d[y]),E=h.ref[D](b);v(this,o,h,b,void 0!==E&&l[b]||e.OPERATION.DELETE,r,!1,!0,g)}}}else t.changes.delete(f)}return t.changes.clear(),this.encode(r,t,o,"filteredChanges",!1,a),Buffer.concat([o.subarray(0,n),o.subarray(a,r.offset)])},n.discardChanges=function(){var e=this.root.changes.length;if(e>0){for(;e--;){var t;null==(t=this.root.changes[e])||t.endEncode()}this.root.changes.length=0}if((e=this.root.filteredChanges.length)>0){for(;e--;){var n;null==(n=this.root.filteredChanges[e])||n.endEncode()}this.root.filteredChanges.length=0}},n.tryEncodeTypeId=function(e,t,n,r){var i=this.context.getTypeId(t),o=this.context.getTypeId(n);void 0!==o?i!==o&&(e[r.offset++]=255&S,fe.number(e,o,r)):console.warn('@colyseus/schema WARNING: Class "'+n.name+'" is not registered on TypeRegistry - Please either tag the class with @entity or define a @type() field.')},d(t,[{key:"hasChanges",get:function(){return this.root.changes.length>0||this.root.filteredChanges.length>0}}]),t}();_t.BUFFER_SIZE="undefined"!=typeof Buffer&&Buffer.poolSize||8192;var Mt=function(e){function t(t){var n;return(n=e.call(this,t)||this).name="DecodingWarning",n}return s(t,e),t}(a(Error)),jt=function(){function t(){this.refs=new Map,this.refIds=new WeakMap,this.refCounts={},this.deletedRefs=new Set,this.callbacks={},this.nextUniqueId=0}var n=t.prototype;return n.getNextUniqueId=function(){return this.nextUniqueId++},n.addRef=function(e,t,n){void 0===n&&(n=!0),this.refs.set(e,t),this.refIds.set(t,e),n&&(this.refCounts[e]=(this.refCounts[e]||0)+1),this.deletedRefs.has(e)&&this.deletedRefs.delete(e)},n.removeRef=function(e){var t=this.refCounts[e];if(void 0!==t)if(0!==t)(this.refCounts[e]=t-1)<=0&&this.deletedRefs.add(e);else try{var n=this.refs.get(e);throw new Mt("trying to remove refId '"+e+"' with 0 refCount ("+n.constructor.name+": "+JSON.stringify(n)+")")}catch(e){console.warn(e)}else try{throw new Mt("trying to remove refId that doesn't exist: "+e)}catch(e){console.warn(e)}},n.clearRefs=function(){this.refs.clear(),this.deletedRefs.clear(),this.callbacks={},this.refCounts={}},n.garbageCollectDeletedRefs=function(){var e=this;this.deletedRefs.forEach((function(t){if(!(e.refCounts[t]>0)){var n=e.refs.get(t);if(Ve.isValidInstance(n)){var r=n.constructor[Symbol.metadata];for(var i in r){var o=r[i].name,s="object"==typeof n[o]&&e.refIds.get(n[o]);s&&!e.deletedRefs.has(s)&&e.removeRef(s)}}else"function"==typeof Object.values(n[_])[0]&&Array.from(n.values()).forEach((function(t){var n=e.refIds.get(t);e.deletedRefs.has(n)||e.removeRef(n)}));e.refs.delete(t),delete e.refCounts[t],delete e.callbacks[t]}})),this.deletedRefs.clear()},n.addCallback=function(t,n,r){var i=this;if(void 0===t){var o="number"==typeof n?e.OPERATION[n]:n;throw new Error("Can't addCallback on '"+o+"' (refId is undefined)")}return this.callbacks[t]||(this.callbacks[t]={}),this.callbacks[t][n]||(this.callbacks[t][n]=[]),this.callbacks[t][n].push(r),function(){return i.removeCallback(t,n,r)}},n.removeCallback=function(e,t,n){var r,i=null==(r=this.callbacks)||null==(r=r[e])||null==(r=r[t])?void 0:r.indexOf(n);-1!==i&&kt(this.callbacks[e][t],i)},t}(),Lt=function(){function t(e,t){this.currentRefId=0,this.setState(e),this.context=t||new $e(e.constructor)}var n=t.prototype;return n.setState=function(e){this.state=e,this.root=new jt,this.root.addRef(0,e)},n.decode=function(e,t,n){var r,i,o;void 0===t&&(t={offset:0}),void 0===n&&(n=this.state);var s=[],a=this.root,c=e.byteLength,u=n.constructor[C];for(this.currentRefId=0;t.offset<c;)if(e[t.offset]!=T)if(u(this,e,t,n,s)!==Ge);else{console.warn("@colyseus/schema: definition mismatch");for(var f={offset:t.offset};t.offset<c&&(e[t.offset]!==T||(f.offset=t.offset+1,!a.refs.has(_e.number(e,f))));)t.offset++}else{var l,h;t.offset++,this.currentRefId=_e.number(e,t);var d=a.refs.get(this.currentRefId);if(!d)throw new Error('"refId" not found: '+this.currentRefId);null==(l=(h=n)[j])||l.call(h),u=(n=d).constructor[C]}return null==(r=(i=n)[j])||r.call(i),null==(o=this.triggerChanges)||o.call(this,s),a.garbageCollectDeletedRefs(),s},n.getInstanceType=function(e,t,n){var r;if(e[t.offset]===S){t.offset++;var i=_e.number(e,t);r=this.context.get(i)}return r||n},n.createInstanceOfType=function(e){return new e},n.removeChildRefs=function(t,n){var r=this,i="string"!=typeof t[_],o=this.root.refIds.get(t);t.forEach((function(s,a){n.push({ref:t,refId:o,op:e.OPERATION.DELETE,field:a,value:void 0,previousValue:s}),i&&r.root.removeRef(r.root.refIds.get(s))}))},t}(),Bt=function(e){function t(){return e.apply(this,arguments)||this}return s(t,e),t}(St);Dt([yt("string")],Bt.prototype,"name",void 0),Dt([yt("string")],Bt.prototype,"type",void 0),Dt([yt("number")],Bt.prototype,"referencedType",void 0);var Ft=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).fields=new ft,t}return s(t,e),t}(St);Dt([yt("number")],Ft.prototype,"id",void 0),Dt([yt("number")],Ft.prototype,"extendsId",void 0),Dt([yt([Bt])],Ft.prototype,"fields",void 0);var $t=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).types=new ft,t}return s(t,e),t.encode=function(e,n){void 0===n&&(n={offset:0});var r=e.context,i=new t,o=new _t(i),s=r.schemas.get(e.state.constructor);s>0&&(i.rootType=s);var a=function(e,t){for(var n in t){var o=Number(n),s=t[o].name;if(Object.prototype.hasOwnProperty.call(t,s)){var a=new Bt;a.name=s;var c=void 0,u=t[o].type;if("string"==typeof u)c=u;else{var f=void 0;St.is(u)?(c="ref",f=u):"string"==typeof u[c=Object.keys(u)[0]]?c+=":"+u[c]:f=u[c],a.referencedType=f?r.getTypeId(f):-1}a.type=c,e.fields.push(a)}}i.types.push(e)};for(var c in r.types){var u=r.types[c],f=new Ft;f.id=Number(c);var l=Object.getPrototypeOf(u);l!==St&&(f.extendsId=r.schemas.get(l)),a(f,u[Symbol.metadata])}var h=o.encodeAll(n);return Buffer.from(h,0,n.offset)},t.decode=function(e,n){var r=new t;new Lt(r).decode(e,n);var i=new $e;r.types.forEach((function(e){var t,n=function(e){function t(){return e.apply(this,arguments)||this}return s(t,e),t}(null!=(t=i.get(e.extendsId))?t:St);$e.register(n),i.add(n,e.id)}),{});var o=function(e,t,n){t.fields.forEach((function(t,r){var o=n+r;if(void 0!==t.referencedType){var s,a=t.type,c=i.get(t.referencedType);if(!c){var u=t.type.split(":");a=u[0],c=u[1]}"ref"===a?Ve.addField(e,o,t.name,c):Ve.addField(e,o,t.name,((s={})[a]=c,s))}else Ve.addField(e,o,t.name,t.type)}))};r.types.forEach((function(e){var t=i.get(e.id),n=Ve.initialize(t),s=[],a=e;do{s.push(a),a=r.types.find((function(e){return e.id===a.extendsId}))}while(a);var c=0;s.reverse().forEach((function(e){o(n,e,c),c+=e.fields.length}))}));var a=new(i.get(r.rootType||0));return new Lt(a,i)},t}(St);function Ut(t){var n,r=t.root,i=r.callbacks,o=new WeakMap;function s(t,i){var c,u=(null==(c=i.instance)?void 0:c.constructor[Symbol.metadata])||t,f=i.instance&&"function"==typeof i.instance.forEach||t&&void 0===t[Symbol.metadata];if(u&&!f){var l=function(e,t,s,a){return a&&void 0!==i.instance[t]&&!o.has(n)&&s(i.instance[t],void 0),r.addCallback(r.refIds.get(e),t,s)};return new Proxy({listen:function(e,t,r){if(void 0===r&&(r=!0),i.instance)return l(i.instance,e,t,r);var s=function(){};return i.onInstanceAvailable((function(i,a){s=l(i,e,t,r&&a&&!o.has(n))})),function(){return s()}},onChange:function(t){return r.addCallback(r.refIds.get(i.instance),e.OPERATION.REPLACE,t)},bindTo:function(t,n){return n||(n=Object.keys(u).map((function(e){return u[e].name}))),r.addCallback(r.refIds.get(i.instance),e.OPERATION.REPLACE,(function(){n.forEach((function(e){return t[e]=i.instance[e]}))}))}},{get:function(e,t){var n=u[u[t]];if(n){var o,c=null==(o=i.instance)?void 0:o[t],f=function(e){var n=a(i.instance).listen(t,(function(t,r){e(t,!1),null==n||n()}),!1);void 0!==r.refIds.get(c)&&e(c,!0)};return s(n.type,{instance:r.refIds.get(c)&&c,parentInstance:i.instance,onInstanceAvailable:f})}return e[t]},has:function(e,t){return void 0!==u[t]},set:function(e,t,n){throw new Error("not allowed")},deleteProperty:function(e,t){throw new Error("not allowed")}})}var h=function(t,i,s){return s&&t.forEach((function(e,t){return i(e,t)})),r.addCallback(r.refIds.get(t),e.OPERATION.ADD,(function(e,t){o.set(i,!0),n=i,i(e,t),o.delete(i),n=void 0}))},d=function(t,n){return r.addCallback(r.refIds.get(t),e.OPERATION.DELETE,n)},p=function(t,n){return r.addCallback(r.refIds.get(t),e.OPERATION.REPLACE,n)};return new Proxy({onAdd:function(e,t){if(void 0===t&&(t=!0),i.instance)return h(i.instance,e,t&&!o.has(n));if(i.onInstanceAvailable){var r=function(){};return i.onInstanceAvailable((function(i,s){r=h(i,e,t&&s&&!o.has(n))})),function(){return r()}}},onRemove:function(e){if(i.instance)return d(i.instance,e);if(i.onInstanceAvailable){var t=function(){};return i.onInstanceAvailable((function(n){t=d(n,e)})),function(){return t()}}},onChange:function(e){if(i.instance)return p(i.instance,e);if(i.onInstanceAvailable){var t=function(){};return i.onInstanceAvailable((function(n){t=p(n,e)})),function(){return t()}}}},{get:function(e,t){if(!e[t])throw new Error("Can't access '"+t+"' through callback proxy. access the instance directly.");return e[t]},has:function(e,t){return void 0!==e[t]},set:function(e,t,n){throw new Error("not allowed")},deleteProperty:function(e,t){throw new Error("not allowed")}})}function a(e){return s(void 0,{instance:e})}return t.triggerChanges=function(t){for(var n=new Set,o=0,s=t.length;o<s;o++){var a=t[o],c=a.refId,u=a.ref,f=i[c];if(f){if((a.op&e.OPERATION.DELETE)===e.OPERATION.DELETE&&a.previousValue instanceof St)for(var l,h=null==(l=i[r.refIds.get(a.previousValue)])?void 0:l[e.OPERATION.DELETE],d=(null==h?void 0:h.length)-1;d>=0;d--)h[d]();if(u instanceof St){if(!n.has(c))for(var p=null==f?void 0:f[e.OPERATION.REPLACE],v=(null==p?void 0:p.length)-1;v>=0;v--)p[v]();if(f.hasOwnProperty(a.field))for(var g=f[a.field],y=(null==g?void 0:g.length)-1;y>=0;y--)g[y](a.value,a.previousValue)}else{if((a.op&e.OPERATION.DELETE)===e.OPERATION.DELETE){if(void 0!==a.previousValue)for(var m=f[e.OPERATION.DELETE],b=(null==m?void 0:m.length)-1;b>=0;b--){var E;m[b](a.previousValue,null!=(E=a.dynamicIndex)?E:a.field)}if((a.op&e.OPERATION.ADD)===e.OPERATION.ADD)for(var w=f[e.OPERATION.ADD],O=(null==w?void 0:w.length)-1;O>=0;O--){var I;w[O](a.value,null!=(I=a.dynamicIndex)?I:a.field)}}else if((a.op&e.OPERATION.ADD)===e.OPERATION.ADD&&void 0===a.previousValue)for(var A=f[e.OPERATION.ADD],T=(null==A?void 0:A.length)-1;T>=0;T--){var S;A[T](a.value,null!=(S=a.dynamicIndex)?S:a.field)}if(a.value!==a.previousValue&&(void 0!==a.value||void 0!==a.previousValue))for(var R=f[e.OPERATION.REPLACE],x=(null==R?void 0:R.length)-1;x>=0;x--){var C;R[x](a.value,null!=(C=a.dynamicIndex)?C:a.field)}}n.add(c)}}},a}function Vt(e,t){e.triggerChanges=t}Dt([yt([Ft])],$t.prototype,"types",void 0),Dt([yt("number")],$t.prototype,"rootType",void 0);var zt=function(){function t(){this.items=new WeakSet,this.invisible=new WeakSet,this.changes=new Map}var n=t.prototype;return n.add=function(t,n,r){var i=this;if(void 0===n&&(n=pt),void 0===r&&(r=!0),!t[N])return console.warn("StateView#add(), invalid object:",t),this;var o=t.constructor[Symbol.metadata],s=t[N];this.items.add(s),r&&s.parent&&this.addParentOf(s,n);var a,c,u=this.changes.get(s.refId);if(void 0===u&&(u={},this.changes.set(s.refId,u)),n!==pt)this.tags||(this.tags=new WeakMap),this.tags.has(s)?c=this.tags.get(s):(c=new Set,this.tags.set(s,c)),c.add(n),null==o||null==(a=o[U])||null==(a=a[n])||a.forEach((function(t){s.getChange(t)!==e.OPERATION.DELETE&&(u[t]=e.OPERATION.ADD)}));else for(var f=this.invisible.has(s),l=void 0!==s.filteredChanges?s.allFilteredChanges:s.allChanges,h=0,d=l.operations.length;h<d;h++){var p,v=l.operations[h];if(void 0!==v){var g=null!=(p=s.indexedOperations[v])?p:e.OPERATION.ADD,y=null==o?void 0:o[v].tag;!f&&void 0!==y&&y!==n||g===e.OPERATION.DELETE||(u[v]=g)}}return s.forEachChild((function(e,t){o&&void 0!==o[t].tag&&o[t].tag!==n||i.add(e.ref,n,!1)})),this},n.addParentOf=function(t,n){var r=t.parent[N],i=t.parentIndex;if(!this.items.has(r)){var o;this.items.add(r);var s=null==(o=r.parent)?void 0:o[N];if(s&&void 0!==s.filteredChanges&&this.addParentOf(r,n),!this.invisible.has(r))return}if(r.getChange(i)!==e.OPERATION.DELETE){var a,c=this.changes.get(r.refId);void 0===c&&(c={},this.changes.set(r.refId,c)),this.tags||(this.tags=new WeakMap),this.tags.has(r)?a=this.tags.get(r):(a=new Set,this.tags.set(r,a)),a.add(n),c[i]=e.OPERATION.ADD}},n.remove=function(t,n){void 0===n&&(n=pt);var r=t[N];if(!r)return console.warn("StateView#remove(), invalid object:",t),this;this.items.delete(r);var i=r.ref.constructor[Symbol.metadata],o=this.changes.get(r.refId);if(void 0===o&&(o={},this.changes.set(r.refId,o)),n===pt){var s=r.parent;if(Ve.isValidInstance(s))i[$].forEach((function(t){return o[t]=e.OPERATION.DELETE}));else{var a=s[N],c=this.changes.get(a.refId);void 0===c&&(c={},this.changes.set(a.refId,c)),c[r.parentIndex]=e.OPERATION.DELETE}}else i[U][n].forEach((function(t){return o[t]=e.OPERATION.DELETE}));if(this.tags&&this.tags.has(r)){var u=this.tags.get(r);void 0===n?this.tags.delete(r):(u.delete(n),0===u.size&&this.tags.delete(r))}return this},n.has=function(e){return this.items.has(e[N])},n.hasTag=function(e,t){var n,r;void 0===t&&(t=pt);var i=null==(n=this.tags)?void 0:n.get(e[N]);return null!=(r=null==i?void 0:i.has(t))&&r},t}();Le("map",{constructor:lt}),Le("array",{constructor:ft}),Le("set",{constructor:Pt}),Le("collection",{constructor:Ct}),e.$changes=N,e.$childType=_,e.$decoder=C,e.$deleteByIndex=k,e.$encoder=x,e.$filter=P,e.$getByIndex=D,e.$track=R,e.ArraySchema=ft,e.ChangeTree=Je,e.CollectionSchema=Ct,e.Decoder=Lt,e.Encoder=_t,e.MapSchema=lt,e.Metadata=Ve,e.Reflection=$t,e.ReflectionField=Bt,e.ReflectionType=Ft,e.Schema=St,e.SetSchema=Pt,e.StateView=zt,e.TypeContext=$e,e.decode=_e,e.decodeKeyValueOperation=nt,e.decodeSchemaOperation=tt,e.defineCustomTypes=Fe,e.defineTypes=Et,e.deprecated=bt,e.dumpChanges=It,e.encode=fe,e.encodeArray=Ze,e.encodeKeyValueOperation=Ye,e.encodeSchemaOperation=Ke,e.entity=vt,e.getDecoderStateCallbacks=Ut,e.getRawChangesCallback=Vt,e.registerType=Le,e.schema=wt,e.type=yt,e.view=gt}(t)})),w=function(){function e(e){this.events=e,this.isOpen=!1,this.lengthPrefixBuffer=new Uint8Array(9)}return e.prototype.connect=function(e,t){var n=this;void 0===t&&(t={});var r=t.fingerprint&&{serverCertificateHashes:[{algorithm:"sha-256",value:new Uint8Array(t.fingerprint).buffer}]}||void 0;this.wt=new WebTransport(e,r),this.wt.ready.then((function(e){console.log("WebTransport ready!",e),n.isOpen=!0,n.unreliableReader=n.wt.datagrams.readable.getReader(),n.unreliableWriter=n.wt.datagrams.writable.getWriter(),n.wt.incomingBidirectionalStreams.getReader().read().then((function(e){n.reader=e.value.readable.getReader(),n.writer=e.value.writable.getWriter(),n.sendSeatReservation(t.room.roomId,t.sessionId,t.reconnectionToken),n.readIncomingData(),n.readIncomingUnreliableData()})).catch((function(e){console.error("failed to read incoming stream",e),console.error("TODO: close the connection")}))})).catch((function(e){console.log("WebTransport not ready!",e),n._close()})),this.wt.closed.then((function(e){console.log("WebTransport closed w/ success",e),n.events.onclose({code:e.closeCode,reason:e.reason})})).catch((function(e){console.log("WebTransport closed w/ error",e),n.events.onerror(e),n.events.onclose({code:e.closeCode,reason:e.reason})})).finally((function(){n._close()}))},e.prototype.send=function(e){var t=E.encode.number(this.lengthPrefixBuffer,e.length,{offset:0}),n=new Uint8Array(t+e.length);n.set(this.lengthPrefixBuffer.subarray(0,t),0),n.set(e,t),this.writer.write(n)},e.prototype.sendUnreliable=function(e){var t=E.encode.number(this.lengthPrefixBuffer,e.length,{offset:0}),n=new Uint8Array(t+e.length);n.set(this.lengthPrefixBuffer.subarray(0,t),0),n.set(e,t),this.unreliableWriter.write(n)},e.prototype.close=function(e,t){try{this.wt.close({closeCode:e,reason:t})}catch(e){console.error(e)}},e.prototype.readIncomingData=function(){return l(this,void 0,void 0,(function(){var e,t,n,r,i;return h(this,(function(o){switch(o.label){case 0:if(!this.isOpen)return[3,5];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.reader.read()];case 2:e=o.sent(),t=e.value,n={offset:0};do{r=E.decode.number(t,n),this.events.onmessage({data:t.subarray(n.offset,n.offset+r)}),n.offset+=r}while(n.offset<t.length);return[3,4];case 3:return-1===(i=o.sent()).message.indexOf("session is closed")&&console.error("H3Transport: failed to read incoming data",i),[3,5];case 4:return e.done?[3,5]:[3,0];case 5:return[2]}}))}))},e.prototype.readIncomingUnreliableData=function(){return l(this,void 0,void 0,(function(){var e,t,n,r,i;return h(this,(function(o){switch(o.label){case 0:if(!this.isOpen)return[3,5];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.unreliableReader.read()];case 2:e=o.sent(),t=e.value,n={offset:0};do{r=E.decode.number(t,n),this.events.onmessage({data:t.subarray(n.offset,n.offset+r)}),n.offset+=r}while(n.offset<t.length);return[3,4];case 3:return-1===(i=o.sent()).message.indexOf("session is closed")&&console.error("H3Transport: failed to read incoming data",i),[3,5];case 4:return e.done?[3,5]:[3,0];case 5:return[2]}}))}))},e.prototype.sendSeatReservation=function(e,t,n){var r={offset:0},i=[];E.encode.string(i,e,r),E.encode.string(i,t,r),n&&E.encode.string(i,n,r),this.writer.write(new Uint8Array(i).buffer)},e.prototype._close=function(){this.isOpen=!1},e}(),O=globalThis.WebSocket||function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")},I=function(){function e(e){this.events=e}return e.prototype.send=function(e){this.ws.send(e)},e.prototype.sendUnreliable=function(e){console.warn("colyseus.js: The WebSocket transport does not support unreliable messages")},e.prototype.connect=function(e){this.ws=new O(e,this.protocols),this.ws.binaryType="arraybuffer",this.ws.onopen=this.events.onopen,this.ws.onmessage=this.events.onmessage,this.ws.onclose=this.events.onclose,this.ws.onerror=this.events.onerror},e.prototype.close=function(e,t){this.ws.close(e,t)},Object.defineProperty(e.prototype,"isOpen",{get:function(){return this.ws.readyState===O.OPEN},enumerable:!1,configurable:!0}),e}(),A=function(){function e(e){switch(this.events={},e){case"h3":this.transport=new w(this.events);break;default:this.transport=new I(this.events)}}return e.prototype.connect=function(e,t){this.transport.connect.call(this.transport,e,t)},e.prototype.send=function(e){this.transport.send(e)},e.prototype.sendUnreliable=function(e){this.transport.sendUnreliable(e)},e.prototype.close=function(e,t){this.transport.close(e,t)},Object.defineProperty(e.prototype,"isOpen",{get:function(){return this.transport.isOpen},enumerable:!1,configurable:!0}),e}();e.Protocol=void 0,(m=e.Protocol||(e.Protocol={}))[m.HANDSHAKE=9]="HANDSHAKE",m[m.JOIN_ROOM=10]="JOIN_ROOM",m[m.ERROR=11]="ERROR",m[m.LEAVE_ROOM=12]="LEAVE_ROOM",m[m.ROOM_DATA=13]="ROOM_DATA",m[m.ROOM_STATE=14]="ROOM_STATE",m[m.ROOM_STATE_PATCH=15]="ROOM_STATE_PATCH",m[m.ROOM_DATA_SCHEMA=16]="ROOM_DATA_SCHEMA",m[m.ROOM_DATA_BYTES=17]="ROOM_DATA_BYTES",e.ErrorCode=void 0,(b=e.ErrorCode||(e.ErrorCode={}))[b.MATCHMAKE_NO_HANDLER=4210]="MATCHMAKE_NO_HANDLER",b[b.MATCHMAKE_INVALID_CRITERIA=4211]="MATCHMAKE_INVALID_CRITERIA",b[b.MATCHMAKE_INVALID_ROOM_ID=4212]="MATCHMAKE_INVALID_ROOM_ID",b[b.MATCHMAKE_UNHANDLED=4213]="MATCHMAKE_UNHANDLED",b[b.MATCHMAKE_EXPIRED=4214]="MATCHMAKE_EXPIRED",b[b.AUTH_FAILED=4215]="AUTH_FAILED",b[b.APPLICATION_ERROR=4216]="APPLICATION_ERROR";var T={};function S(e,t){T[e]=t}function R(e){var t=T[e];if(!t)throw new Error("missing serializer: "+e);return t}var x=function(){function e(){this.handlers=[]}return e.prototype.register=function(e,t){return this.handlers.push(e),this},e.prototype.invoke=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.handlers.forEach((function(n){return n.apply(e,t)}))},e.prototype.invokeAsync=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Promise.all(this.handlers.map((function(n){return n.apply(e,t)})))},e.prototype.remove=function(e){var t=this.handlers.indexOf(e);this.handlers[t]=this.handlers[this.handlers.length-1],this.handlers.pop()},e.prototype.clear=function(){this.handlers=[]},e}();function C(){var e=new x;function t(t){return e.register(t,null===this)}return t.once=function(t){e.register((function n(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];t.apply(this,r),e.remove(n)}))},t.remove=function(t){return e.remove(t)},t.invoke=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.invoke.apply(e,t)},t.invokeAsync=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.invokeAsync.apply(e,t)},t.clear=function(){return e.clear()},t}var P,D,k,N=function(){function e(){}return e.prototype.setState=function(e,t){this.decoder.decode(e,t)},e.prototype.getState=function(){return this.state},e.prototype.patch=function(e,t){return this.decoder.decode(e,t)},e.prototype.teardown=function(){this.decoder.root.clearRefs()},e.prototype.handshake=function(e,t){this.state?(E.Reflection.decode(e,t),this.decoder=new E.Decoder(this.state)):(this.decoder=E.Reflection.decode(e,t),this.state=this.decoder.state)},e}();try{P=new TextDecoder}catch(e){}var _,M,j,L,B,F=0,$={},U=0,V=0,z=[],H={useRecords:!1,mapsAsObjects:!0},W=function(){},J=new W;J.name="MessagePack 0xC1";var q=!1,K=2;try{new Function("")}catch(e){K=1/0}var Y=function(){function e(e){e&&(!1===e.useRecords&&void 0===e.mapsAsObjects&&(e.mapsAsObjects=!0),e.sequential&&!1!==e.trusted&&(e.trusted=!0,e.structures||0==e.useRecords||(e.structures=[],e.maxSharedStructures||(e.maxSharedStructures=0))),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0),e.int64AsNumber&&(e.int64AsType="number")),Object.assign(this,e)}var t=e.prototype;return t.unpack=function(t,n){var r=this;if(D)return Ae((function(){return Te(),r?r.unpack(t,n):e.prototype.unpack.call(H,t,n)}));t.buffer||t.constructor!==ArrayBuffer||(t="undefined"!=typeof Buffer?Buffer.from(t):new Uint8Array(t)),"object"==typeof n?(k=n.end||t.length,F=n.start||0):(F=0,k=n>-1?n:t.length),V=0,M=null,j=null,D=t;try{B=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength))}catch(e){if(D=null,t instanceof Uint8Array)throw e;throw new Error("Source must be a Uint8Array or Buffer but was a "+(t&&"object"==typeof t?t.constructor.name:typeof t))}if(this instanceof e){if($=this,this.structures)return _=this.structures,Z(n);(!_||_.length>0)&&(_=[])}else $=H,(!_||_.length>0)&&(_=[]);return Z(n)},t.unpackMultiple=function(e,t){var n,r=0;try{q=!0;var i=e.length,o=this?this.unpack(e,i):De.unpack(e,i);if(!t){for(n=[o];F<i;)r=F,n.push(Z());return n}if(!1===t(o,r,F))return;for(;F<i;)if(r=F,!1===t(Z(),r,F))return}catch(e){throw e.lastPosition=r,e.values=n,e}finally{q=!1,Te()}},t._mergeStructures=function(e,t){e=e||[],Object.isFrozen(e)&&(e=e.map((function(e){return e.slice(0)})));for(var n=0,r=e.length;n<r;n++){var i=e[n];i&&(i.isShared=!0,n>=32&&(i.highByte=n-32>>5))}for(var o in e.sharedLength=e.length,t||[])if(o>=0){var s=e[o],a=t[o];a&&(s&&((e.restoreStructures||(e.restoreStructures=[]))[o]=s),e[o]=a)}return this.structures=e},t.decode=function(e,t){return this.unpack(e,t)},e}();function Z(e){try{if(!$.trusted&&!q){var t=_.sharedLength||0;t<_.length&&(_.length=t)}var n;if($.randomAccessStructure&&D[F]<64&&D[F],n=X(),j&&(F=j.postBundlePosition,j=null),q&&(_.restoreStructures=null),F==k)_&&_.restoreStructures&&G(),_=null,D=null,L&&(L=null);else{if(F>k)throw new Error("Unexpected end of MessagePack data");if(!q){var r;try{r=JSON.stringify(n,(function(e,t){return"bigint"==typeof t?t+"n":t})).slice(0,100)}catch(e){r="(JSON view not available "+e+")"}throw new Error("Data read, but end of buffer not reached "+r)}}return n}catch(e){throw _&&_.restoreStructures&&G(),Te(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer")||F>k)&&(e.incomplete=!0),e}}function G(){for(var e in _.restoreStructures)_[e]=_.restoreStructures[e];_.restoreStructures=null}function X(){var e,t=D[F++];if(t<160){if(t<128){if(t<64)return t;var n=_[63&t]||$.getStructures&&ne()[63&t];return n?(n.read||(n.read=ee(n,63&t)),n.read()):t}if(t<144){if(t-=128,$.mapsAsObjects){for(var r={},i=0;i<t;i++){var o=ye();"__proto__"===o&&(o="__proto_"),r[o]=X()}return r}for(var s=new Map,a=0;a<t;a++)s.set(X(),X());return s}t-=144;for(var c=new Array(t),u=0;u<t;u++)c[u]=X();return $.freezeData?Object.freeze(c):c}if(t<192){var f=t-160;if(V>=F)return M.slice(F-U,(F+=f)-U);if(0==V&&k<140){var l=f<16?he(f):le(f);if(null!=l)return l}return re(f)}switch(t){case 192:return null;case 193:return j?(e=X())>0?j[1].slice(j.position1,j.position1+=e):j[0].slice(j.position0,j.position0-=e):J;case 194:return!1;case 195:return!0;case 196:if(void 0===(e=D[F++]))throw new Error("Unexpected end of buffer");return pe(e);case 197:return e=B.getUint16(F),F+=2,pe(e);case 198:return e=B.getUint32(F),F+=4,pe(e);case 199:return ve(D[F++]);case 200:return e=B.getUint16(F),F+=2,ve(e);case 201:return e=B.getUint32(F),F+=4,ve(e);case 202:if(e=B.getFloat32(F),$.useFloat32>2){var h=Se[(127&D[F])<<1|D[F+1]>>7];return F+=4,(h*e+(e>0?.5:-.5)>>0)/h}return F+=4,e;case 203:return e=B.getFloat64(F),F+=8,e;case 204:return D[F++];case 205:return e=B.getUint16(F),F+=2,e;case 206:return e=B.getUint32(F),F+=4,e;case 207:return"number"===$.int64AsType?(e=4294967296*B.getUint32(F),e+=B.getUint32(F+4)):"string"===$.int64AsType?e=B.getBigUint64(F).toString():"auto"===$.int64AsType?(e=B.getBigUint64(F))<=BigInt(2)<<BigInt(52)&&(e=Number(e)):e=B.getBigUint64(F),F+=8,e;case 208:return B.getInt8(F++);case 209:return e=B.getInt16(F),F+=2,e;case 210:return e=B.getInt32(F),F+=4,e;case 211:return"number"===$.int64AsType?(e=4294967296*B.getInt32(F),e+=B.getUint32(F+4)):"string"===$.int64AsType?e=B.getBigInt64(F).toString():"auto"===$.int64AsType?(e=B.getBigInt64(F))>=BigInt(-2)<<BigInt(52)&&e<=BigInt(2)<<BigInt(52)&&(e=Number(e)):e=B.getBigInt64(F),F+=8,e;case 212:if(114==(e=D[F++]))return be(63&D[F++]);var d=z[e];if(d)return d.read?(F++,d.read(X())):d.noBuffer?(F++,d()):d(D.subarray(F,++F));throw new Error("Unknown extension "+e);case 213:return 114==(e=D[F])?(F++,be(63&D[F++],D[F++])):ve(2);case 214:return ve(4);case 215:return ve(8);case 216:return ve(16);case 217:return e=D[F++],V>=F?M.slice(F-U,(F+=e)-U):ie(e);case 218:return e=B.getUint16(F),V>=(F+=2)?M.slice(F-U,(F+=e)-U):oe(e);case 219:return e=B.getUint32(F),V>=(F+=4)?M.slice(F-U,(F+=e)-U):se(e);case 220:return e=B.getUint16(F),F+=2,ce(e);case 221:return e=B.getUint32(F),F+=4,ce(e);case 222:return e=B.getUint16(F),F+=2,ue(e);case 223:return e=B.getUint32(F),F+=4,ue(e);default:if(t>=224)return t-256;if(void 0===t){var p=new Error("Unexpected end of MessagePack data");throw p.incomplete=!0,p}throw new Error("Unknown MessagePack token "+t)}}var Q=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function ee(e,t){function n(){if(n.count++>K){var r=e.read=new Function("r","return function(){return "+($.freezeData?"Object.freeze":"")+"({"+e.map((function(e){return"__proto__"===e?"__proto_:r()":Q.test(e)?e+":r()":"["+JSON.stringify(e)+"]:r()"})).join(",")+"})}")(X);return 0===e.highByte&&(e.read=te(t,e.read)),r()}for(var i={},o=0,s=e.length;o<s;o++){var a=e[o];"__proto__"===a&&(a="__proto_"),i[a]=X()}return $.freezeData?Object.freeze(i):i}return n.count=0,0===e.highByte?te(t,n):n}var te=function(e,t){return function(){var n=D[F++];if(0===n)return t();var r=e<32?-(e+(n<<5)):e+(n<<5),i=_[r]||ne()[r];if(!i)throw new Error("Record id is not defined for "+r);return i.read||(i.read=ee(i,e)),i.read()}};function ne(){var e=Ae((function(){return D=null,$.getStructures()}));return _=$._mergeStructures(e,_)}var re=ae,ie=ae,oe=ae,se=ae;function ae(e){var t;if(e<16&&(t=he(e)))return t;if(e>64&&P)return P.decode(D.subarray(F,F+=e));var n=F+e,r=[];for(t="";F<n;){var i=D[F++];if(0==(128&i))r.push(i);else if(192==(224&i)){var o=63&D[F++];r.push((31&i)<<6|o)}else if(224==(240&i)){var s=63&D[F++],a=63&D[F++];r.push((31&i)<<12|s<<6|a)}else if(240==(248&i)){var c=(7&i)<<18|(63&D[F++])<<12|(63&D[F++])<<6|63&D[F++];c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c)}else r.push(i);r.length>=4096&&(t+=fe.apply(String,r),r.length=0)}return r.length>0&&(t+=fe.apply(String,r)),t}function ce(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=X();return $.freezeData?Object.freeze(t):t}function ue(e){if($.mapsAsObjects){for(var t={},n=0;n<e;n++){var r=ye();"__proto__"===r&&(r="__proto_"),t[r]=X()}return t}for(var i=new Map,o=0;o<e;o++)i.set(X(),X());return i}var fe=String.fromCharCode;function le(e){for(var t=F,n=new Array(e),r=0;r<e;r++){var i=D[F++];if((128&i)>0)return void(F=t);n[r]=i}return fe.apply(String,n)}function he(e){if(e<4){if(e<2){if(0===e)return"";var t=D[F++];return(128&t)>1?void(F-=1):fe(t)}var n=D[F++],r=D[F++];if((128&n)>0||(128&r)>0)return void(F-=2);if(e<3)return fe(n,r);var i=D[F++];return(128&i)>0?void(F-=3):fe(n,r,i)}var o=D[F++],s=D[F++],a=D[F++],c=D[F++];if((128&o)>0||(128&s)>0||(128&a)>0||(128&c)>0)F-=4;else{if(e<6){if(4===e)return fe(o,s,a,c);var u=D[F++];return(128&u)>0?void(F-=5):fe(o,s,a,c,u)}if(e<8){var f=D[F++],l=D[F++];if((128&f)>0||(128&l)>0)return void(F-=6);if(e<7)return fe(o,s,a,c,f,l);var h=D[F++];return(128&h)>0?void(F-=7):fe(o,s,a,c,f,l,h)}var d=D[F++],p=D[F++],v=D[F++],g=D[F++];if((128&d)>0||(128&p)>0||(128&v)>0||(128&g)>0)F-=8;else{if(e<10){if(8===e)return fe(o,s,a,c,d,p,v,g);var y=D[F++];return(128&y)>0?void(F-=9):fe(o,s,a,c,d,p,v,g,y)}if(e<12){var m=D[F++],b=D[F++];if((128&m)>0||(128&b)>0)return void(F-=10);if(e<11)return fe(o,s,a,c,d,p,v,g,m,b);var E=D[F++];return(128&E)>0?void(F-=11):fe(o,s,a,c,d,p,v,g,m,b,E)}var w=D[F++],O=D[F++],I=D[F++],A=D[F++];if((128&w)>0||(128&O)>0||(128&I)>0||(128&A)>0)F-=12;else{if(e<14){if(12===e)return fe(o,s,a,c,d,p,v,g,w,O,I,A);var T=D[F++];return(128&T)>0?void(F-=13):fe(o,s,a,c,d,p,v,g,w,O,I,A,T)}var S=D[F++],R=D[F++];if(!((128&S)>0||(128&R)>0)){if(e<15)return fe(o,s,a,c,d,p,v,g,w,O,I,A,S,R);var x=D[F++];return(128&x)>0?void(F-=15):fe(o,s,a,c,d,p,v,g,w,O,I,A,S,R,x)}F-=14}}}}function de(){var e,t=D[F++];if(t<192)e=t-160;else switch(t){case 217:e=D[F++];break;case 218:e=B.getUint16(F),F+=2;break;case 219:e=B.getUint32(F),F+=4;break;default:throw new Error("Expected string")}return ae(e)}function pe(e){return $.copyBuffers?Uint8Array.prototype.slice.call(D,F,F+=e):D.subarray(F,F+=e)}function ve(e){var t,n=D[F++];if(z[n])return z[n](D.subarray(F,t=F+=e),(function(e){F=e;try{return X()}finally{F=t}}));throw new Error("Unknown extension type "+n)}var ge=new Array(4096);function ye(){var e=D[F++];if(!(e>=160&&e<192))return F--,me(X());if(e-=160,V>=F)return M.slice(F-U,(F+=e)-U);if(!(0==V&&k<180))return re(e);var t,n=4095&(e<<5^(e>1?B.getUint16(F):e>0?D[F]:0)),r=ge[n],i=F,o=F+e-3,s=0;if(r&&r.bytes==e){for(;i<o;){if((t=B.getUint32(i))!=r[s++]){i=1879048192;break}i+=4}for(o+=3;i<o;)if((t=D[i++])!=r[s++]){i=1879048192;break}if(i===o)return F=i,r.string;o-=3,i=F}for(r=[],ge[n]=r,r.bytes=e;i<o;)t=B.getUint32(i),r.push(t),i+=4;for(o+=3;i<o;)t=D[i++],r.push(t);var a=e<16?he(e):le(e);return r.string=null!=a?a:re(e)}function me(e){if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e||"bigint"==typeof e)return e.toString();if(null==e)return e+"";throw new Error("Invalid property type for record",typeof e)}var be=function(e,t){var n=X().map(me),r=e;void 0!==t&&(e=e<32?-((t<<5)+e):(t<<5)+e,n.highByte=t);var i=_[e];return i&&(i.isShared||q)&&((_.restoreStructures||(_.restoreStructures=[]))[e]=i),_[e]=n,n.read=ee(n,r),n.read()};z[0]=function(){},z[0].noBuffer=!0,z[66]=function(e){for(var t=e.length,n=BigInt(128&e[0]?e[0]-256:e[0]),r=1;r<t;r++)n<<=8n,n+=BigInt(e[r]);return n};var Ee={Error:Error,TypeError:TypeError,ReferenceError:ReferenceError};z[101]=function(){var e=X();return(Ee[e[0]]||Error)(e[1],{cause:e[2]})},z[105]=function(e){if(!1===$.structuredClone)throw new Error("Structured clone extension is disabled");var t=B.getUint32(F-4);L||(L=new Map);var n,r=D[F],i={target:n=r>=144&&r<160||220==r||221==r?[]:{}};L.set(t,i);var o=X();return i.used?Object.assign(n,o):(i.target=o,o)},z[112]=function(e){if(!1===$.structuredClone)throw new Error("Structured clone extension is disabled");var t=B.getUint32(F-4),n=L.get(t);return n.used=!0,n.target},z[115]=function(){return new Set(X())};var we=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map((function(e){return e+"Array"})),Oe="object"==typeof globalThis?globalThis:window;z[116]=function(e){var t=e[0],n=we[t];if(!n){if(16===t){var r=new ArrayBuffer(e.length-1);return new Uint8Array(r).set(e.subarray(1)),r}throw new Error("Could not find typed array for code "+t)}return new Oe[n](Uint8Array.prototype.slice.call(e,1).buffer)},z[120]=function(){var e=X();return new RegExp(e[0],e[1])};var Ie=[];function Ae(e){var t,n=k,r=F,i=U,o=V,s=M,a=L,c=j,u=new Uint8Array(D.slice(0,k)),f=_,l=_.slice(0,_.length),h=$,d=q,p=e();return k=n,F=r,U=i,V=o,M=s,L=a,j=c,D=u,q=d,(t=_=f).splice.apply(t,[0,_.length].concat(l)),$=h,B=new DataView(D.buffer,D.byteOffset,D.byteLength),p}function Te(){D=null,L=null,_=null}z[98]=function(e){var t=(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3],n=F;return F+=t-e.length,j=Ie,(j=[de(),de()]).position0=0,j.position1=0,j.postBundlePosition=F,F=n,X()},z[255]=function(e){return 4==e.length?new Date(1e3*(16777216*e[0]+(e[1]<<16)+(e[2]<<8)+e[3])):8==e.length?new Date(((e[0]<<22)+(e[1]<<14)+(e[2]<<6)+(e[3]>>2))/1e6+1e3*(4294967296*(3&e[3])+16777216*e[4]+(e[5]<<16)+(e[6]<<8)+e[7])):12==e.length?new Date(((e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3])/1e6+1e3*((128&e[4]?-281474976710656:0)+1099511627776*e[6]+4294967296*e[7]+16777216*e[8]+(e[9]<<16)+(e[10]<<8)+e[11])):new Date("invalid")};for(var Se=new Array(147),Re=0;Re<256;Re++)Se[Re]=+("1e"+Math.floor(45.15-.30103*Re));var xe,Ce,Pe,De=new Y({useRecords:!1}),ke=De.unpack;try{xe=new TextEncoder}catch(e){}var Ne,_e,Me,je,Le="undefined"!=typeof Buffer,Be=Le?function(e){return Buffer.allocUnsafeSlow(e)}:Uint8Array,Fe=Le?Buffer:Uint8Array,$e=Le?4294967296:2144337920,Ue=0,Ve=null,ze=/[\u0080-\uFFFF]/,He=Symbol("record-id"),We=function(e){function t(t){var n,o,s,a,c;(n=e.call(this,t)||this).offset=0;var u=Fe.prototype.utf8Write?function(e,t){return Ne.utf8Write(e,t,4294967295)}:!(!xe||!xe.encodeInto)&&function(e,t){return xe.encodeInto(e,Ne.subarray(t)).written},f=r(n);t||(t={});var l=t&&t.sequential,h=t.structures||t.saveStructures,d=t.maxSharedStructures;if(null==d&&(d=h?32:0),d>8160)throw new Error("Maximum maxSharedStructure is 8160");t.structuredClone&&null==t.moreTypes&&(n.moreTypes=!0);var p=t.maxOwnStructures;null==p&&(p=h?32:64),n.structures||0==t.useRecords||(n.structures=[]);var v=d>32||p+d>64,g=d+64,y=d+p+64;if(y>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");var m=[],b=0,E=0;n.pack=n.encode=function(e,t){if(Ne||(Ne=new Be(8192),Me=Ne.dataView||(Ne.dataView=new DataView(Ne.buffer,0,8192)),Ue=0),(je=Ne.length-10)-Ue<2048?(Ne=new Be(Ne.length),Me=Ne.dataView||(Ne.dataView=new DataView(Ne.buffer,0,Ne.length)),je=Ne.length-10,Ue=0):Ue=Ue+7&2147483640,o=Ue,t&Ge&&(Ue+=255&t),c=f.structuredClone?new Map:null,f.bundleStrings&&"string"!=typeof e?(Ve=[]).size=1/0:Ve=null,a=f.structures){a.uninitialized&&(a=f._mergeStructures(f.getStructures()));var n=a.sharedLength||0;if(n>d)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+a.sharedLength);if(!a.transitions){a.transitions=Object.create(null);for(var r=0;r<n;r++){var i=a[r];if(i){for(var u=void 0,h=a.transitions,p=0,v=i.length;p<v;p++){var g=i[p];(u=h[g])||(u=h[g]=Object.create(null)),h=u}h[He]=r+64}}this.lastNamedStructuresLength=n}l||(a.nextId=n+64)}var y;s&&(s=!1);try{f.randomAccessStructure&&e&&e.constructor&&e.constructor===Object?D(e):I(e);var m=Ve;if(Ve&&Ke(o,I,0),c&&c.idsToInsert){for(var b=c.idsToInsert.sort((function(e,t){return e.offset>t.offset?1:-1})),E=b.length,O=-1;m&&E>0;){var A=b[--E].offset+o;A<m.stringsPosition+o&&-1===O&&(O=0),A>m.position+o?O>=0&&(O+=6):(O>=0&&(Me.setUint32(m.position+o,Me.getUint32(m.position+o)+O),O=-1),m=m.previous,E++)}O>=0&&m&&Me.setUint32(m.position+o,Me.getUint32(m.position+o)+O),(Ue+=6*b.length)>je&&x(Ue),f.offset=Ue;var T=function(e,t){var n,r=6*t.length,i=e.length-r;for(;n=t.pop();){var o=n.offset,s=n.id;e.copyWithin(o+r,o,i);var a=o+(r-=6);e[a++]=214,e[a++]=105,e[a++]=s>>24,e[a++]=s>>16&255,e[a++]=s>>8&255,e[a++]=255&s,i=o}return e}(Ne.subarray(o,Ue),b);return c=null,T}return f.offset=Ue,t&Ye?(Ne.start=o,Ne.end=Ue,Ne):Ne.subarray(o,Ue)}catch(e){throw y=e,e}finally{if(a&&(w(),s&&f.saveStructures)){var S=a.sharedLength||0,R=Ne.subarray(o,Ue),C=function(e,t){return e.isCompatible=function(e){var n=!e||(t.lastNamedStructuresLength||0)===e.length;return n||t._mergeStructures(e),n},e}(a,f);if(!y)return!1===f.saveStructures(C,C.isCompatible)?f.pack(e,t):(f.lastNamedStructuresLength=S,Ne.length>1073741824&&(Ne=null),R)}Ne.length>1073741824&&(Ne=null),t&Ze&&(Ue=o)}};var w=function(){E<10&&E++;var e=a.sharedLength||0;if(a.length>e&&!l&&(a.length=e),b>1e4)a.transitions=null,E=0,b=0,m.length>0&&(m=[]);else if(m.length>0&&!l){for(var t=0,n=m.length;t<n;t++)m[t][He]=0;m=[]}},O=function(e){var t=e.length;t<16?Ne[Ue++]=144|t:t<65536?(Ne[Ue++]=220,Ne[Ue++]=t>>8,Ne[Ue++]=255&t):(Ne[Ue++]=221,Me.setUint32(Ue,t),Ue+=4);for(var n=0;n<t;n++)I(e[n])},I=function e(t){Ue>je&&(Ne=x(Ue));var s,a=typeof t;if("string"===a){var f,l=t.length;if(Ve&&l>=4&&l<4096){if((Ve.size+=l)>21760){var h,d,p=(Ve[0]?3*Ve[0].length+Ve[1].length:0)+10;Ue+p>je&&(Ne=x(Ue+p)),Ve.position?(d=Ve,Ne[Ue]=200,Ue+=3,Ne[Ue++]=98,h=Ue-o,Ue+=4,Ke(o,e,0),Me.setUint16(h+o-3,Ue-o-h)):(Ne[Ue++]=214,Ne[Ue++]=98,h=Ue-o,Ue+=4),(Ve=["",""]).previous=d,Ve.size=0,Ve.position=h}var v=ze.test(t);return Ve[v?0:1]+=t,Ne[Ue++]=193,void e(v?-l:l)}f=l<32?1:l<256?2:l<65536?3:5;var g=3*l;if(Ue+g>je&&(Ne=x(Ue+g)),l<64||!u){var y,m,b,E=Ue+f;for(y=0;y<l;y++)(m=t.charCodeAt(y))<128?Ne[E++]=m:m<2048?(Ne[E++]=m>>6|192,Ne[E++]=63&m|128):55296==(64512&m)&&56320==(64512&(b=t.charCodeAt(y+1)))?(m=65536+((1023&m)<<10)+(1023&b),y++,Ne[E++]=m>>18|240,Ne[E++]=m>>12&63|128,Ne[E++]=m>>6&63|128,Ne[E++]=63&m|128):(Ne[E++]=m>>12|224,Ne[E++]=m>>6&63|128,Ne[E++]=63&m|128);s=E-Ue-f}else s=u(t,Ue+f);s<32?Ne[Ue++]=160|s:s<256?(f<2&&Ne.copyWithin(Ue+2,Ue+1,Ue+1+s),Ne[Ue++]=217,Ne[Ue++]=s):s<65536?(f<3&&Ne.copyWithin(Ue+3,Ue+2,Ue+2+s),Ne[Ue++]=218,Ne[Ue++]=s>>8,Ne[Ue++]=255&s):(f<5&&Ne.copyWithin(Ue+5,Ue+3,Ue+3+s),Ne[Ue++]=219,Me.setUint32(Ue,s),Ue+=4),Ue+=s}else if("number"===a)if(t>>>0===t)t<32||t<128&&!1===n.useRecords||t<64&&!n.randomAccessStructure?Ne[Ue++]=t:t<256?(Ne[Ue++]=204,Ne[Ue++]=t):t<65536?(Ne[Ue++]=205,Ne[Ue++]=t>>8,Ne[Ue++]=255&t):(Ne[Ue++]=206,Me.setUint32(Ue,t),Ue+=4);else if(t>>0===t)t>=-32?Ne[Ue++]=256+t:t>=-128?(Ne[Ue++]=208,Ne[Ue++]=t+256):t>=-32768?(Ne[Ue++]=209,Me.setInt16(Ue,t),Ue+=2):(Ne[Ue++]=210,Me.setInt32(Ue,t),Ue+=4);else{var w;if((w=n.useFloat32)>0&&t<4294967296&&t>=-2147483648){var I;if(Ne[Ue++]=202,Me.setFloat32(Ue,t),w<4||(I=t*Se[(127&Ne[Ue])<<1|Ne[Ue+1]>>7])>>0===I)return void(Ue+=4);Ue--}Ne[Ue++]=203,Me.setFloat64(Ue,t),Ue+=8}else if("object"===a||"function"===a)if(t){if(c){var A=c.get(t);if(A){if(!A.id){var T=c.idsToInsert||(c.idsToInsert=[]);A.id=T.push(A)}return Ne[Ue++]=214,Ne[Ue++]=112,Me.setUint32(Ue,A.id),void(Ue+=4)}c.set(t,{offset:Ue-o})}var S=t.constructor;if(S===Object)R(t);else if(S===Array)O(t);else if(S===Map)if(n.mapAsEmptyObject)Ne[Ue++]=128;else{(s=t.size)<16?Ne[Ue++]=128|s:s<65536?(Ne[Ue++]=222,Ne[Ue++]=s>>8,Ne[Ue++]=255&s):(Ne[Ue++]=223,Me.setUint32(Ue,s),Ue+=4);for(var C,P=i(t);!(C=P()).done;){var D=C.value,k=D[0],N=D[1];e(k),e(N)}}else{for(var _,M=function(){var i=Pe[j];if(t instanceof i){var o=Ce[j];if(o.write){o.type&&(Ne[Ue++]=212,Ne[Ue++]=o.type,Ne[Ue++]=0);var s=o.write.call(r(n),t);return s===t?Array.isArray(t)?O(t):R(t):e(s),{v:void 0}}var a,c=Ne,u=Me,f=Ue;Ne=null;try{a=o.pack.call(r(n),t,(function(e){return Ne=c,c=null,(Ue+=e)>je&&x(Ue),{target:Ne,targetView:Me,position:Ue-e}}),e)}finally{c&&(Me=u,Ue=f,je=(Ne=c).length-10)}return a&&(a.length+Ue>je&&x(a.length+Ue),Ue=function(e,t,n,r){var i=e.length;switch(i){case 1:t[n++]=212;break;case 2:t[n++]=213;break;case 4:t[n++]=214;break;case 8:t[n++]=215;break;case 16:t[n++]=216;break;default:i<256?(t[n++]=199,t[n++]=i):i<65536?(t[n++]=200,t[n++]=i>>8,t[n++]=255&i):(t[n++]=201,t[n++]=i>>24,t[n++]=i>>16&255,t[n++]=i>>8&255,t[n++]=255&i)}return t[n++]=r,t.set(e,n),n+=i}(a,Ne,Ue,o.type)),{v:void 0}}},j=0,L=Ce.length;j<L;j++)if(_=M())return _.v;if(Array.isArray(t))O(t);else{if(t.toJSON){var B=t.toJSON();if(B!==t)return e(B)}if("function"===a)return e(n.writeFunction&&n.writeFunction(t));R(t)}}}else Ne[Ue++]=192;else if("boolean"===a)Ne[Ue++]=t?195:194;else if("bigint"===a){if(t<BigInt(1)<<BigInt(63)&&t>=-(BigInt(1)<<BigInt(63)))Ne[Ue++]=211,Me.setBigInt64(Ue,t);else if(t<BigInt(1)<<BigInt(64)&&t>0)Ne[Ue++]=207,Me.setBigUint64(Ue,t);else{if(!n.largeBigIntToFloat){if(n.useBigIntExtension&&t<Math.pow(2n,1023n)&&t>-Math.pow(2n,1023n)){Ne[Ue++]=199,Ue++,Ne[Ue++]=66;var F,$=[];do{var U=0xffn&t;F=(0x80n&U)===(t<0n?0x80n:0n),$.push(U),t>>=8n}while(0n!==t&&-1n!==t||!F);Ne[Ue-2]=$.length;for(var V=$.length;V>0;)Ne[Ue++]=Number($[--V]);return}throw new RangeError(t+" was too large to fit in MessagePack 64-bit integer format, use useBigIntExtension or set largeBigIntToFloat to convert to float-64")}Ne[Ue++]=203,Me.setFloat64(Ue,Number(t))}Ue+=8}else{if("undefined"!==a)throw new Error("Unknown type: "+a);n.encodeUndefinedAsNil?Ne[Ue++]=192:(Ne[Ue++]=212,Ne[Ue++]=0,Ne[Ue++]=0)}},A=n.variableMapSize||n.coercibleKeyAsNumber?function(e){var t,r=Object.keys(e),i=r.length;if(i<16?Ne[Ue++]=128|i:i<65536?(Ne[Ue++]=222,Ne[Ue++]=i>>8,Ne[Ue++]=255&i):(Ne[Ue++]=223,Me.setUint32(Ue,i),Ue+=4),n.coercibleKeyAsNumber)for(var o=0;o<i;o++){t=r[o];var s=Number(t);I(isNaN(s)?t:s),I(e[t])}else for(var a=0;a<i;a++)I(t=r[a]),I(e[t])}:function(e){Ne[Ue++]=222;var t=Ue-o;Ue+=2;var n=0;for(var r in e)("function"!=typeof e.hasOwnProperty||e.hasOwnProperty(r))&&(I(r),I(e[r]),n++);Ne[t+++o]=n>>8,Ne[t+o]=255&n},T=!1===n.useRecords?A:t.progressiveRecords&&!v?function(e){var t,n,r=a.transitions||(a.transitions=Object.create(null)),i=Ue++-o;for(var s in e)if("function"!=typeof e.hasOwnProperty||e.hasOwnProperty(s)){if(t=r[s])r=t;else{var c=Object.keys(e),u=r;r=a.transitions;for(var f=0,l=0,h=c.length;l<h;l++){var d=c[l];(t=r[d])||(t=r[d]=Object.create(null),f++),r=t}i+o+1==Ue?(Ue--,C(r,c,f)):P(r,c,i,f),n=!0,r=u[s]}I(e[s])}if(!n){var p=r[He];p?Ne[i+o]=p:P(r,Object.keys(e),i,0)}}:function(e){var t,n=a.transitions||(a.transitions=Object.create(null)),r=0;for(var i in e)("function"!=typeof e.hasOwnProperty||e.hasOwnProperty(i))&&((t=n[i])||(t=n[i]=Object.create(null),r++),n=t);var o=n[He];for(var s in o?o>=96&&v?(Ne[Ue++]=96+(31&(o-=96)),Ne[Ue++]=o>>5):Ne[Ue++]=o:C(n,n.__keys__||Object.keys(e),r),e)("function"!=typeof e.hasOwnProperty||e.hasOwnProperty(s))&&I(e[s])},S="function"==typeof n.useRecords&&n.useRecords,R=S?function(e){S(e)?T(e):A(e)}:T,x=function(e){var t;if(e>16777216){if(e-o>$e)throw new Error("Packed buffer would be larger than maximum buffer size");t=Math.min($e,4096*Math.round(Math.max((e-o)*(e>67108864?1.25:2),4194304)/4096))}else t=1+(Math.max(e-o<<2,Ne.length-1)>>12)<<12;var n=new Be(t);return Me=n.dataView||(n.dataView=new DataView(n.buffer,0,t)),e=Math.min(e,Ne.length),Ne.copy?Ne.copy(n,0,o,e):n.set(Ne.slice(o,e)),Ue-=o,o=0,je=n.length-10,Ne=n},C=function(e,t,r){var i=a.nextId;i||(i=64),i<g&&n.shouldShareStructure&&!n.shouldShareStructure(t)?((i=a.nextOwnId)<y||(i=g),a.nextOwnId=i+1):(i>=y&&(i=g),a.nextId=i+1);var o=t.highByte=i>=96&&v?i-96>>5:-1;e[He]=i,e.__keys__=t,a[i-64]=t,i<g?(t.isShared=!0,a.sharedLength=i-63,s=!0,o>=0?(Ne[Ue++]=96+(31&i),Ne[Ue++]=o):Ne[Ue++]=i):(o>=0?(Ne[Ue++]=213,Ne[Ue++]=114,Ne[Ue++]=96+(31&i),Ne[Ue++]=o):(Ne[Ue++]=212,Ne[Ue++]=114,Ne[Ue++]=i),r&&(b+=E*r),m.length>=p&&(m.shift()[He]=0),m.push(e),I(t))},P=function(e,t,n,r){var i=Ne,s=Ue,a=je,c=o;Ue=0,o=0,(Ne=_e)||(_e=Ne=new Be(8192)),je=Ne.length-10,C(e,t,r),_e=Ne;var u=Ue;if(Ne=i,Ue=s,je=a,o=c,u>1){var f=Ue+u-1;f>je&&x(f);var l=n+o;Ne.copyWithin(l+u,l+1,Ue),Ne.set(_e.slice(0,u),l),Ue=f}else Ne[n+o]=_e[0]},D=function(e){var t=undefined();if(0===t)return R(e);Ue=t};return n}s(t,e);var n=t.prototype;return n.useBuffer=function(e){Ne=e,Me=new DataView(Ne.buffer,Ne.byteOffset,Ne.byteLength),Ue=0},n.clearSharedData=function(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])},d(t,[{key:"position",get:function(){return Ue},set:function(e){Ue=e}},{key:"buffer",get:function(){return Ne},set:function(e){Ne=e}}]),t}(Y);function Je(e,t,n,r){var i=e.byteLength;if(i+1<256){var o=n(4+i),s=o.target,a=o.position;s[a++]=199,s[a++]=i+1}else if(i+1<65536){var c=n(5+i);s=c.target,a=c.position;s[a++]=200,s[a++]=i+1>>8,s[a++]=i+1&255}else{var u=n(7+i),f=(s=u.target,a=u.position,u.targetView);s[a++]=201,f.setUint32(a,i+1),a+=4}s[a++]=116,s[a++]=t,e.buffer||(e=new Uint8Array(e)),s.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),a)}function qe(e,t){var n=e.byteLength;if(n<256){var r=t(n+2),i=r.target,o=r.position;i[o++]=196,i[o++]=n}else if(n<65536){var s=t(n+3);i=s.target,o=s.position;i[o++]=197,i[o++]=n>>8,i[o++]=255&n}else{var a=t(n+5),c=(i=a.target,o=a.position,a.targetView);i[o++]=198,c.setUint32(o,n),o+=4}i.set(e,o)}function Ke(e,t,n){if(Ve.length>0){Me.setUint32(Ve.position+e,Ue+n-Ve.position-e),Ve.stringsPosition=Ue-e;var r=Ve;Ve=null,t(r[0]),t(r[1])}}Pe=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,W],Ce=[{pack:function(e,t,n){var r=e.getTime()/1e3;if((this.useTimestamp32||0===e.getMilliseconds())&&r>=0&&r<4294967296){var i=t(6),o=i.target,s=i.targetView,a=i.position;o[a++]=214,o[a++]=255,s.setUint32(a,r)}else if(r>0&&r<4294967296){var c=t(10),u=c.target,f=c.targetView,l=c.position;u[l++]=215,u[l++]=255,f.setUint32(l,4e6*e.getMilliseconds()+(r/1e3/4294967296>>0)),f.setUint32(l+4,r)}else if(isNaN(r)){if(this.onInvalidDate)return t(0),n(this.onInvalidDate());var h=t(3),d=h.target,p=(h.targetView,h.position);d[p++]=212,d[p++]=255,d[p++]=255}else{var v=t(15),g=v.target,y=v.targetView,m=v.position;g[m++]=199,g[m++]=12,g[m++]=255,y.setUint32(m,1e6*e.getMilliseconds()),y.setBigInt64(m+4,BigInt(Math.floor(r)))}}},{pack:function(e,t,n){if(this.setAsEmptyObject)return t(0),n({});var r=Array.from(e),i=t(this.moreTypes?3:0),o=i.target,s=i.position;this.moreTypes&&(o[s++]=212,o[s++]=115,o[s++]=0),n(r)}},{pack:function(e,t,n){var r=t(this.moreTypes?3:0),i=r.target,o=r.position;this.moreTypes&&(i[o++]=212,i[o++]=101,i[o++]=0),n([e.name,e.message,e.cause])}},{pack:function(e,t,n){var r=t(this.moreTypes?3:0),i=r.target,o=r.position;this.moreTypes&&(i[o++]=212,i[o++]=120,i[o++]=0),n([e.source,e.flags])}},{pack:function(e,t){this.moreTypes?Je(e,16,t):qe(Le?Buffer.from(e):new Uint8Array(e),t)}},{pack:function(e,t){var n=e.constructor;n!==Fe&&this.moreTypes?Je(e,we.indexOf(n.name),t):qe(e,t)}},{pack:function(e,t){var n=t(1);n.target[n.position]=193}}];new We({useRecords:!1});var Ye=512,Ze=1024,Ge=2048,Xe=function(){function t(e,t){var n=this;this.onStateChange=C(),this.onError=C(),this.onLeave=C(),this.onJoin=C(),this.hasJoined=!1,this.onMessageHandlers={emit:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=this.events[e]||[],i=0,o=r.length;i<o;i++)r[i].apply(r,t)},events:{},on:function(e,t){var n,r=this;return(null===(n=this.events[e])||void 0===n?void 0:n.push(t))||(this.events[e]=[t]),function(){var n;r.events[e]=null===(n=r.events[e])||void 0===n?void 0:n.filter((function(e){return t!==e}))}}},this.roomId=null,this.name=e,this.packr=new We,this.packr.encode(void 0),t&&(this.serializer=new(R("schema")),this.rootSchema=t,this.serializer.state=new t),this.onError((function(e,t){var n;return null===(n=console.warn)||void 0===n?void 0:n.call(console,"colyseus.js - onError => (".concat(e,") ").concat(t))})),this.onLeave((function(){return n.removeAllListeners()}))}return t.prototype.connect=function(e,n,r,i){void 0===r&&(r=this);var o=new A(i.protocol);if(r.connection=o,o.events.onmessage=t.prototype.onMessageCallback.bind(r),o.events.onclose=function(e){var t;if(!r.hasJoined)return null===(t=console.warn)||void 0===t||t.call(console,"Room connection was closed unexpectedly (".concat(e.code,"): ").concat(e.reason)),void r.onError.invoke(e.code,e.reason);e.code===u.DEVMODE_RESTART&&n?n():(r.onLeave.invoke(e.code,e.reason),r.destroy())},o.events.onerror=function(e){var t;null===(t=console.warn)||void 0===t||t.call(console,"Room, onError (".concat(e.code,"): ").concat(e.reason)),r.onError.invoke(e.code,e.reason)},"h3"===i.protocol){var s=new URL(e);o.connect(s.origin,i)}else o.connect(e)},t.prototype.leave=function(t){var n=this;return void 0===t&&(t=!0),new Promise((function(r){n.onLeave((function(e){return r(e)})),n.connection?t?(n.packr.buffer[0]=e.Protocol.LEAVE_ROOM,n.connection.send(n.packr.buffer.subarray(0,1))):n.connection.close():n.onLeave.invoke(u.CONSENTED)}))},t.prototype.onMessage=function(e,t){return this.onMessageHandlers.on(this.getMessageHandlerKey(e),t)},t.prototype.send=function(t,n){var r={offset:1};this.packr.buffer[0]=e.Protocol.ROOM_DATA,"string"==typeof t?E.encode.string(this.packr.buffer,t,r):E.encode.number(this.packr.buffer,t,r),this.packr.position=0;var i=void 0!==n?this.packr.pack(n,2048+r.offset):this.packr.buffer.subarray(0,r.offset);this.connection.send(i)},t.prototype.sendUnreliable=function(t,n){var r={offset:1};this.packr.buffer[0]=e.Protocol.ROOM_DATA,"string"==typeof t?E.encode.string(this.packr.buffer,t,r):E.encode.number(this.packr.buffer,t,r),this.packr.position=0;var i=void 0!==n?this.packr.pack(n,2048+r.offset):this.packr.buffer.subarray(0,r.offset);this.connection.sendUnreliable(i)},t.prototype.sendBytes=function(t,n){var r={offset:1};if(this.packr.buffer[0]=e.Protocol.ROOM_DATA_BYTES,"string"==typeof t?E.encode.string(this.packr.buffer,t,r):E.encode.number(this.packr.buffer,t,r),n.byteLength+r.offset>this.packr.buffer.byteLength){var i=new Uint8Array(r.offset+n.byteLength);i.set(this.packr.buffer),this.packr.useBuffer(i)}this.packr.buffer.set(n,r.offset),this.connection.send(this.packr.buffer.subarray(0,r.offset+n.byteLength))},Object.defineProperty(t.prototype,"state",{get:function(){return this.serializer.getState()},enumerable:!1,configurable:!0}),t.prototype.removeAllListeners=function(){this.onJoin.clear(),this.onStateChange.clear(),this.onError.clear(),this.onLeave.clear(),this.onMessageHandlers.events={},this.serializer instanceof N&&(this.serializer.decoder.root.callbacks={})},t.prototype.onMessageCallback=function(t){var n=new Uint8Array(t.data),r={offset:1},i=n[0];if(i===e.Protocol.JOIN_ROOM){var o=E.decode.utf8Read(n,r,n[r.offset++]);if(this.serializerId=E.decode.utf8Read(n,r,n[r.offset++]),!this.serializer){var s=R(this.serializerId);this.serializer=new s}n.byteLength>r.offset&&this.serializer.handshake&&this.serializer.handshake(n,r),this.reconnectionToken="".concat(this.roomId,":").concat(o),this.hasJoined=!0,this.onJoin.invoke(),this.packr.buffer[0]=e.Protocol.JOIN_ROOM,this.connection.send(this.packr.buffer.subarray(0,1))}else if(i===e.Protocol.ERROR){var a=E.decode.number(n,r),c=E.decode.string(n,r);this.onError.invoke(a,c)}else if(i===e.Protocol.LEAVE_ROOM)this.leave();else if(i===e.Protocol.ROOM_STATE)this.serializer.setState(n,r),this.onStateChange.invoke(this.serializer.getState());else if(i===e.Protocol.ROOM_STATE_PATCH)this.serializer.patch(n,r),this.onStateChange.invoke(this.serializer.getState());else if(i===e.Protocol.ROOM_DATA){var u=E.decode.stringCheck(n,r)?E.decode.string(n,r):E.decode.number(n,r);c=n.byteLength>r.offset?ke(n,{start:r.offset}):void 0;this.dispatchMessage(u,c)}else if(i===e.Protocol.ROOM_DATA_BYTES){u=E.decode.stringCheck(n,r)?E.decode.string(n,r):E.decode.number(n,r);this.dispatchMessage(u,n.subarray(r.offset))}},t.prototype.dispatchMessage=function(e,t){var n,r=this.getMessageHandlerKey(e);this.onMessageHandlers.events[r]?this.onMessageHandlers.emit(r,t):this.onMessageHandlers.events["*"]?this.onMessageHandlers.emit("*",e,t):null===(n=console.warn)||void 0===n||n.call(console,"colyseus.js: onMessage() not registered for type '".concat(e,"'."))},t.prototype.destroy=function(){this.serializer&&this.serializer.teardown()},t.prototype.getMessageHandlerKey=function(e){switch(typeof e){case"string":return e;case"number":return"i".concat(e);default:throw new Error("invalid message type.")}},t}();function Qe(e,t){t.headers=e.headers||{},t.statusMessage=e.statusText,t.statusCode=e.status,t.data=e.response}function et(e,t,n){return new Promise((function(r,i){n=n||{};var o,s,a,c=new XMLHttpRequest,u=n.body,f=n.headers||{};for(o in n.timeout&&(c.timeout=n.timeout),c.ontimeout=c.onerror=function(e){e.timeout="timeout"==e.type,i(e)},c.open(e,t.href||t),c.onload=function(){for(a=c.getAllResponseHeaders().trim().split(/[\r\n]+/),Qe(c,c);s=a.shift();)s=s.split(": "),c.headers[s.shift().toLowerCase()]=s.join(": ");if((s=c.headers["content-type"])&&~s.indexOf("application/json"))try{c.data=JSON.parse(c.data,n.reviver)}catch(e){return Qe(c,e),i(e)}(c.status>=400?i:r)(c)},typeof FormData<"u"&&u instanceof FormData||u&&"object"==typeof u&&(f["content-type"]="application/json",u=JSON.stringify(u)),c.withCredentials=!!n.withCredentials,f)c.setRequestHeader(o,f[o]);c.send(u)}))}var tt,nt,rt,it,ot,st=et.bind(et,"GET"),at=et.bind(et,"POST"),ct=et.bind(et,"PATCH"),ut=et.bind(et,"DELETE"),ft=et.bind(et,"PUT"),lt={del:ut,get:st,patch:ct,post:at,put:ft,send:et},ht=t({__proto__:null,default:lt,del:ut,get:st,patch:ct,post:at,put:ft,send:et},[lt]),dt=function(){function e(e){this.client=e}return e.prototype.get=function(e,t){return void 0===t&&(t={}),this.request("get",e,t)},e.prototype.post=function(e,t){return void 0===t&&(t={}),this.request("post",e,t)},e.prototype.del=function(e,t){return void 0===t&&(t={}),this.request("del",e,t)},e.prototype.put=function(e,t){return void 0===t&&(t={}),this.request("put",e,t)},e.prototype.request=function(e,t,n){return void 0===n&&(n={}),ht[e](this.client.getHttpEndpoint(t),this.getOptions(n)).catch((function(e){var t,n=e.statusCode,r=(null===(t=e.data)||void 0===t?void 0:t.error)||e.statusMessage||e.message;if(!n&&!r)throw e;throw new y(n,r)}))},e.prototype.getOptions=function(e){return this.authToken&&(e.headers||(e.headers={}),e.headers.Authorization="Bearer ".concat(this.authToken)),"undefined"!=typeof cc&&cc.sys&&cc.sys.isNative||(e.withCredentials=!0),e},e}();function pt(){if(!tt)try{tt="undefined"!=typeof cc&&cc.sys&&cc.sys.localStorage?cc.sys.localStorage:window.localStorage}catch(e){}return tt||(tt={cache:{},setItem:function(e,t){this.cache[e]=t},getItem:function(e){this.cache[e]},removeItem:function(e){delete this.cache[e]}}),tt}var vt,gt=function(){function e(e){var t,n,r,i=this;this.http=e,this.settings={path:"/auth",key:"colyseus-auth-token"},nt.set(this,!1),rt.set(this,void 0),it.set(this,void 0),ot.set(this,{emit:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=this.events[e]||[],i=0,o=r.length;i<o;i++)r[i].apply(r,t)},events:{},on:function(e,t){var n,r=this;return(null===(n=this.events[e])||void 0===n?void 0:n.push(t))||(this.events[e]=[t]),function(){var n;r.events[e]=null===(n=r.events[e])||void 0===n?void 0:n.filter((function(e){return t!==e}))}}}),t=this.settings.key,n=function(e){return i.token=e},r=pt().getItem(t),"undefined"!=typeof Promise&&r instanceof Promise?r.then((function(e){return n(e)})):n(r)}return Object.defineProperty(e.prototype,"token",{get:function(){return this.http.authToken},set:function(e){this.http.authToken=e},enumerable:!1,configurable:!0}),e.prototype.onChange=function(e){var t=this,n=v(this,ot,"f").on("change",e);return v(this,nt,"f")||g(this,rt,new Promise((function(e,n){t.getUserData().then((function(e){t.emitChange(f(f({},e),{token:t.token}))})).catch((function(e){t.emitChange({user:null,token:void 0})})).finally((function(){e()}))})),"f"),g(this,nt,!0,"f"),n},e.prototype.getUserData=function(){return l(this,void 0,void 0,(function(){return h(this,(function(e){switch(e.label){case 0:return this.token?[4,this.http.get("".concat(this.settings.path,"/userdata"))]:[3,2];case 1:return[2,e.sent().data];case 2:throw new Error("missing auth.token")}}))}))},e.prototype.registerWithEmailAndPassword=function(e,t,n){return l(this,void 0,void 0,(function(){var r;return h(this,(function(i){switch(i.label){case 0:return[4,this.http.post("".concat(this.settings.path,"/register"),{body:{email:e,password:t,options:n}})];case 1:return r=i.sent().data,this.emitChange(r),[2,r]}}))}))},e.prototype.signInWithEmailAndPassword=function(e,t){return l(this,void 0,void 0,(function(){var n;return h(this,(function(r){switch(r.label){case 0:return[4,this.http.post("".concat(this.settings.path,"/login"),{body:{email:e,password:t}})];case 1:return n=r.sent().data,this.emitChange(n),[2,n]}}))}))},e.prototype.signInAnonymously=function(e){return l(this,void 0,void 0,(function(){var t;return h(this,(function(n){switch(n.label){case 0:return[4,this.http.post("".concat(this.settings.path,"/anonymous"),{body:{options:e}})];case 1:return t=n.sent().data,this.emitChange(t),[2,t]}}))}))},e.prototype.sendPasswordResetEmail=function(e){return l(this,void 0,void 0,(function(){return h(this,(function(t){switch(t.label){case 0:return[4,this.http.post("".concat(this.settings.path,"/forgot-password"),{body:{email:e}})];case 1:return[2,t.sent().data]}}))}))},e.prototype.signInWithProvider=function(e){return l(this,arguments,void 0,(function(e,t){var n=this;return void 0===t&&(t={}),h(this,(function(r){return[2,new Promise((function(r,i){var o=t.width||480,s=t.height||768,a=n.token?"?token=".concat(n.token):"",c="Login with ".concat(e[0].toUpperCase()+e.substring(1)),u=n.http.client.getHttpEndpoint("".concat(t.prefix||"".concat(n.settings.path,"/provider"),"/").concat(e).concat(a)),f=screen.width/2-o/2,l=screen.height/2-s/2;g(n,it,window.open(u,c,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+o+", height="+s+", top="+l+", left="+f),"f");var h=function e(t){void 0===t.data.user&&void 0===t.data.token||(clearInterval(d),v(n,it,"f").close(),g(n,it,void 0,"f"),window.removeEventListener("message",e),void 0!==t.data.error?i(t.data.error):(r(t.data),n.emitChange(t.data)))},d=setInterval((function(){v(n,it,"f")&&!v(n,it,"f").closed||(g(n,it,void 0,"f"),i("cancelled"),window.removeEventListener("message",h))}),200);window.addEventListener("message",h)}))]}))}))},e.prototype.signOut=function(){return l(this,void 0,void 0,(function(){return h(this,(function(e){return this.emitChange({user:null,token:null}),[2]}))}))},e.prototype.emitChange=function(e){var t;void 0!==e.token&&(this.token=e.token,null===e.token?(t=this.settings.key,pt().removeItem(t)):function(e,t){pt().setItem(e,t)}(this.settings.key,e.token)),v(this,ot,"f").emit("change",e)},e}();function yt(e){var t,n=(null===(t=null===window||void 0===window?void 0:window.location)||void 0===t?void 0:t.hostname)||"localhost",r=e.hostname.split("."),i=!e.hostname.includes("trycloudflare.com")&&!e.hostname.includes("discordsays.com")&&r.length>2?"/".concat(r[0]):"";return e.pathname.startsWith("/.proxy")?"".concat(e.protocol,"//").concat(n).concat(i).concat(e.pathname).concat(e.search):"".concat(e.protocol,"//").concat(n,"/.proxy/colyseus").concat(i).concat(e.pathname).concat(e.search)}nt=new WeakMap,rt=new WeakMap,it=new WeakMap,ot=new WeakMap;var mt=function(e){function t(n,r){var i=e.call(this,n)||this;return i.code=r,Object.setPrototypeOf(i,t.prototype),i}return o(t,e),t}(Error),bt="undefined"!=typeof window&&void 0!==(null===(vt=null===window||void 0===window?void 0:window.location)||void 0===vt?void 0:vt.hostname)?"".concat(window.location.protocol.replace("http","ws"),"//").concat(window.location.hostname).concat(window.location.port&&":".concat(window.location.port)):"ws://127.0.0.1:2567",Et=function(){function e(e,t){var n,r;if(void 0===e&&(e=bt),"string"==typeof e){var i=e.startsWith("/")?new URL(e,bt):new URL(e),o="https:"===i.protocol||"wss:"===i.protocol,s=Number(i.port||(o?443:80));this.settings={hostname:i.hostname,pathname:i.pathname,port:s,secure:o}}else void 0===e.port&&(e.port=e.secure?443:80),void 0===e.pathname&&(e.pathname=""),this.settings=e;this.settings.pathname.endsWith("/")&&(this.settings.pathname=this.settings.pathname.slice(0,-1)),this.http=new dt(this),this.auth=new gt(this.http),this.urlBuilder=t,!this.urlBuilder&&"undefined"!=typeof window&&(null===(r=null===(n=null===window||void 0===window?void 0:window.location)||void 0===n?void 0:n.hostname)||void 0===r?void 0:r.includes("discordsays.com"))&&(this.urlBuilder=yt,console.log("Colyseus SDK: Discord Embedded SDK detected. Using custom URL builder."))}return e.prototype.joinOrCreate=function(e){return l(this,arguments,void 0,(function(e,t,n){return void 0===t&&(t={}),h(this,(function(r){switch(r.label){case 0:return[4,this.createMatchMakeRequest("joinOrCreate",e,t,n)];case 1:return[2,r.sent()]}}))}))},e.prototype.create=function(e){return l(this,arguments,void 0,(function(e,t,n){return void 0===t&&(t={}),h(this,(function(r){switch(r.label){case 0:return[4,this.createMatchMakeRequest("create",e,t,n)];case 1:return[2,r.sent()]}}))}))},e.prototype.join=function(e){return l(this,arguments,void 0,(function(e,t,n){return void 0===t&&(t={}),h(this,(function(r){switch(r.label){case 0:return[4,this.createMatchMakeRequest("join",e,t,n)];case 1:return[2,r.sent()]}}))}))},e.prototype.joinById=function(e){return l(this,arguments,void 0,(function(e,t,n){return void 0===t&&(t={}),h(this,(function(r){switch(r.label){case 0:return[4,this.createMatchMakeRequest("joinById",e,t,n)];case 1:return[2,r.sent()]}}))}))},e.prototype.reconnect=function(e,t){return l(this,void 0,void 0,(function(){var n,r,i;return h(this,(function(o){switch(o.label){case 0:if("string"==typeof e&&"string"==typeof t)throw new Error("DEPRECATED: .reconnect() now only accepts 'reconnectionToken' as argument.\nYou can get this token from previously connected `room.reconnectionToken`");if(n=e.split(":"),r=n[0],i=n[1],!r||!i)throw new Error("Invalid reconnection token format.\nThe format should be roomId:reconnectionToken");return[4,this.createMatchMakeRequest("reconnect",r,{reconnectionToken:i},t)];case 1:return[2,o.sent()]}}))}))},e.prototype.consumeSeatReservation=function(e,t,n){return l(this,void 0,void 0,(function(){var r,i,o,s=this;return h(this,(function(a){return(r=this.createRoom(e.room.name,t)).roomId=e.room.roomId,r.sessionId=e.sessionId,i={sessionId:r.sessionId},e.reconnectionToken&&(i.reconnectionToken=e.reconnectionToken),o=n||r,r.connect(this.buildEndpoint(e.room,i,e.protocol),e.devMode&&function(){return l(s,void 0,void 0,(function(){var n,i,s=this;return h(this,(function(a){return console.info("[Colyseus devMode]: ".concat(String.fromCodePoint(128260)," Re-establishing connection with room id '").concat(r.roomId,"'...")),n=0,8,i=function(){return l(s,void 0,void 0,(function(){return h(this,(function(s){switch(s.label){case 0:n++,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.consumeSeatReservation(e,t,o)];case 2:return s.sent(),console.info("[Colyseus devMode]: ".concat(String.fromCodePoint(9989)," Successfully re-established connection with room '").concat(r.roomId,"'")),[3,4];case 3:return s.sent(),n<8?(console.info("[Colyseus devMode]: ".concat(String.fromCodePoint(128260)," retrying... (").concat(n," out of ").concat(8,")")),setTimeout(i,2e3)):console.info("[Colyseus devMode]: ".concat(String.fromCodePoint(10060)," Failed to reconnect. Is your server running? Please check server logs.")),[3,4];case 4:return[2]}}))}))},setTimeout(i,2e3),[2]}))}))},o,e),[2,new Promise((function(e,t){var n=function(e,n){return t(new y(e,n))};o.onError.once(n),o.onJoin.once((function(){o.onError.remove(n),e(o)}))}))]}))}))},e.prototype.createMatchMakeRequest=function(e,t){return l(this,arguments,void 0,(function(e,t,n,r,i){var o;return void 0===n&&(n={}),h(this,(function(s){switch(s.label){case 0:return[4,this.http.post("matchmake/".concat(e,"/").concat(t),{headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)})];case 1:if((o=s.sent().data).error)throw new mt(o.error,o.code);return"reconnect"===e&&(o.reconnectionToken=n.reconnectionToken),[4,this.consumeSeatReservation(o,r,i)];case 2:return[2,s.sent()]}}))}))},e.prototype.createRoom=function(e,t){return new Xe(e,t)},e.prototype.buildEndpoint=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n="ws");var r=[];for(var i in t)t.hasOwnProperty(i)&&r.push("".concat(i,"=").concat(t[i]));"h3"===n&&(n="http");var o=this.settings.secure?"".concat(n,"s://"):"".concat(n,"://");e.publicAddress?o+="".concat(e.publicAddress):o+="".concat(this.settings.hostname).concat(this.getEndpointPort()).concat(this.settings.pathname);var s="".concat(o,"/").concat(e.processId,"/").concat(e.roomId,"?").concat(r.join("&"));return this.urlBuilder?this.urlBuilder(new URL(s)):s},e.prototype.getHttpEndpoint=function(e){void 0===e&&(e="");var t=e.startsWith("/")?e:"/".concat(e),n="".concat(this.settings.secure?"https":"http","://").concat(this.settings.hostname).concat(this.getEndpointPort()).concat(this.settings.pathname).concat(t);return this.urlBuilder?this.urlBuilder(new URL(n)):n},e.prototype.getEndpointPort=function(){return 80!==this.settings.port&&443!==this.settings.port?":".concat(this.settings.port):""},e.VERSION="0.16.9",e}(),wt=function(){function e(){}return e.prototype.setState=function(e){},e.prototype.getState=function(){return null},e.prototype.patch=function(e){},e.prototype.teardown=function(){},e.prototype.handshake=function(e){},e}();S("schema",N),S("none",wt),e.Auth=gt,e.Client=Et,e.Room=Xe,e.SchemaSerializer=N,e.ServerError=y,e.getStateCallbacks=function(e){return E.getDecoderStateCallbacks(e.serializer.decoder)},e.registerSerializer=S,Object.defineProperty(e,"__esModule",{value:!0})})),e("default",o.exports),o.exports.OPERATION,o.exports.$changes,o.exports.$childType,o.exports.$decoder,o.exports.$deleteByIndex,o.exports.$encoder,o.exports.$filter,o.exports.$getByIndex,o.exports.$track,o.exports.ArraySchema,o.exports.ChangeTree,o.exports.CollectionSchema,o.exports.Decoder,o.exports.Encoder,o.exports.MapSchema,o.exports.Metadata,o.exports.Reflection,o.exports.ReflectionField,o.exports.ReflectionType,o.exports.Schema,o.exports.SetSchema,o.exports.StateView,o.exports.TypeContext,o.exports.decode,o.exports.decodeKeyValueOperation,o.exports.decodeSchemaOperation,o.exports.defineCustomTypes,o.exports.defineTypes,o.exports.deprecated,o.exports.dumpChanges,o.exports.encode,o.exports.encodeArray,o.exports.encodeKeyValueOperation,o.exports.encodeSchemaOperation,o.exports.entity,o.exports.getDecoderStateCallbacks,o.exports.getRawChangesCallback,o.exports.registerType,o.exports.schema,o.exports.type,o.exports.view,o.exports.Protocol,o.exports.ErrorCode,o.exports.Auth,o.exports.Client,o.exports.Room,o.exports.SchemaSerializer,o.exports.ServerError,o.exports.getStateCallbacks,o.exports.registerSerializer,o.exports.__esModule}),{})}}}));

System.register("chunks:///_virtual/colyseus.mjs_cjs=&original=.js",["./colyseus.js","./cjs-loader.mjs"],(function(e,s){var t,r;return{setters:[function(s){t=s.__cjsMetaURL;var r={};r.__cjsMetaURL=s.__cjsMetaURL,r.default=s.default,e(r)},function(e){r=e.default}],execute:function(){t||r.throwInvalidWrapper("./colyseus.js",s.meta.url),r.require(t)}}}));

System.register("chunks:///_virtual/DataManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i,n,r,a;return{setters:[function(t){e=t.inheritsLoose,i=t.createClass},function(t){n=t.cclegacy,r=t._decorator,a=t.Component}],execute:function(){var o,c;n._RF.push({},"db918jwWuZKbYu+5FVf+QEA","DataManager",void 0);var s=r.ccclass;r.property,t("DataManager",s("DataManager")(((c=function(t){function n(){for(var e,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this).itemData=[{id:"RICE",name:"쌀",description:"농업에서 직접 생산되는 기본 식량 자원으로, 가공 및 외식 산업의 근간이 된다.",tier:1},{id:"IRON_ORE",name:"철광석",description:"제철 산업의 핵심 원료로, 철강 및 제조업 발전에 필수적이다.",tier:1},{id:"CRUDE_OIL",name:"원유",description:"에너지와 화학 제품의 원천 자원으로, 운송 및 석유화학 산업을 움직인다.",tier:1},{id:"FLOUR",name:"밀가루",description:"쌀을 제분하여 만든 가공 식재료로, 빵·면류 등의 기초 원료가 된다.",tier:2},{id:"STEEL",name:"철강",description:"철광석을 제련하여 만든 소재로, 건설과 제조업 전반에 사용된다.",tier:2},{id:"GASOLINE",name:"휘발유",description:"원유를 정제하여 얻는 대표적인 연료로, 운송 산업의 핵심 동력원이다.",tier:2},{id:"PLASTIC",name:"플라스틱",description:"원유에서 추출한 석유화학 제품으로, 다양한 생활 및 산업용품의 재료다.",tier:2},{id:"BAKERY_CO",name:"제과점",description:"밀가루와 쌀을 활용하여 빵, 떡 등을 생산·판매하는 외식업체.",tier:3},{id:"CONSTRUCTION_CO",name:"건설사",description:"철강을 사용하여 건물과 인프라를 건설하는 기업.",tier:3},{id:"TRANSPORT_CO",name:"운송사",description:"휘발유와 철강 기반 장비를 활용하여 육상·해운·항공 운송을 담당하는 기업.",tier:3},{id:"PETROCHEM_CO",name:"석유화학사",description:"원유에서 플라스틱·합성섬유 등을 생산하는 기업.",tier:3}],e}e(n,t);var r=n.prototype;return r.onLoad=function(){void 0===n._instance&&(n._instance=this)},r.getItemData=function(t){return console.log("get item data ",t),this.itemData.find((function(e){return e.id===t}))},r.getAllItemKeys=function(){return this.itemData.map((function(t){return t.id}))},i(n,null,[{key:"instance",get:function(){return this._instance}}]),n}(a))._instance=void 0,o=c))||o);n._RF.pop()}}}));

System.register("chunks:///_virtual/FieldLoader.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(i){var e,r,t,n,a,l,o,s,u;return{setters:[function(i){e=i.applyDecoratedDescriptor,r=i.inheritsLoose,t=i.initializerDefineProperty,n=i.assertThisInitialized,a=i.createClass},function(i){l=i.cclegacy,o=i._decorator,s=i.TiledLayer,u=i.Component}],execute:function(){var c,h,d,p,y,f,g,v,b,A;l._RF.push({},"46951WOkxhP4q6Xrb4DA5IP","FieldLoader",void 0);var z=o.ccclass,L=o.property;i("FieldLoader",(c=z("FieldLoader"),h=L({type:[s]}),c(((A=function(i){function e(){for(var e,r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];return e=i.call.apply(i,[this].concat(a))||this,t(e,"layers",y,n(e)),t(e,"chunkSize",f,n(e)),t(e,"gridCols",g,n(e)),t(e,"gridRows",v,n(e)),t(e,"flipY",b,n(e)),e.W=32,e.H=32,e.prevTiles=new Int32Array(0),e._gidArray=[],e._initGidArray=!1,e}r(e,i);var l=e.prototype;return l.onLoad=function(){e._instance||(e._instance=this),this.ensureSize(this.gridCols*this.chunkSize,this.gridRows*this.chunkSize)},l.loadFieldData=function(i){var e=[!1,!1,!1,!1,!1,!1,!1,!1,!1];this.loadGidArray();for(var r=0;r<i.length;r++){var t,n=null!=(t=i[r])?t:0;if(this.prevTiles[r]!==n){this.prevTiles[r]=n;var a=this.updateTileByLinearIndex(r,n);null!==a&&(e[a]=!0)}}for(var l=0;l<e.length;l++)e[l]&&this.layers[l]&&this.layers[l].markForUpdateRenderData()},l.updateTileByLinearIndex=function(i,e){var r=i%this.W,t=Math.floor(i/this.W),n=this.getTargetLayerAndLocalXY(r,t),a=n.layer,l=n.lx,o=n.ly,s=n.idx;return a.setTileGIDAt(this._gidArray[e-1],l,o),s},l.getTargetLayerAndLocalXY=function(i,e){var r=this.chunkSize,t=Math.floor(i/r),n=Math.floor(e/r)*this.gridCols+t,a=e%r;return{layer:this.layers[n]||null,lx:i%r,ly:this.flipY?r-1-a:a,idx:n}},l.ensureSize=function(i,e){this.W===i&&this.H===e&&this.prevTiles.length===i*e||(this.W=i,this.H=e,this.prevTiles=new Int32Array(i*e),this.prevTiles.fill(-1))},l.loadGidArray=function(){if(!this._initGidArray){for(var i=0;i<21;i++){var e=this.layers[0].getTileGIDAt(i,0);this._gidArray.push(e)}this._initGidArray=!0}},a(e,null,[{key:"instance",get:function(){return this._instance}}]),e}(u))._instance=void 0,y=e((p=A).prototype,"layers",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),f=e(p.prototype,"chunkSize",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 32}}),g=e(p.prototype,"gridCols",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),v=e(p.prototype,"gridRows",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),b=e(p.prototype,"flipY",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=p))||d));l._RF.pop()}}}));

System.register("chunks:///_virtual/FloatingY.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var i,e,n,r,o,a,s,u,l,p;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,n=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){o=t.cclegacy,a=t._decorator,s=t.Enum,u=t.Vec3,l=t.math,p=t.Component}],execute:function(){var h,c,d,b,f,g,m,y,_,w,P,v,z,S;o._RF.push({},"52fc1jgCThF9IpyyuQMXfqC","FloatingY",void 0);var Y=a.ccclass,M=a.property,D=function(t){return t[t.Sine=0]="Sine",t[t.PingPong=1]="PingPong",t}(D||{});t("FloatingY",(h=Y("FloatingY"),c=M({type:s(D)}),h((f=i((b=function(t){function i(){for(var i,e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];return i=t.call.apply(t,[this].concat(o))||this,n(i,"amplitude",f,r(i)),n(i,"period",g,r(i)),n(i,"speed",m,r(i)),n(i,"phaseDeg",y,r(i)),n(i,"wave",_,r(i)),n(i,"useWorldSpace",w,r(i)),n(i,"randomizePhase",P,r(i)),n(i,"snapToInt",v,r(i)),n(i,"recenterOnEnable",z,r(i)),n(i,"playOnStart",S,r(i)),i._baseY=0,i._t=0,i._running=!1,i._tmp=new u,i}e(i,t);var o=i.prototype;return o.onEnable=function(){var t=this.useWorldSpace?this.node.worldPosition:this.node.position;if(this._baseY=t.y,this.randomizePhase)this._t=Math.random()*this.period;else{var i=l.toRadian(this.phaseDeg)/(2*Math.PI)*this.period;this._t=i}this._running=this.playOnStart},o.start=function(){!this._running&&this.playOnStart&&(this._running=!0)},o.onDisable=function(){this._running=!1},o.recenterNow=function(){var t=this.useWorldSpace?this.node.worldPosition:this.node.position;this._baseY=t.y},o.setPlaying=function(t){this._running=t},o.update=function(t){if(this._running&&!(this.period<=0)&&0!==this.amplitude){this._t+=t*this.speed;var i=0;switch(this.wave){case D.Sine:var e=2*Math.PI/this.period*this._t;i=this.amplitude*Math.sin(e);break;case D.PingPong:var n=this._t/this.period%1,r=2*(1-Math.abs(1-2*n))-1;i=this.amplitude*r}var o=this.snapToInt?Math.round(this._baseY+i):this._baseY+i;this.useWorldSpace?(this._tmp.set(this.node.worldPosition),this._tmp.y=o,this.node.setWorldPosition(this._tmp)):(this._tmp.set(this.node.position),this._tmp.y=o,this.node.setPosition(this._tmp))}},i}(p)).prototype,"amplitude",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),g=i(b.prototype,"period",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),m=i(b.prototype,"speed",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),y=i(b.prototype,"phaseDeg",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),_=i(b.prototype,"wave",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return D.Sine}}),w=i(b.prototype,"useWorldSpace",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),P=i(b.prototype,"randomizePhase",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),v=i(b.prototype,"snapToInt",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),z=i(b.prototype,"recenterOnEnable",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),S=i(b.prototype,"playOnStart",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),d=b))||d));o._RF.pop()}}}));

System.register("chunks:///_virtual/GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NetworkManager.ts","./UIManager.ts","./CameraFollow.ts","./Colorpicker.ts"],(function(e){var n,t,a,r,o,i,c,l,s,u,p,g,f,y;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,a=e.initializerDefineProperty,r=e.assertThisInitialized,o=e.createClass},function(e){i=e.cclegacy,c=e._decorator,l=e.Node,s=e.game,u=e.Component},function(e){p=e.NetworkManager},function(e){g=e.UIManager},function(e){f=e.CameraFollow},function(e){y=e.ColorPicker}],execute:function(){var d,m,v,h,b,w,L,k,I,M;i._RF.push({},"b554bacLcJNLYDBvQ7LDf+L","GameManager",void 0);var _=c.ccclass,C=c.property;e("GameManager",(d=_("GameManager"),m=C({type:f}),v=C({type:l}),h=C({type:y}),d(((M=function(e){function n(){for(var n,t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return n=e.call.apply(e,[this].concat(o))||this,a(n,"cameraFollow",L,r(n)),a(n,"groundLayer",k,r(n)),a(n,"colorPicker",I,r(n)),n}t(n,e);var i=n.prototype;return i.onLoad=function(){void 0===n._instance&&(n._instance=this)},i.joinGame=function(){var e,n=this,t=g.instance.startUI.getNameInput();""!==t?(g.instance.startUI.changeLoading(),null==(e=s.canvas)||e.focus(),p.instance.connect(t,this.colorPicker.getSelectedColor()).then((function(e){e?(n.groundLayer.active=!0,g.instance.startUI.closeUI(),g.instance.inGameUI.node.active=!0):(alert("네트워크 연결이 올바르지 않습니다. 다시 시도해주세요."),window.location.reload())}))):alert("닉네임을 입력해주세요.")},o(n,null,[{key:"instance",get:function(){return this._instance}}]),n}(u))._instance=void 0,L=n((w=M).prototype,"cameraFollow",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=n(w.prototype,"groundLayer",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=n(w.prototype,"colorPicker",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=w))||b));i._RF.pop()}}}));

System.register("chunks:///_virtual/InGameUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./util.ts","./UIManager.ts"],(function(e){var t,n,r,o,a,i,l,u,c,s,p;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){a=e.cclegacy,i=e._decorator,l=e.Label,u=e.tween,c=e.Component},function(e){s=e.formatNumber},function(e){p=e.UIManager}],execute:function(){var f,v,d,I,h;a._RF.push({},"91490FWliNOGbucvQBmthWh","InGameUI",void 0);var y=i.ccclass,g=i.property;e("InGameUI",(f=y("InGameUI"),v=g({type:l}),f((h=t((I=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a))||this,r(t,"goldLabel",h,o(t)),t._currentGold=0,t}n(t,e);var a=t.prototype;return a.updateGold=function(e){var t=this;u(this).stop();var n=this._currentGold;u({value:n}).to(.7,{value:e},{onUpdate:function(e){t._currentGold=e.value,t.goldLabel&&(t.goldLabel.string=s(Math.floor(e.value)))}}).start()},a.openInventory=function(){p.instance.inventoryUI.openInventory()},t}(c)).prototype,"goldLabel",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=I))||d));a._RF.pop()}}}));

System.register("chunks:///_virtual/InventoryItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./util.ts","./InventoryUI.ts"],(function(t){var e,n,i,o,r,l,s,c,a,u,p,h;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,l=t._decorator,s=t.Sprite,c=t.Label,a=t.Color,u=t.Component},function(t){p=t.formatNumber},function(t){h=t.InventoryUI}],execute:function(){var m,y,g,I,b,f,d;r._RF.push({},"6676a5WebZBGKLQEoXefFiT","InventoryItem",void 0);var v=l.ccclass,C=l.property;t("InventoryItem",(m=v("InventoryItem"),y=C({type:String}),g=C({type:h}),m((f=e((b=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return e=t.call.apply(t,[this].concat(r))||this,i(e,"itemId",f,o(e)),e.sprite=null,e.label=null,e.bg=null,i(e,"inventory",d,o(e)),e}n(e,t);var r=e.prototype;return r.onLoad=function(){this.bg=this.node.getComponent(s),this.sprite=this.node.getChildByName("icon_item").getComponent(s),this.label=this.node.getChildByName("txt_cnt").getComponent(c),this.inventory.addMap(this)},r.setCount=function(t){0===t?(this.sprite.grayscale=!0,this.label.string=""):(this.sprite.grayscale=!1,this.label.string="x"+p(t))},r.selectItem=function(){console.log("select item ",this.itemId),this.inventory.selectItem(this.itemId),console.log("change bg color"),this.bg.color=new a(255,215,0)},r.unselectItem=function(){console.log("unselect item ",this.itemId),this.bg.color=new a(255,255,255)},e}(u)).prototype,"itemId",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),d=e(b.prototype,"inventory",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=b))||I));r._RF.pop()}}}));

System.register("chunks:///_virtual/InventoryUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DataManager.ts","./NetworkManager.ts"],(function(e){var t,n,i,r,o,a,s,l,c,u,p,m,I;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,s=e.Label,l=e.Sprite,c=e.resources,u=e.SpriteFrame,p=e.Component},function(e){m=e.DataManager},function(e){I=e.NetworkManager}],execute:function(){var d,f,y,h,v,g,b,M,D;o._RF.push({},"5822e7FiDJJ0ZKLhe+E852R","InventoryUI",void 0);var w=a.ccclass,F=a.property;e("InventoryUI",(d=w("InventoryUI"),f=F({type:s}),y=F({type:s}),h=F({type:l}),d((b=t((g=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(t=e.call.apply(e,[this].concat(o))||this).selectId="",t.itemMap=new Map,i(t,"itemTitle",b,r(t)),i(t,"itemDesc",M,r(t)),i(t,"itemIcon",D,r(t)),t}n(t,e);var o=t.prototype;return o.openInventory=function(){this.node.active=!0,this.updateInventory(null)},o.closeInventory=function(){this.node.active=!1},o.addMap=function(e){this.itemMap.set(e.itemId,e),console.log("add item ",e.itemId),""===this.selectId&&"RICE"===e.itemId&&e.selectItem()},o.selectItem=function(e){var t,n=this;console.log("select item 2",e),null==(t=this.itemMap)||null==(t=t.get(this.selectId))||t.unselectItem(),this.selectId=e,console.log("2");var i=m.instance.getItemData(this.selectId);console.log("3"),this.itemTitle.string=i.name,this.itemDesc.string=i.description,c.load("items/"+e+"/spriteFrame",u,(function(e,t){e?console.error(e):n.itemIcon.spriteFrame=t}))},o.updateInventory=function(e){var t=this,n=e;null===n&&I.instance.room.state.players.forEach((function(e){e.id===I.instance.room.sessionId&&(n=e.inventory)})),null!==n&&!1!==this.node.active&&m.instance.getAllItemKeys().forEach((function(e){var i,r=n.items.get(e)||0;null==(i=t.itemMap.get(e))||i.setCount(r)}))},t}(p)).prototype,"itemTitle",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(g.prototype,"itemDesc",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(g.prototype,"itemIcon",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=g))||v));o._RF.pop()}}}));

System.register("chunks:///_virtual/Loading.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,t,i,o,r,a,s,c,l,p,u,d,h;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,a=e._decorator,s=e.Sprite,c=e.tween,l=e.Vec3,p=e.input,u=e.Input,d=e.KeyCode,h=e.Component}],execute:function(){var f,y,g,v,w;r._RF.push({},"b316ciVr0hNmoPM47+codRs","Loading",void 0);var D=a.ccclass,L=a.property;e("Loading",(f=D("Loading"),y=L({type:s}),f((w=n((v=function(e){function n(){for(var n,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return n=e.call.apply(e,[this].concat(r))||this,i(n,"sprite",w,o(n)),n.tweenAnim=null,n}t(n,e);var r=n.prototype;return r.onEnable=function(){var e=this,n=c(this.sprite.node).to(1,{eulerAngles:new l(0,0,-360)}).call((function(){e.sprite.node.eulerAngles=new l(0,0,0)}));this.tweenAnim=c(this.sprite.node).repeatForever(n).start(),p.on(u.EventType.KEY_DOWN,this.onKeyDown,this)},r.onDisable=function(){this.tweenAnim.stop(),p.off(u.EventType.KEY_DOWN,this.onKeyDown,this)},r.onKeyDown=function(e){e.keyCode===d.F5&&this.reloadPage()},r.activeLoading=function(){this.node.active=!0},r.deActiveLoading=function(){this.node.active=!1},r.reloadPage=function(){window.location.reload()},n}(h)).prototype,"sprite",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=v))||g));r._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./CameraFollow.ts","./Character.ts","./CharacterManager.ts","./DataManager.ts","./FieldLoader.ts","./GameManager.ts","./NetworkManager.ts","./Player.ts","./UIManager.ts","./BuildType.ts","./NetworkState.ts","./BlinkTwinkle.ts","./ChatCloud.ts","./ChattingInput.ts","./Colorpicker.ts","./FloatingY.ts","./InGameUI.ts","./InventoryItem.ts","./InventoryUI.ts","./Loading.ts","./StartUI.ts","./StoreUI.ts","./TxtLoading.ts","./util.ts","./colyseus.mjs_cjs=&original=.js"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/NetworkManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BuildType.ts","./colyseus.mjs_cjs=&original=.js","./CharacterManager.ts","./UIManager.ts","./FieldLoader.ts","./colyseus.js"],(function(e){var n,t,o,r,s,i,c,a,u,l,h,d,p,m,f,g;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,o=e.initializerDefineProperty,r=e.assertThisInitialized,s=e.createClass,i=e.asyncToGenerator,c=e.regeneratorRuntime},function(e){a=e.cclegacy,u=e._decorator,l=e.Enum,h=e.Component},function(e){d=e.BuildType},null,function(e){p=e.CharacterManager},function(e){m=e.UIManager},function(e){f=e.FieldLoader},function(e){g=e.default}],execute:function(){var v,y,b,k,_,S;a._RF.push({},"b4706xKjRJFq5+3xmFimfRu","NetworkManager",void 0);var T=u.ccclass,C=u.property;e("NetworkManager",(v=T("NetworkManager"),y=C({type:l(d)}),v(((S=function(e){function n(){for(var n,t=arguments.length,s=new Array(t),i=0;i<t;i++)s[i]=arguments[i];return n=e.call.apply(e,[this].concat(s))||this,o(n,"buildType",_,r(n)),n.config=[{gameServer:"localhost",port:2567,useSSL:!1},{gameServer:"cqa.ggulidea.com",port:0,useSSL:!0}],n.hostname=void 0,n.port=void 0,n.useSSL=void 0,n.client=void 0,n.room=void 0,n._connected=!1,n._reconnectionToken=void 0,n.callbacks=void 0,n}t(n,e);var a=n.prototype;return a.onLoad=function(){void 0===n._instance&&(n._instance=this)},a.start=function(){this.useSSL=this.config[this.buildType].useSSL,this.hostname=this.config[this.buildType].gameServer,this.port=this.config[this.buildType].port,this.client=new g.Client((this.useSSL?"wss":"ws")+"://"+this.hostname+(443===this.port||80===this.port||this.useSSL?"":":"+this.port))},a.connect=function(){var e=i(c().mark((function e(n,t){var o=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(e){return setTimeout(e,500)}));case 3:return e.next=5,this.client.joinOrCreate("mission_room",{name:n,color:t});case 5:return this.room=e.sent,this.room.onMessage("map",(function(e){f.instance.loadFieldData(e.tiles)})),this._connected=!0,this._reconnectionToken=this.room.reconnectionToken,console.log("joined successfully!"),console.log("user's sessionId:",this.room.sessionId),this.room.onStateChange((function(e){})),this.room.onLeave((function(e){console.log("onLeave:",e),o._connected=!1})),this.setCallbacks(),e.abrupt("return",!0);case 17:return e.prev=17,e.t0=e.catch(0),console.error("[Net] connect error:",e.t0),this._connected=!1,console.error(e.t0),e.abrupt("return",!1);case 23:case"end":return e.stop()}}),e,this,[[0,17]])})));return function(n,t){return e.apply(this,arguments)}}(),a.setCallbacks=function(){var e=g.getStateCallbacks(this.room);this.callbacks=e(this.room.state),this.callbacks.players.onAdd((function(t,o){console.log(t,"has been added at",o),p.instance.onAddPlayer(t,o),e(t.movement).onChange((function(){p.instance.setTargetPosition(o,t.movement)})),e(t).listen("msg",(function(e,n){console.log(t,"msg changed at",o),p.instance.updateCharacterMsg(o,e,t.lastMsg)})),o===n.instance.room.sessionId&&(console.log("my CharacterCallback Setting"),e(t).listen("money",(function(e,n){console.log("money Changed:",e),m.instance.updateGold(e)})),e(t.inventory).onChange((function(){m.instance.inventoryUI.updateInventory(t.inventory)})))})),this.callbacks.players.onRemove((function(e,n){console.log(e,"has been removed at",n),p.instance.onRemovePlayer(e,n)}))},a.reconnect=function(){var e=i(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._reconnectionToken){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,this.client.reconnect(this._reconnectionToken);case 5:return this.room=e.sent,this._connected=!0,this._reconnectionToken=this.room.reconnectionToken,e.abrupt("return",!0);case 11:return e.prev=11,e.t0=e.catch(2),this._connected=!1,e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(){return e.apply(this,arguments)}}(),a.sendMoveInput=function(e,n){if(this.room){var t=Math.hypot(e,n),o=t>1e-4?e/t:0,r=t>1e-4?n/t:0;this.room.send("moveInput",{x:o,y:r})}},a.stopMove=function(){this.room&&this.room.send("moveInput",{x:0,y:0})},s(n,[{key:"sessionId",get:function(){var e,n;return null!=(e=null==(n=this.room)?void 0:n.sessionId)?e:null}},{key:"isConnected",get:function(){return this._connected}}],[{key:"instance",get:function(){return this._instance}}]),n}(h))._instance=void 0,_=n((k=S).prototype,"buildType",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=k))||b));a._RF.pop()}}}));

System.register("chunks:///_virtual/NetworkState.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"717479ADEFHiaCA6ANQk5cU","NetworkState",void 0);t("NetworkState",function(t){return t[t.Loading=0]="Loading",t[t.Connect=1]="Connect",t[t.Reconnecting=2]="Reconnecting",t[t.Disconnect=3]="Disconnect",t[t.Close=4]="Close",t}({}));e._RF.pop()}}}));

System.register("chunks:///_virtual/Player.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NetworkManager.ts","./GameManager.ts"],(function(e){var t,n,i,o,s,a,r,c,l,_,h,p,u;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){s=e.cclegacy,a=e._decorator,r=e.Vec3,c=e.input,l=e.Input,_=e.KeyCode,h=e.Component},function(e){p=e.NetworkManager},function(e){u=e.GameManager}],execute:function(){var y,v,f,D;s._RF.push({},"2dc00/14FZLabfDD2Nyh8G2","Player",void 0);var d=a.ccclass,m=a.property;e("Player",d("Player")((f=t((v=function(e){function t(){for(var t,n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return t=e.call.apply(e,[this].concat(s))||this,i(t,"isControllable",f,o(t)),i(t,"speed",D,o(t)),t._moveDir=new r(0,0,0),t._lastSentSec=0,t._sendIntervalSec=.05,t._lastStopSentSec=0,t._stopIntervalSec=.25,t}n(t,e);var s=t.prototype;return s.onLoad=function(){c.on(l.EventType.KEY_DOWN,this.onKeyDown,this),c.on(l.EventType.KEY_UP,this.onKeyUp,this)},s.onDestroy=function(){var e;c.off(l.EventType.KEY_DOWN,this.onKeyDown,this),c.off(l.EventType.KEY_UP,this.onKeyUp,this),null!=(e=p.instance)&&e.isConnected&&p.instance.stopMove()},s.onEnable=function(){u.instance.cameraFollow.setTarget(this.node)},s.onDisable=function(){u.instance.cameraFollow.setTarget(null)},s.onKeyDown=function(e){switch(e.keyCode){case _.KEY_W:case _.ARROW_UP:this._moveDir.y=1;break;case _.KEY_S:case _.ARROW_DOWN:this._moveDir.y=-1;break;case _.KEY_A:case _.ARROW_LEFT:this._moveDir.x=-1;break;case _.KEY_D:case _.ARROW_RIGHT:this._moveDir.x=1}},s.onKeyUp=function(e){switch(e.keyCode){case _.KEY_W:case _.ARROW_UP:this._moveDir.y>0&&(this._moveDir.y=0);break;case _.KEY_S:case _.ARROW_DOWN:this._moveDir.y<0&&(this._moveDir.y=0);break;case _.KEY_A:case _.ARROW_LEFT:this._moveDir.x<0&&(this._moveDir.x=0);break;case _.KEY_D:case _.ARROW_RIGHT:this._moveDir.x>0&&(this._moveDir.x=0)}},s.update=function(e){if(this.isControllable)if(this._moveDir.lengthSqr()>0){var t,n=this._moveDir.clone().normalize(),i=this.node.getPosition();i.x+=n.x*this.speed*e,i.y+=n.y*this.speed*e,this.node.setPosition(i);var o=performance.now()/1e3;o-this._lastSentSec>=this._sendIntervalSec&&null!=(t=p.instance)&&t.isConnected&&(p.instance.sendMoveInput(n.x,n.y),this._lastSentSec=o)}else{var s,a=performance.now()/1e3;a-this._lastStopSentSec>=this._stopIntervalSec&&null!=(s=p.instance)&&s.isConnected&&(p.instance.stopMove(),this._lastStopSentSec=a)}},s.setSpeed=function(e){this.speed=e},t}(h)).prototype,"isControllable",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),D=t(v.prototype,"speed",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),y=v))||y);s._RF.pop()}}}));

System.register("chunks:///_virtual/StartUI.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,r,o,a,u,l,s;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){o=t.cclegacy,a=t._decorator,u=t.EditBox,l=t.Component,s=t.sys}],execute:function(){var c,p,f,d,h,I,v,b,y;o._RF.push({},"9eaddo26E1NBpjE/ZSvVahQ","StartUI",void 0);var m=a.ccclass,g=a.property;t("StartUI",(c=m("StartUI"),p=g({type:u}),f=g({type:[l]}),d=g({type:[l]}),c((v=e((I=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,i(e,"nameInput",v,r(e)),i(e,"loadingUIs",b,r(e)),i(e,"startUIs",y,r(e)),e.applyWebAttrs=function(){if(s.isBrowser&&e.nameInput){var t=e.nameInput,n=t._impl||t._implComp||t._editBoxImpl||null,i=(null==n?void 0:n._input)||(null==n?void 0:n._textarea)||(null==n?void 0:n._textInput)||(null==n?void 0:n._edTxt)||null;i&&i.setAttribute&&(i.setAttribute("autocomplete","off"),i.setAttribute("autocorrect","off"),i.setAttribute("autocapitalize","off"),i.setAttribute("spellcheck","false"),i.setAttribute("enterkeyhint","done"))}},e}n(e,t);var o=e.prototype;return o.onLoad=function(){var t=this;setTimeout((function(){t.applyWebAttrs()}),100)},o.getNameInput=function(){return this.nameInput.string},o.changeLoading=function(){this.startUIs.forEach((function(t){t.node.active=!1})),this.loadingUIs.forEach((function(t){t.node.active=!0}))},o.closeUI=function(){this.node.active=!1,this.startUIs.forEach((function(t){t.node.active=!0})),this.loadingUIs.forEach((function(t){t.node.active=!1}))},e}(l)).prototype,"nameInput",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=e(I.prototype,"loadingUIs",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),y=e(I.prototype,"startUIs",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),h=I))||h));o._RF.pop()}}}));

System.register("chunks:///_virtual/StoreUI.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,r,o,n;return{setters:[function(t){e=t.inheritsLoose},function(t){r=t.cclegacy,o=t._decorator,n=t.Component}],execute:function(){var c;r._RF.push({},"6d97ey700RAn6g8DMXNjSL4","StoreUI",void 0);var s=o.ccclass;o.property,t("StoreUI",s("StoreUI")(c=function(t){function r(){return t.apply(this,arguments)||this}return e(r,t),r}(n))||c);r._RF.pop()}}}));

System.register("chunks:///_virtual/TxtLoading.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o,a,r,s,c;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){a=t.cclegacy,r=t._decorator,s=t.Label,c=t.Component}],execute:function(){var u,l,d,p,h;a._RF.push({},"1139c4BJdxFCZ9MQ4QTMkpC","TxtLoading",void 0);var f=r.ccclass,b=r.property;t("TxtLoading",(u=f("TxtLoading"),l=b({type:s}),u((h=e((p=function(t){function e(){for(var e,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return e=t.call.apply(t,[this].concat(a))||this,i(e,"label",h,o(e)),e.baseText="로딩중",e.dotCount=0,e}n(e,t);var a=e.prototype;return a.onEnable=function(){this.dotCount=0,this.schedule(this.updateDots,.5)},a.onDisable=function(){this.unschedule(this.updateDots)},a.updateDots=function(){this.dotCount=(this.dotCount+1)%4;var t=".".repeat(this.dotCount);this.label.string=this.baseText+t},a.activeLoading=function(){this.node.active=!0},a.deActiveLoading=function(){this.node.active=!1},e}(c)).prototype,"label",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=p))||d));a._RF.pop()}}}));

System.register("chunks:///_virtual/UIManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./StartUI.ts","./InGameUI.ts","./InventoryUI.ts","./StoreUI.ts"],(function(e){var t,n,r,i,a,o,l,c,u,s,p,I;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized,a=e.createClass},function(e){o=e.cclegacy,l=e._decorator,c=e.Component},function(e){u=e.StartUI},function(e){s=e.InGameUI},function(e){p=e.InventoryUI},function(e){I=e.StoreUI}],execute:function(){var y,U,f,v,b,g,d,h,m,z,_,G;o._RF.push({},"6e553os0P1IzovEuNlzheFy","UIManager",void 0);var w=l.ccclass,M=l.property;e("UIManager",(y=w("UIManager"),U=M({type:u}),f=M({type:s}),v=M({type:p}),b=M({type:I}),y(((G=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,r(t,"startUI",h,i(t)),r(t,"inGameUI",m,i(t)),r(t,"inventoryUI",z,i(t)),r(t,"storeUI",_,i(t)),t}n(t,e);var o=t.prototype;return o.onLoad=function(){void 0===t._instance&&(t._instance=this)},o.updateGold=function(e){this.inGameUI.updateGold(e)},a(t,null,[{key:"instance",get:function(){return this._instance}}]),t}(c))._instance=void 0,h=t((d=G).prototype,"startUI",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=t(d.prototype,"inGameUI",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=t(d.prototype,"inventoryUI",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=t(d.prototype,"storeUI",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=d))||g));o._RF.pop()}}}));

System.register("chunks:///_virtual/util.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){t("formatNumber",(function(t){if(isNaN(t))return"0";if(Math.abs(t)>=1e8)return Math.abs(t)>=1e9?(t/1e6).toFixed(1).replace(/\.0$/,"")+"M":(t/1e3).toFixed(1).replace(/\.0$/,"")+"K";return t.toLocaleString("ko-KR")})),e._RF.push({},"c2fc1wGt7tPPLiEJZIWLGG5","util",void 0),e._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});